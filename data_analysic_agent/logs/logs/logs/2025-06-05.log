2025-06-05 09:24:14.295 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 09:24:14.348 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 09:24:14.348 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 09:24:14.350 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 09:24:14.356 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 09:24:14.357 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 09:24:14.357 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 09:24:14.357 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:24:14.357 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:24:14.360 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:24:14.360 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:24:14.360 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:24:14.360 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:24:14.360 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:24:14.361 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:24:14.361 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:24:14.363 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:24:14.363 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:24:14.364 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:24:14.364 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:24:14.365 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:24:14.365 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:24:14.365 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:24:17.349 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 09:24:17.349 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:24:17.350 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 09:24:17.373 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:24:17.373 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:24:17.382 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:24:17.383 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 09:24:17.392 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:24:17.396 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:24:17.396 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:24:17.396 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:24:17.396 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:24:17.397 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:24:17.397 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:24:17.397 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:24:17.397 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:24:17.397 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:24:17.399 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:24:17.399 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:24:17.399 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:24:17.399 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 09:24:17.400 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 09:24:17.400 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:24:17.400 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:24:19.420 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 09:24:19.421 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:24:19.422 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 09:24:19.448 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 09:24:19.449 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:24:19.457 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:24:19.457 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 09:24:19.467 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:24:19.468 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:24:19.468 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:24:19.469 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:24:19.469 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:24:19.469 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:24:19.469 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:24:19.469 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:24:19.469 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 09:24:19.470 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 09:24:19.471 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 09:24:19.471 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 09:24:19.472 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:24:19.472 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 09:24:19.472 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 09:24:19.473 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:24:19.473 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:24:21.878 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 09:24:21.878 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:24:21.879 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 09:24:21.894 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 09:24:21.894 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 09:24:21.926 | ERROR    | workflow.analysis_dimension:analyze_dimension:509 - 聚合分析失败: cannot insert 办学类别, already exists
2025-06-05 09:24:21.926 | INFO     | workflow.analysis_dimension:analyze_dimension:513 - 尝试使用简化方法进行分组...
2025-06-05 09:24:21.928 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:24:21.929 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:24:21.929 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:24:21.929 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:24:21.929 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:24:21.929 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:24:21.929 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:24:21.930 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 09:24:21.930 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 09:24:21.931 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 09:24:21.931 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 09:24:21.932 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:24:21.932 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:24:21.934 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:24:21.934 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:24:21.934 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:24:21.935 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:24:21.935 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:24:21.936 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:24:21.936 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:24:26.396 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 09:24:26.397 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:24:26.398 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 09:24:26.414 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:24:26.414 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 09:24:26.423 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:24:26.423 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 09:24:26.436 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:27:39.738 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 09:27:39.775 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 09:27:39.775 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 09:27:39.776 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 09:27:39.781 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 09:27:39.781 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 09:27:39.781 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 09:27:39.781 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:27:39.781 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:27:39.783 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:27:39.784 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:27:39.784 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:27:39.784 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:27:39.784 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:27:39.784 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:27:39.785 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:27:39.787 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:27:39.787 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:27:39.787 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:27:39.788 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:27:39.788 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:27:39.789 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:27:39.789 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:27:39.789 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 09:27:39.789 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:27:39.790 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 09:27:39.811 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:27:39.811 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:27:39.821 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:27:39.822 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 09:27:39.831 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:27:52.903 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:27:52.903 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:27:52.904 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:27:52.904 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:27:52.904 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:27:52.904 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:27:52.904 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:27:52.905 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:27:52.905 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:27:52.907 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:27:52.907 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:27:52.908 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:27:52.908 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 09:27:52.908 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 09:27:52.909 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:27:52.909 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:27:52.909 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 09:27:52.909 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:27:52.910 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 09:27:52.924 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 09:27:52.924 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:27:52.933 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:27:52.933 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 09:27:52.943 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:28:50.525 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 09:28:50.550 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 09:28:50.550 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 09:28:50.551 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 09:28:50.556 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 09:28:50.556 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 09:28:50.556 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 09:28:55.241 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:28:55.241 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:28:55.244 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:28:55.244 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:28:55.244 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:28:55.244 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:28:55.244 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:28:55.245 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:28:55.245 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:28:55.247 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:28:55.247 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:28:55.248 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:28:55.249 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:28:55.249 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:28:55.250 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:28:55.250 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:28:55.250 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 09:28:55.250 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:28:55.251 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 09:28:55.274 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:28:55.274 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:28:55.283 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:28:55.284 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 09:28:55.294 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:28:57.705 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:28:57.705 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:28:57.706 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:28:57.706 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:28:57.706 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:28:57.706 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:28:57.706 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:28:57.707 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:28:57.707 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:28:57.709 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:28:57.709 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:28:57.709 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:28:57.710 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 09:28:57.710 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 09:28:57.710 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:28:57.711 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:28:57.711 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 09:28:57.711 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:28:57.711 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 09:28:57.725 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 09:28:57.725 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:28:57.735 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:28:57.735 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 09:28:57.746 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:29:12.919 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:29:12.919 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:29:12.919 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:29:12.920 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:29:12.920 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:29:12.920 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:29:12.920 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:29:12.921 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 09:29:12.921 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 09:29:12.923 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 09:29:12.923 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 09:29:12.924 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:29:12.924 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 09:29:12.925 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 09:29:12.925 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:29:12.925 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:29:12.926 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 09:29:12.926 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:29:12.927 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 09:29:12.941 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 09:29:12.941 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 09:29:12.966 | ERROR    | workflow.analysis_dimension:analyze_dimension:509 - 聚合分析失败: cannot insert 办学类别, already exists
2025-06-05 09:29:12.966 | INFO     | workflow.analysis_dimension:analyze_dimension:513 - 尝试使用简化方法进行分组...
2025-06-05 09:29:23.419 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:29:23.419 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:29:23.419 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:29:23.420 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:29:23.420 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:29:23.420 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:29:23.420 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:29:23.420 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 09:29:23.421 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 09:29:23.422 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 09:29:23.422 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 09:29:23.423 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:29:23.424 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:29:23.425 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:29:23.425 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:29:23.426 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:29:23.426 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:29:23.427 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:29:23.427 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:29:23.427 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:29:23.427 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 09:29:23.428 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:29:23.428 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 09:29:23.445 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:29:23.445 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 09:29:23.454 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:29:23.454 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 09:29:23.466 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:29:41.812 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 09:29:41.838 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 09:29:41.838 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 09:29:41.838 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 09:29:41.843 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 09:29:41.843 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 09:29:41.843 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 09:31:08.723 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:31:08.723 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:31:08.725 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:31:08.726 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:31:08.726 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:31:08.726 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:31:08.726 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:31:08.726 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:31:08.727 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:31:08.728 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:31:08.728 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:31:08.729 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:31:08.729 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:31:08.730 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:31:08.730 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:31:08.730 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:31:08.730 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 09:31:08.731 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:31:08.731 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 09:31:08.746 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:31:08.746 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:31:08.755 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:31:08.755 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 09:31:08.765 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:31:16.894 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:31:16.894 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:31:16.895 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:31:16.895 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:31:16.896 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:31:16.896 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:31:16.896 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:31:16.897 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:31:16.897 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:31:16.900 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:31:16.901 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:31:16.902 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:31:16.902 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 09:31:16.903 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 09:31:16.904 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:31:16.904 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:31:16.904 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 09:31:16.905 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:31:16.906 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 09:31:16.933 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 09:31:16.934 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:31:16.949 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:31:16.950 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 09:31:16.968 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:31:45.746 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:31:45.746 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:31:45.746 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:31:45.747 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:31:45.747 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:31:45.747 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:31:45.747 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:31:45.747 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 09:31:45.748 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 09:31:45.749 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 09:31:45.750 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 09:31:45.750 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:31:45.751 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 09:31:45.751 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 09:31:45.752 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:31:45.752 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:31:45.752 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 09:31:45.752 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:31:45.753 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 09:31:45.767 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 09:31:45.767 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 09:31:45.791 | ERROR    | workflow.analysis_dimension:analyze_dimension:509 - 聚合分析失败: cannot insert 办学类别, already exists
2025-06-05 09:31:45.791 | INFO     | workflow.analysis_dimension:analyze_dimension:513 - 尝试使用简化方法进行分组...
2025-06-05 09:31:52.546 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:31:52.546 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:31:52.546 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:31:52.547 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:31:52.547 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:31:52.547 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:31:52.547 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:31:52.547 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 09:31:52.548 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 09:31:52.549 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 09:31:52.549 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 09:31:52.550 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:31:52.550 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:31:52.552 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:31:52.552 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:31:52.552 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:31:52.553 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:31:52.553 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:31:52.553 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:31:52.553 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:31:52.554 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 09:31:52.554 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:31:52.554 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 09:31:52.571 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:31:52.571 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 09:31:52.580 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:31:52.581 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 09:31:52.592 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:32:08.104 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 09:32:08.134 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 09:32:08.134 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 09:32:08.134 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 09:32:08.134 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 09:32:08.134 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 09:32:08.134 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 09:33:24.029 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:33:24.030 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:33:24.032 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:33:24.032 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:33:24.033 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:33:24.033 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:33:24.033 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:33:24.033 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:33:24.034 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:33:24.037 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:33:24.038 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:33:24.038 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:33:24.039 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:33:24.039 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:33:24.040 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:33:24.040 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:33:24.040 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 09:33:24.041 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:33:24.042 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 09:33:24.066 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:33:24.066 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:33:24.075 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:33:24.075 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 09:33:24.085 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:33:26.126 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:33:26.126 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:33:26.126 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:33:26.128 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:33:26.128 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:33:26.128 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:33:26.128 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:33:26.128 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:33:26.128 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:33:26.130 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:33:26.130 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:33:26.130 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:33:26.131 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 09:33:26.131 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 09:33:26.131 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:33:26.132 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:33:26.132 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 09:33:26.132 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:33:26.132 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 09:33:26.147 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 09:33:26.147 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:33:26.155 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:33:26.155 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 09:33:26.164 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:33:31.328 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:33:31.328 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:33:43.053 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:33:43.053 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:33:43.053 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:33:43.053 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:33:43.053 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:33:43.054 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 09:33:43.054 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 09:33:43.056 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 09:33:43.056 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 09:34:10.908 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:34:10.909 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 09:34:10.909 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 09:34:10.910 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:34:10.910 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:34:10.910 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 09:34:10.910 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:34:10.911 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 09:34:10.926 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 09:34:10.927 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 09:34:10.949 | ERROR    | workflow.analysis_dimension:analyze_dimension:509 - 聚合分析失败: cannot insert 办学类别, already exists
2025-06-05 09:34:10.950 | INFO     | workflow.analysis_dimension:analyze_dimension:513 - 尝试使用简化方法进行分组...
2025-06-05 09:36:29.692 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 09:36:29.719 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 09:36:29.719 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 09:36:29.720 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 09:36:29.725 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 09:36:29.725 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 09:36:29.725 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 09:36:29.725 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:36:29.725 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:36:29.727 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:36:29.728 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:36:29.728 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:36:29.728 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:36:29.728 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:36:29.728 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:36:29.729 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:36:29.731 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:36:29.731 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:36:29.732 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:36:29.732 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 09:36:29.732 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 09:36:29.733 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:36:29.733 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:36:29.733 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 09:36:29.733 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:36:29.734 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 09:36:29.757 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 09:36:29.757 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:36:29.766 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:36:29.766 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 09:36:29.777 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:36:29.780 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:36:29.781 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:36:29.781 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:36:29.781 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:36:29.781 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:36:29.781 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:36:29.781 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:36:29.782 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 09:36:29.782 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 09:36:29.783 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 09:36:29.783 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 09:36:29.784 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:36:29.784 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 09:36:29.785 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 09:36:29.785 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:36:29.785 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:36:29.785 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 09:36:29.786 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:36:29.786 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 09:36:29.799 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 09:36:29.799 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 09:36:29.809 | INFO     | workflow.analysis_dimension:analyze_dimension:495 - 分组聚合结果:
2025-06-05 09:36:29.809 | INFO     | workflow.analysis_dimension:analyze_dimension:496 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 09:36:29.820 | INFO     | workflow.analysis_dimension:analyze_dimension:550 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 09:36:29.820 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:36:29.820 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:36:29.821 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:36:29.821 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:36:29.821 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:36:29.821 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:36:29.821 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:36:29.821 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 09:36:29.822 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 09:36:29.824 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 09:36:29.824 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 09:36:29.825 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:36:29.825 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 09:36:29.825 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 09:36:29.826 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:36:29.826 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:36:29.826 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 09:36:29.826 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:36:29.827 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 09:36:29.840 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 09:36:29.840 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 09:55:40.988 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 09:55:41.013 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 09:55:41.013 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 09:55:41.014 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 09:55:41.018 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 09:55:41.019 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 09:55:41.019 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 09:55:41.019 | INFO     | workflow.data_explore:run:61 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 09:55:41.019 | INFO     | workflow.data_explore:run:61 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 09:55:41.019 | INFO     | workflow.data_explore:run:61 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 09:55:41.019 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 09:55:41.019 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:55:41.022 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:55:41.022 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:55:41.022 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:55:41.022 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:55:41.022 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:55:41.023 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 09:55:41.023 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 09:55:41.025 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 09:55:41.025 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 09:55:41.026 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:55:41.026 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 09:55:41.026 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 09:55:41.027 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:55:41.027 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:55:41.027 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 09:55:41.027 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:55:41.028 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 09:55:41.050 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 09:55:41.051 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 09:56:31.217 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 09:56:31.276 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 09:56:31.276 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 09:56:31.279 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 09:56:31.291 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 09:56:31.292 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 09:56:31.293 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 09:56:31.293 | INFO     | workflow.data_explore:run:61 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 09:56:31.293 | INFO     | workflow.data_explore:run:61 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 09:56:31.293 | INFO     | workflow.data_explore:run:61 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 09:56:31.294 | INFO     | workflow.analysis_dimension:run_analysis:691 - 开始数据预处理......
2025-06-05 09:56:31.295 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 09:56:31.305 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 09:56:31.305 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 09:56:31.306 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 09:56:31.306 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 09:56:31.306 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 09:56:31.307 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 09:56:31.308 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 09:56:31.313 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 09:56:31.313 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 09:56:31.317 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 09:56:31.319 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 09:56:31.320 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 09:56:31.322 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 09:56:31.322 | INFO     | workflow.analysis_dimension:run_analysis:695 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 09:56:31.322 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 09:56:31.323 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 09:56:31.325 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 09:56:31.392 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 09:56:31.392 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 09:58:12.675 | ERROR    | workflow.analysis_dimension:analyze_dimension:512 - 聚合分析失败: cannot insert 办学类别, already exists
2025-06-05 09:58:22.385 | INFO     | workflow.analysis_dimension:analyze_dimension:516 - 尝试使用简化方法进行分组...
2025-06-05 10:02:19.982 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 10:02:20.005 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 10:02:20.005 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 10:02:20.006 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 10:02:20.011 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 10:02:20.012 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 10:02:20.012 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 10:02:20.012 | INFO     | workflow.data_explore:run:61 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 10:02:20.012 | INFO     | workflow.data_explore:run:61 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 10:02:20.012 | INFO     | workflow.data_explore:run:61 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 10:02:20.012 | INFO     | workflow.analysis_dimension:run_analysis:688 - 开始数据预处理......
2025-06-05 10:02:20.012 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:02:20.015 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:02:20.015 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:02:20.015 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:02:20.015 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:02:20.015 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:02:20.015 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 10:02:20.016 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 10:02:20.018 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 10:02:20.018 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 10:02:20.019 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:02:20.020 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 10:02:20.020 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 10:02:20.021 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:02:20.021 | INFO     | workflow.analysis_dimension:run_analysis:692 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:02:20.021 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 10:02:20.022 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:02:20.023 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 10:02:34.833 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 10:02:34.834 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 10:28:14.380 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 10:28:14.413 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 10:28:14.413 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 10:28:14.414 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 10:28:14.418 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 10:28:14.419 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 10:28:14.419 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 10:28:14.419 | INFO     | workflow.data_explore:run:61 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 10:28:14.419 | INFO     | workflow.data_explore:run:61 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 10:28:14.419 | INFO     | workflow.data_explore:run:61 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 10:28:14.419 | INFO     | workflow.analysis_dimension:run_analysis:697 - 开始数据预处理......
2025-06-05 10:28:14.419 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:28:14.422 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:28:14.422 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:28:14.422 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:28:14.422 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:28:14.423 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:28:14.423 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 10:28:14.423 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 10:28:14.425 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 10:28:14.425 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 10:28:14.426 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:28:14.427 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 10:28:14.427 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 10:28:14.428 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:28:14.428 | INFO     | workflow.analysis_dimension:run_analysis:701 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:28:14.428 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 10:28:14.428 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:28:14.429 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 10:28:14.450 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 10:28:14.450 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 10:28:14.472 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 10:30:18.535 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 10:30:18.580 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 10:30:18.582 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 10:30:18.582 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 10:30:18.582 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 10:30:18.582 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 10:30:18.582 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 10:30:18.582 | INFO     | workflow.data_explore:run:61 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 10:30:18.582 | INFO     | workflow.data_explore:run:61 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 10:30:18.582 | INFO     | workflow.data_explore:run:61 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:run_analysis:697 - 开始数据预处理......
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 10:30:18.582 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:run_analysis:701 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 10:30:18.582 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:30:18.598 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 10:30:18.619 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 10:30:18.619 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 10:30:18.636 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 10:31:31.734 | ERROR    | workflow.analysis_dimension:analyze_dimension:518 - 聚合分析失败: too many values to unpack (expected 2)
2025-06-05 10:32:04.993 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 10:32:05.020 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 10:32:05.020 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 10:32:05.021 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 10:32:05.025 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 10:32:05.026 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 10:32:05.026 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 10:32:05.026 | INFO     | workflow.data_explore:run:61 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 10:32:05.026 | INFO     | workflow.data_explore:run:61 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 10:32:05.026 | INFO     | workflow.data_explore:run:61 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 10:32:05.026 | INFO     | workflow.analysis_dimension:run_analysis:697 - 开始数据预处理......
2025-06-05 10:32:05.026 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:32:05.028 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:32:05.029 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:32:05.029 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:32:05.029 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:32:05.029 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:32:05.029 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 10:32:05.030 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 10:32:05.032 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 10:32:05.032 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 10:32:05.033 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:32:05.033 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 10:32:05.034 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 10:32:05.034 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:32:05.034 | INFO     | workflow.analysis_dimension:run_analysis:701 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:32:05.034 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 10:32:05.035 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:32:05.036 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 10:32:05.058 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 10:32:05.059 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 10:32:05.078 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 10:32:05.079 | INFO     | workflow.analysis_dimension:analyze_dimension:504 - 分组聚合结果:
2025-06-05 10:33:26.437 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 10:33:26.462 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 10:33:26.462 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 10:33:26.463 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 10:33:26.467 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 10:33:26.467 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 10:33:26.467 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 10:33:26.468 | INFO     | workflow.data_explore:run:61 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 10:33:26.468 | INFO     | workflow.data_explore:run:61 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 10:33:26.468 | INFO     | workflow.data_explore:run:61 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 10:33:26.468 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 10:33:26.468 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:33:26.470 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:33:26.470 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:33:26.471 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:33:26.471 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:33:26.471 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:33:26.471 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 10:33:26.472 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 10:33:26.473 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 10:33:26.474 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 10:33:26.474 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:33:26.475 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 10:33:26.475 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 10:33:26.476 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:33:26.476 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:33:26.476 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 10:33:26.476 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:33:26.477 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 10:33:26.499 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 10:33:26.499 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 10:33:26.518 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 10:33:26.528 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 10:33:26.528 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 10:34:09.197 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 10:34:09.222 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 10:34:09.222 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 10:34:09.223 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 10:34:09.228 | INFO     | workflow.data_explore:run:20 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 10:34:09.228 | INFO     | workflow.data_explore:run:55 - 数据分析维度生成完成，共 4 个维度
2025-06-05 10:34:09.229 | INFO     | workflow.data_explore:run:58 - 正在分析维度.....
2025-06-05 10:34:09.229 | INFO     | workflow.data_explore:run:61 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 10:34:09.229 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 10:34:09.229 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:34:09.231 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:34:09.232 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:34:09.232 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:34:09.232 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:34:09.232 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:34:09.232 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 10:34:09.233 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 10:34:09.235 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 10:34:09.235 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 10:34:09.236 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:34:09.236 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 10:34:09.236 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 10:34:09.237 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:34:09.237 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:34:09.237 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 10:34:09.237 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:34:09.238 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 10:34:09.259 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 10:34:09.259 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 10:34:09.267 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 10:34:09.267 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 10:34:09.280 | INFO     | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 10:34:09.284 | INFO     | workflow.data_explore:run:61 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 10:34:09.284 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 10:34:09.284 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:34:09.284 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:34:09.284 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:34:09.285 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:34:09.285 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:34:09.285 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:34:09.285 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 10:34:09.285 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 10:34:09.287 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 10:34:09.287 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 10:34:09.288 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:34:09.289 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 10:34:09.289 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 10:34:09.290 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:34:09.291 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:34:09.291 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 10:34:09.291 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:34:09.292 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 10:34:09.306 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 10:34:09.306 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 10:34:09.314 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 10:34:09.315 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 10:34:09.327 | INFO     | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 10:34:09.328 | INFO     | workflow.data_explore:run:61 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 10:34:09.328 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 10:34:09.328 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:34:09.328 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:34:09.329 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:34:09.329 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:34:09.329 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:34:09.329 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:34:09.329 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 10:34:09.329 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 10:34:09.331 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 10:34:09.331 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 10:34:09.331 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:34:09.332 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 10:34:09.332 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 10:34:09.333 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:34:09.333 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:34:09.333 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 10:34:09.333 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:34:09.333 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 10:34:09.347 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 10:34:09.347 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 10:34:09.368 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 10:34:09.377 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 10:34:09.377 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 10:34:09.387 | INFO     | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 10:34:09.388 | INFO     | workflow.data_explore:run:61 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 10:34:09.388 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 10:34:09.388 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 10:34:09.388 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 10:34:09.389 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 10:34:09.389 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 10:34:09.389 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 10:34:09.389 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 10:34:09.389 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 10:34:09.389 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 10:34:09.391 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 10:34:09.391 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 10:34:09.391 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 10:34:09.392 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 10:34:09.393 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 10:34:09.393 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 10:34:09.394 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 10:34:09.394 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 10:34:09.394 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 10:34:09.395 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 10:34:09.395 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 10:34:09.395 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 10:34:09.395 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 10:34:09.396 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 10:34:09.413 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 10:34:09.413 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 10:34:09.426 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 10:34:09.426 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 10:34:09.439 | INFO     | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 13:47:13.247 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 13:47:13.285 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 13:47:13.285 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 13:47:13.286 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 13:47:13.290 | INFO     | workflow.data_explore:run:21 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 13:47:13.290 | INFO     | workflow.data_explore:run:56 - 数据分析维度生成完成，共 4 个维度
2025-06-05 13:47:13.291 | INFO     | workflow.data_explore:run:59 - 正在分析维度.....
2025-06-05 13:47:13.291 | INFO     | workflow.data_explore:run:62 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 13:47:13.291 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 13:47:13.291 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 13:47:13.294 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 13:47:13.294 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 13:47:13.295 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 13:47:13.295 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 13:47:13.295 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 13:47:13.296 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 13:47:13.296 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 13:47:13.298 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 13:47:13.298 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 13:47:13.299 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 13:47:13.300 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 13:47:13.300 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 13:47:13.300 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 13:47:13.301 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 13:47:13.301 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 13:47:13.301 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 13:47:13.302 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 13:47:13.323 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 13:47:13.323 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 13:47:13.332 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 13:47:13.332 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 13:47:13.342 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 13:47:13.346 | INFO     | workflow.data_explore:run:62 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 13:47:13.346 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 13:47:13.346 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 13:47:13.347 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 13:47:13.347 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 13:47:13.347 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 13:47:13.347 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 13:47:13.347 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 13:47:13.347 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 13:47:13.348 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 13:47:13.349 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 13:47:13.349 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 13:47:13.350 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 13:47:13.350 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 13:47:13.350 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 13:47:13.351 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 13:47:13.351 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 13:47:13.351 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 13:47:13.351 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 13:47:13.352 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 13:47:13.366 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 13:47:13.366 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 13:47:13.374 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 13:47:13.375 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 13:47:13.384 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 13:47:13.385 | INFO     | workflow.data_explore:run:62 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 13:47:13.385 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 13:47:13.386 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 13:47:13.386 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 13:47:13.386 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 13:47:13.386 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 13:47:13.387 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 13:47:13.387 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 13:47:13.387 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 13:47:13.388 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 13:47:13.390 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 13:47:13.390 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 13:47:13.391 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 13:47:13.392 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 13:47:13.392 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 13:47:13.393 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 13:47:13.393 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 13:47:13.393 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 13:47:13.394 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 13:47:13.394 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 13:47:13.410 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 13:47:13.410 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 13:47:13.431 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 13:47:13.443 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 13:47:13.443 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 13:47:13.455 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 13:47:13.455 | INFO     | workflow.data_explore:run:62 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 13:47:13.456 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 13:47:13.456 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 13:47:13.456 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 13:47:13.456 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 13:47:13.456 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 13:47:13.456 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 13:47:13.457 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 13:47:13.457 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 13:47:13.457 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 13:47:13.458 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 13:47:13.459 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 13:47:13.459 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 13:47:13.460 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 13:47:13.461 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 13:47:13.461 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 13:47:13.462 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 13:47:13.463 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 13:47:13.463 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 13:47:13.464 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 13:47:13.464 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 13:47:13.464 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 13:47:13.465 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 13:47:13.466 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 13:47:13.485 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 13:47:13.485 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 13:47:13.495 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 13:47:13.495 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 13:47:13.508 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 13:47:13.512 | INFO     | workflow.data_explore:run:65 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 13:47:13.513 | INFO     | workflow.data_explore:run:68 - 正在绘制图表....
2025-06-05 13:47:34.271 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 13:47:34.297 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 13:47:34.297 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 13:47:34.298 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 13:47:34.303 | INFO     | workflow.data_explore:run:21 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 13:47:34.303 | INFO     | workflow.data_explore:run:56 - 数据分析维度生成完成，共 4 个维度
2025-06-05 13:47:34.303 | INFO     | workflow.data_explore:run:59 - 正在分析维度.....
2025-06-05 13:47:34.303 | INFO     | workflow.data_explore:run:62 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 13:47:34.303 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 13:47:34.303 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 13:47:34.306 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 13:47:34.306 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 13:47:34.306 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 13:47:34.306 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 13:47:34.306 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 13:47:34.307 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 13:47:34.307 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 13:47:34.309 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 13:47:34.309 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 13:47:34.310 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 13:47:34.316 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 13:47:34.317 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 13:47:34.317 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 13:47:34.317 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 13:47:34.317 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 13:47:34.318 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 13:47:34.318 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 13:47:34.339 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 13:47:34.340 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 13:47:34.350 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 13:47:34.350 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 13:47:34.360 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 13:47:34.364 | INFO     | workflow.data_explore:run:62 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 13:47:34.364 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 13:47:34.364 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 13:47:34.364 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 13:47:34.364 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 13:47:34.365 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 13:47:34.365 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 13:47:34.365 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 13:47:34.365 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 13:47:34.365 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 13:47:34.367 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 13:47:34.367 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 13:47:34.367 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 13:47:34.368 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 13:47:34.368 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 13:47:34.369 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 13:47:34.369 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 13:47:34.369 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 13:47:34.369 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 13:47:34.369 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 13:47:34.383 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 13:47:34.383 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 13:47:34.392 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 13:47:34.392 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 13:47:34.402 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 13:47:34.402 | INFO     | workflow.data_explore:run:62 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 13:47:34.402 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 13:47:34.403 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 13:47:34.403 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 13:47:34.403 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 13:47:34.403 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 13:47:34.403 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 13:47:34.403 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 13:47:34.404 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 13:47:34.404 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 13:47:34.406 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 13:47:34.406 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 13:47:34.406 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 13:47:34.406 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 13:47:34.408 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 13:47:34.408 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 13:47:34.409 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 13:47:34.409 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 13:47:34.409 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 13:47:34.409 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 13:47:34.423 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 13:47:34.423 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 13:47:34.442 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 13:47:34.450 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 13:47:34.451 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 13:47:34.462 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 13:47:34.462 | INFO     | workflow.data_explore:run:62 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 13:47:34.462 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 13:47:34.462 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 13:47:34.463 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 13:47:34.463 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 13:47:34.463 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 13:47:34.463 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 13:47:34.463 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 13:47:34.463 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 13:47:34.464 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 13:47:34.465 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 13:47:34.465 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 13:47:34.466 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 13:47:34.466 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 13:47:34.467 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 13:47:34.468 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 13:47:34.468 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 13:47:34.468 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 13:47:34.469 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 13:47:34.469 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 13:47:34.469 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 13:47:34.470 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 13:47:34.470 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 13:47:34.470 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 13:47:34.489 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 13:47:34.490 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 13:47:34.499 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 13:47:34.500 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 13:47:34.513 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 13:47:34.518 | INFO     | workflow.data_explore:run:65 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 13:47:34.518 | INFO     | workflow.data_explore:run:68 - 正在绘制图表....
2025-06-05 15:48:26.936 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 15:48:26.964 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 15:48:26.965 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 15:48:26.966 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 15:48:26.971 | INFO     | workflow.data_explore:run:21 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 15:48:26.972 | INFO     | workflow.data_explore:run:56 - 数据分析维度生成完成，共 4 个维度
2025-06-05 15:48:26.972 | INFO     | workflow.data_explore:run:59 - 正在分析维度.....
2025-06-05 15:48:26.972 | INFO     | workflow.data_explore:run:62 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 15:48:26.972 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:48:26.972 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:48:26.975 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:48:26.975 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:48:26.975 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:48:26.975 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:48:26.975 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:48:26.976 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:48:26.976 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:48:26.978 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:48:26.978 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:48:26.979 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:48:26.980 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:48:26.980 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:48:26.980 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:48:26.980 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:48:26.980 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 15:48:26.981 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:48:26.981 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 15:48:27.003 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:48:27.004 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:48:27.012 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:48:27.013 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 15:48:27.023 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:48:27.028 | INFO     | workflow.data_explore:run:62 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 15:48:27.028 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:48:27.028 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:48:27.029 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:48:27.029 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:48:27.029 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:48:27.029 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:48:27.030 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:48:27.030 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:48:27.030 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:48:27.032 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:48:27.032 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:48:27.033 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:48:27.033 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 15:48:27.034 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 15:48:27.034 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:48:27.034 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:48:27.034 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 15:48:27.035 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:48:27.035 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 15:48:27.049 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 15:48:27.049 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:48:27.058 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:48:27.058 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 15:48:27.069 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:48:27.070 | INFO     | workflow.data_explore:run:62 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 15:48:27.070 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:48:27.070 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:48:27.071 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:48:27.071 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:48:27.071 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:48:27.071 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:48:27.071 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:48:27.072 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 15:48:27.072 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 15:48:27.073 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 15:48:27.073 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 15:48:27.074 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:48:27.074 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 15:48:27.075 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 15:48:27.075 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:48:27.075 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:48:27.075 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 15:48:27.076 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:48:27.076 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 15:48:27.090 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 15:48:27.090 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 15:48:27.111 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 15:48:27.119 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:48:27.119 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 15:48:27.131 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 15:48:27.132 | INFO     | workflow.data_explore:run:62 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 15:48:27.132 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:48:27.132 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:48:27.133 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:48:27.133 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:48:27.133 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:48:27.133 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:48:27.133 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:48:27.133 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 15:48:27.134 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 15:48:27.135 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 15:48:27.135 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 15:48:27.136 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:48:27.136 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:48:27.137 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:48:27.137 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:48:27.138 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:48:27.138 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:48:27.138 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:48:27.139 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:48:27.139 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:48:27.139 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 15:48:27.139 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:48:27.140 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 15:48:27.159 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:48:27.159 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 15:48:27.169 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:48:27.169 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 15:48:27.186 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:48:27.192 | INFO     | workflow.data_explore:run:65 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 15:48:27.192 | INFO     | workflow.data_explore:run:68 - 正在绘制图表....
2025-06-05 15:49:15.014 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 15:49:15.040 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 15:49:15.040 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 15:49:15.041 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 15:49:15.046 | INFO     | workflow.data_explore:run:21 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 15:49:15.046 | INFO     | workflow.data_explore:run:56 - 数据分析维度生成完成，共 4 个维度
2025-06-05 15:49:15.046 | INFO     | workflow.data_explore:run:59 - 正在分析维度.....
2025-06-05 15:49:15.046 | INFO     | workflow.data_explore:run:62 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 15:49:15.046 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:49:15.046 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:49:15.049 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:49:15.049 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:49:15.049 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:49:15.049 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:49:15.049 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:49:15.050 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:49:15.050 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:49:15.052 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:49:15.052 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:49:15.053 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:49:15.053 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:49:15.053 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:49:15.055 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:49:15.055 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:49:15.055 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 15:49:15.055 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:49:15.056 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 15:49:15.079 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:49:15.079 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:49:15.089 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:49:15.089 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 15:49:15.099 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:49:15.103 | INFO     | workflow.data_explore:run:62 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 15:49:15.103 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:49:15.103 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:49:15.104 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:49:15.104 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:49:15.104 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:49:15.104 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:49:15.104 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:49:15.105 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:49:15.105 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:49:15.106 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:49:15.106 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:49:15.107 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:49:15.107 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 15:49:15.108 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 15:49:15.108 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:49:15.108 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:49:15.108 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 15:49:15.109 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:49:15.109 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 15:49:15.123 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 15:49:15.123 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:49:15.131 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:49:15.131 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 15:49:15.143 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:49:15.144 | INFO     | workflow.data_explore:run:62 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 15:49:15.144 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:49:15.144 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:49:15.144 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:49:15.144 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:49:15.145 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:49:15.145 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:49:15.145 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:49:15.145 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 15:49:15.145 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 15:49:15.147 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 15:49:15.147 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 15:49:15.148 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:49:15.148 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 15:49:15.149 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 15:49:15.149 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:49:15.149 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:49:15.149 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 15:49:15.149 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:49:15.150 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 15:49:15.163 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 15:49:15.163 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 15:49:15.182 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 15:49:15.190 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:49:15.191 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 15:49:15.200 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 15:49:15.201 | INFO     | workflow.data_explore:run:62 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 15:49:15.201 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:49:15.201 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:49:15.202 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:49:15.202 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:49:15.202 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:49:15.202 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:49:15.202 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:49:15.202 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 15:49:15.203 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 15:49:15.204 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 15:49:15.204 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 15:49:15.205 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:49:15.205 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:49:15.206 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:49:15.206 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:49:15.207 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:49:15.207 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:49:15.207 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:49:15.208 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:49:15.208 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:49:15.208 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 15:49:15.208 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:49:15.209 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 15:49:15.226 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:49:15.227 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 15:49:15.236 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:49:15.236 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 15:49:15.249 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:49:15.253 | INFO     | workflow.data_explore:run:65 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 15:49:15.253 | INFO     | workflow.data_explore:run:68 - 正在绘制图表....
2025-06-05 15:49:15.254 | INFO     | workflow.ImgCreate:run:51 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar(init_opts=opts.InitOpts(bg_color="#FFF"))
    .add_xaxis(
        [
            "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
            "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
            "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
            "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
        ]
    )
    .add_yaxis("学校数量", [65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(name="省份"),
        yaxis_opts=opts.AxisOpts(name="学校数量"),
        legend_opts=opts.LegendOpts(is_show=False),
    )
)
.render('D:\project\研究\data_analysic_agent\logs\save_chart\按省份划分的高校分布分析.html') 
2025-06-05 15:50:30.220 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 15:50:30.245 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 15:50:30.245 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 15:50:30.247 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 15:50:30.251 | INFO     | workflow.data_explore:run:21 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 15:50:30.252 | INFO     | workflow.data_explore:run:56 - 数据分析维度生成完成，共 4 个维度
2025-06-05 15:50:30.252 | INFO     | workflow.data_explore:run:59 - 正在分析维度.....
2025-06-05 15:50:30.252 | INFO     | workflow.data_explore:run:62 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 15:50:30.252 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:50:30.252 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:50:30.254 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:50:30.255 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:50:30.255 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:50:30.255 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:50:30.255 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:50:30.255 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:50:30.256 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:50:30.258 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:50:30.258 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:50:30.258 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:50:30.259 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:50:30.259 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:50:30.261 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:50:30.261 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:50:30.261 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 15:50:30.261 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:50:30.262 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 15:50:30.283 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:50:30.283 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:50:30.292 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:50:30.292 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 15:50:30.302 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:50:30.306 | INFO     | workflow.data_explore:run:62 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 15:50:30.306 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:50:30.306 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:50:30.306 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:50:30.307 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:50:30.307 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:50:30.307 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:50:30.307 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:50:30.308 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:50:30.308 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:50:30.309 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:50:30.309 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:50:30.310 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:50:30.310 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 15:50:30.310 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 15:50:30.311 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:50:30.311 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:50:30.311 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 15:50:30.311 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:50:30.312 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 15:50:30.326 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 15:50:30.326 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:50:30.335 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:50:30.335 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 15:50:30.344 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:50:30.345 | INFO     | workflow.data_explore:run:62 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 15:50:30.345 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:50:30.345 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:50:30.345 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:50:30.345 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:50:30.346 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:50:30.346 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:50:30.346 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:50:30.346 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 15:50:30.346 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 15:50:30.348 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 15:50:30.348 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 15:50:30.348 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:50:30.349 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 15:50:30.350 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 15:50:30.350 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:50:30.350 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:50:30.350 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 15:50:30.350 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:50:30.351 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 15:50:30.364 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 15:50:30.364 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 15:50:30.383 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 15:50:30.393 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:50:30.393 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 15:50:30.402 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 15:50:30.403 | INFO     | workflow.data_explore:run:62 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 15:50:30.403 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:50:30.403 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:50:30.404 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:50:30.404 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:50:30.404 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:50:30.404 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:50:30.404 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:50:30.404 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 15:50:30.405 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 15:50:30.406 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 15:50:30.406 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 15:50:30.407 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:50:30.407 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:50:30.409 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:50:30.409 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:50:30.409 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:50:30.410 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:50:30.410 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:50:30.411 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:50:30.411 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:50:30.411 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 15:50:30.411 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:50:30.412 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 15:50:30.429 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:50:30.429 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 15:50:30.439 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:50:30.440 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 15:50:30.453 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:50:30.458 | INFO     | workflow.data_explore:run:65 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 15:50:30.458 | INFO     | workflow.data_explore:run:68 - 正在绘制图表....
2025-06-05 15:50:30.458 | INFO     | workflow.ImgCreate:run:51 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar(init_opts=opts.InitOpts(bg_color="#FFF"))
    .add_xaxis(
        [
            "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
            "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
            "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
            "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
        ]
    )
    .add_yaxis("学校数量", [65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(name="省份"),
        yaxis_opts=opts.AxisOpts(name="学校数量"),
        legend_opts=opts.LegendOpts(is_show=False),
    )
)
chart.render('D:\project\研究\data_analysic_agent\logs\save_chart\按省份划分的高校分布分析.html') 
2025-06-05 15:52:15.005 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 15:52:15.030 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 15:52:15.030 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 15:52:15.031 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 15:52:15.037 | INFO     | workflow.data_explore:run:21 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 15:52:15.037 | INFO     | workflow.data_explore:run:56 - 数据分析维度生成完成，共 4 个维度
2025-06-05 15:52:15.037 | INFO     | workflow.data_explore:run:59 - 正在分析维度.....
2025-06-05 15:52:15.037 | INFO     | workflow.data_explore:run:62 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 15:52:15.037 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:52:15.038 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:52:15.040 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:52:15.040 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:52:15.040 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:52:15.040 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:52:15.041 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:52:15.041 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:52:15.041 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:52:15.043 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:52:15.043 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:52:15.044 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:52:15.045 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:52:15.045 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:52:15.045 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:52:15.046 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:52:15.046 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 15:52:15.046 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:52:15.047 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 15:52:15.068 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:52:15.068 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:52:15.077 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:52:15.077 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 15:52:15.087 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:52:15.091 | INFO     | workflow.data_explore:run:62 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 15:52:15.091 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:52:15.091 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:52:15.091 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:52:15.091 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:52:15.091 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:52:15.092 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:52:15.092 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:52:15.092 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:52:15.092 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:52:15.093 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:52:15.094 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:52:15.094 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:52:15.094 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 15:52:15.095 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 15:52:15.095 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:52:15.095 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:52:15.096 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 15:52:15.096 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:52:15.096 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 15:52:15.110 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 15:52:15.111 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:52:15.118 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:52:15.119 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 15:52:15.129 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:52:15.130 | INFO     | workflow.data_explore:run:62 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 15:52:15.130 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:52:15.130 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:52:15.130 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:52:15.131 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:52:15.131 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:52:15.131 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:52:15.131 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:52:15.131 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 15:52:15.131 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 15:52:15.133 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 15:52:15.133 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 15:52:15.133 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:52:15.134 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 15:52:15.134 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 15:52:15.135 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:52:15.135 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:52:15.135 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 15:52:15.135 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:52:15.136 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 15:52:15.149 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 15:52:15.149 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 15:52:15.168 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 15:52:15.176 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:52:15.177 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 15:52:15.186 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 15:52:15.187 | INFO     | workflow.data_explore:run:62 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 15:52:15.187 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:52:15.187 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:52:15.187 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:52:15.187 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:52:15.187 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:52:15.187 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:52:15.187 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:52:15.189 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 15:52:15.189 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 15:52:15.190 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 15:52:15.190 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 15:52:15.191 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:52:15.191 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:52:15.193 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:52:15.193 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:52:15.193 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:52:15.193 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:52:15.194 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:52:15.194 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:52:15.194 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:52:15.194 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 15:52:15.195 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:52:15.195 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 15:52:15.212 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:52:15.212 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 15:52:15.224 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:52:15.224 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 15:52:15.238 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:52:15.241 | INFO     | workflow.data_explore:run:65 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 15:52:15.241 | INFO     | workflow.data_explore:run:68 - 正在绘制图表....
2025-06-05 15:52:15.242 | INFO     | workflow.ImgCreate:run:51 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar(init_opts=opts.InitOpts(bg_color="#FFF"))
    .add_xaxis(
        [
            "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
            "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
            "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
            "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
        ]
    )
    .add_yaxis("学校数量", [65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(name="省份"),
        yaxis_opts=opts.AxisOpts(name="学校数量"),
        legend_opts=opts.LegendOpts(is_show=False),
    )
)
chart.render('D:\project\研究\data_analysic_agent\workflow\save_chart\按省份划分的高校分布分析.html') 
2025-06-05 15:54:18.552 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 15:54:18.577 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 15:54:18.577 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 15:54:18.578 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 15:54:18.583 | INFO     | workflow.data_explore:run:21 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 15:54:18.583 | INFO     | workflow.data_explore:run:56 - 数据分析维度生成完成，共 4 个维度
2025-06-05 15:54:18.583 | INFO     | workflow.data_explore:run:59 - 正在分析维度.....
2025-06-05 15:54:18.583 | INFO     | workflow.data_explore:run:62 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 15:54:18.583 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:54:18.584 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:54:18.586 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:54:18.586 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:54:18.586 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:54:18.586 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:54:18.587 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:54:18.587 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:54:18.587 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:54:18.589 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:54:18.589 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:54:18.590 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:54:18.590 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:54:18.591 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:54:18.591 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:54:18.591 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:54:18.592 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 15:54:18.592 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:54:18.593 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 15:54:18.615 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:54:18.615 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:54:18.625 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:54:18.625 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 15:54:18.635 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:54:18.639 | INFO     | workflow.data_explore:run:62 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 15:54:18.639 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:54:18.639 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:54:18.639 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:54:18.640 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:54:18.640 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:54:18.640 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:54:18.640 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:54:18.640 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:54:18.641 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:54:18.642 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:54:18.642 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:54:18.643 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:54:18.643 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 15:54:18.643 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 15:54:18.644 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:54:18.644 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:54:18.644 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 15:54:18.644 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:54:18.645 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 15:54:18.660 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 15:54:18.660 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:54:18.668 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:54:18.669 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 15:54:18.678 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:54:18.680 | INFO     | workflow.data_explore:run:62 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 15:54:18.680 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:54:18.680 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:54:18.681 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:54:18.681 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:54:18.681 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:54:18.682 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:54:18.682 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:54:18.682 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 15:54:18.682 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 15:54:18.684 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 15:54:18.684 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 15:54:18.684 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:54:18.685 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 15:54:18.685 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 15:54:18.686 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:54:18.686 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:54:18.686 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 15:54:18.686 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:54:18.687 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 15:54:18.700 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 15:54:18.700 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 15:54:18.719 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 15:54:18.728 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:54:18.729 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 15:54:18.739 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 15:54:18.740 | INFO     | workflow.data_explore:run:62 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 15:54:18.740 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:54:18.740 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:54:18.741 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:54:18.741 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:54:18.741 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:54:18.741 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:54:18.741 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:54:18.742 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 15:54:18.742 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 15:54:18.743 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 15:54:18.743 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 15:54:18.744 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:54:18.744 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:54:18.746 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:54:18.746 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:54:18.746 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:54:18.746 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:54:18.747 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:54:18.747 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:54:18.747 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:54:18.747 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 15:54:18.748 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:54:18.749 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 15:54:18.766 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:54:18.766 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 15:54:18.775 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:54:18.776 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 15:54:18.790 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:54:18.793 | INFO     | workflow.data_explore:run:65 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 15:54:18.794 | INFO     | workflow.data_explore:run:68 - 正在绘制图表....
2025-06-05 15:54:18.794 | INFO     | workflow.ImgCreate:run:51 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar(init_opts=opts.InitOpts(bg_color="#FFF"))
    .add_xaxis(
        [
            "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
            "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
            "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
            "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
        ]
    )
    .add_yaxis("学校数量", [65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(name="省份"),
        yaxis_opts=opts.AxisOpts(name="学校数量"),
        legend_opts=opts.LegendOpts(is_show=False),
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\save_chart\按省份划分的高校分布分析.html') 
2025-06-05 15:54:48.620 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 15:54:48.647 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 15:54:48.647 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 15:54:48.648 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 15:54:48.652 | INFO     | workflow.data_explore:run:21 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 15:54:48.653 | INFO     | workflow.data_explore:run:56 - 数据分析维度生成完成，共 4 个维度
2025-06-05 15:54:48.653 | INFO     | workflow.data_explore:run:59 - 正在分析维度.....
2025-06-05 15:54:48.653 | INFO     | workflow.data_explore:run:62 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 15:54:48.653 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:54:48.653 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:54:48.656 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:54:48.656 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:54:48.656 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:54:48.656 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:54:48.656 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:54:48.657 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:54:48.657 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:54:48.659 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:54:48.659 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:54:48.660 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:54:48.661 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:54:48.661 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:54:48.661 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:54:48.661 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:54:48.662 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 15:54:48.662 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:54:48.663 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 15:54:48.685 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:54:48.686 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:54:48.695 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:54:48.695 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 15:54:48.704 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:54:48.708 | INFO     | workflow.data_explore:run:62 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 15:54:48.708 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:54:48.708 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:54:48.709 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:54:48.709 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:54:48.709 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:54:48.709 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:54:48.709 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:54:48.709 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:54:48.710 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:54:48.711 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:54:48.711 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:54:48.712 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:54:48.712 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 15:54:48.712 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 15:54:48.713 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:54:48.713 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:54:48.713 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 15:54:48.713 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:54:48.713 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 15:54:48.727 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 15:54:48.727 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 15:54:48.736 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:54:48.736 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 15:54:48.746 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:54:48.746 | INFO     | workflow.data_explore:run:62 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 15:54:48.747 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:54:48.747 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:54:48.747 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:54:48.747 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:54:48.747 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:54:48.747 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:54:48.748 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:54:48.748 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 15:54:48.748 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 15:54:48.749 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 15:54:48.750 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 15:54:48.750 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:54:48.751 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 15:54:48.751 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 15:54:48.751 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:54:48.751 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:54:48.752 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 15:54:48.752 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:54:48.752 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 15:54:48.767 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 15:54:48.767 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 15:54:48.789 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 15:54:48.797 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:54:48.797 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 15:54:48.807 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 15:54:48.808 | INFO     | workflow.data_explore:run:62 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 15:54:48.808 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 15:54:48.808 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 15:54:48.808 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 15:54:48.809 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 15:54:48.809 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 15:54:48.809 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 15:54:48.809 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 15:54:48.809 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 15:54:48.810 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 15:54:48.811 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 15:54:48.811 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 15:54:48.811 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 15:54:48.813 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 15:54:48.815 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 15:54:48.815 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 15:54:48.815 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 15:54:48.816 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 15:54:48.816 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 15:54:48.816 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 15:54:48.816 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 15:54:48.817 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 15:54:48.817 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 15:54:48.817 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 15:54:48.834 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 15:54:48.835 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 15:54:48.845 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 15:54:48.845 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 15:54:48.858 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 15:54:48.865 | INFO     | workflow.data_explore:run:65 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 15:54:48.865 | INFO     | workflow.data_explore:run:68 - 正在绘制图表....
2025-06-05 15:54:48.865 | INFO     | workflow.ImgCreate:run:51 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar(init_opts=opts.InitOpts(bg_color="#FFF"))
    .add_xaxis(
        [
            "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
            "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
            "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
            "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
        ]
    )
    .add_yaxis("学校数量", [65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(name="省份"),
        yaxis_opts=opts.AxisOpts(name="学校数量"),
        legend_opts=opts.LegendOpts(is_show=False),
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html') 
2025-06-05 16:29:26.319 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 16:29:26.343 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 16:29:26.344 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 16:29:26.344 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 16:29:26.350 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 16:29:26.350 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 16:29:26.350 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 16:29:26.350 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 16:29:26.350 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 16:29:26.350 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 16:29:26.353 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 16:29:26.353 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 16:29:26.353 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 16:29:26.353 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 16:29:26.353 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 16:29:26.353 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 16:29:26.354 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 16:29:26.356 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 16:29:26.356 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 16:29:26.357 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 16:29:26.357 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 16:29:26.357 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 16:29:26.358 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 16:29:26.358 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 16:29:26.358 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 16:29:26.358 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 16:29:26.359 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 16:29:26.379 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 16:29:26.380 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 16:29:26.389 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 16:29:26.389 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 16:29:26.400 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 16:29:26.403 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 16:29:26.403 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 16:29:26.403 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 16:29:26.404 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 16:29:26.404 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 16:29:26.404 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 16:29:26.404 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 16:29:26.404 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 16:29:26.405 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 16:29:26.405 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 16:29:26.406 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 16:29:26.406 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 16:29:26.407 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 16:29:26.407 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 16:29:26.408 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 16:29:26.408 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 16:29:26.408 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 16:29:26.409 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 16:29:26.409 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 16:29:26.409 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 16:29:26.422 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 16:29:26.422 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 16:29:26.430 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 16:29:26.431 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 16:29:26.440 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 16:29:26.441 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 16:29:26.441 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 16:29:26.442 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 16:29:26.442 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 16:29:26.443 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 16:29:26.443 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 16:29:26.443 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 16:29:26.443 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 16:29:26.444 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 16:29:26.444 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 16:29:26.446 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 16:29:26.446 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 16:29:26.446 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 16:29:26.447 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 16:29:26.447 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 16:29:26.448 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 16:29:26.448 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 16:29:26.448 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 16:29:26.448 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 16:29:26.448 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 16:29:26.462 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 16:29:26.462 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 16:29:26.482 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 16:29:26.490 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 16:29:26.490 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 16:29:26.500 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 16:29:26.501 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 16:29:26.501 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 16:29:26.501 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 16:29:26.502 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 16:29:26.503 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 16:29:26.503 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 16:29:26.503 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 16:29:26.503 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 16:29:26.504 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 16:29:26.504 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 16:29:26.506 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 16:29:26.506 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 16:29:26.506 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 16:29:26.507 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 16:29:26.508 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 16:29:26.508 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 16:29:26.508 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 16:29:26.509 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 16:29:26.509 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 16:29:26.509 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 16:29:26.510 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 16:29:26.510 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 16:29:26.510 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 16:29:26.510 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 16:29:26.528 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 16:29:26.528 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 16:29:26.539 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 16:29:26.539 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 16:29:26.551 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 16:29:26.555 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 16:29:26.555 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 16:29:37.332 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar(init_opts=opts.InitOpts(bg_color="#FFF"))
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
        "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
        "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
        "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
    ])
    .add_yaxis("高校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174,
        108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="高校数量"),
        tooltip_opts=opts.TooltipOpts(trigger="axis")
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html')
图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html
2025-06-05 16:29:42.328 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["20%", "70%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
        background_color="#FFF",
    )
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}"))
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html')
图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html
2025-06-05 16:29:42.329 | ERROR    | workflow.ImgCreate:run_task:44 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：Chart.set_global_opts() got an unexpected keyword argument 'background_color'
2025-06-05 16:29:47.044 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar(init_opts=opts.InitOpts(bg_color="#FFF"))
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=0)),
        yaxis_opts=opts.AxisOpts(name="数量"),
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.html')
图表保存路径：D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.html
2025-06-05 16:30:04.301 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(
        [
            "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
            "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
            "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
            "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
        ]
    )
    .add_yaxis("城市数量", [1, 14, 12, 1, 9, 21, 1, 4, 16, 16, 11, 21, 14, 15, 13, 11, 11, 18,
                            11, 3, 14, 14, 2, 14, 9, 2, 9, 14, 1, 10, 3, 3, 13])
    .add_yaxis("学校数量", [65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174,
                            108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
                            12, 14, 81])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布"),
        legend_opts=opts.LegendOpts(pos_bottom="10%"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="数量"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
        backgroundColor="#FFF"
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.html')
图表保存路径：D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.html
2025-06-05 16:30:04.302 | ERROR    | workflow.ImgCreate:run_task:44 - 分析维度：省份-城市维度下的高校分布分析 执行代码出错：Chart.set_global_opts() got an unexpected keyword argument 'backgroundColor'
2025-06-05 16:43:43.241 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 16:43:43.265 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 16:43:43.265 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 16:43:43.267 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 16:43:43.271 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 16:43:43.272 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 16:43:43.272 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 16:43:43.272 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 16:43:43.272 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 16:43:43.272 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 16:43:43.274 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 16:43:43.275 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 16:43:43.275 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 16:43:43.275 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 16:43:43.275 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 16:43:43.275 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 16:43:43.276 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 16:43:43.278 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 16:43:43.278 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 16:43:43.279 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 16:43:43.280 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 16:43:43.280 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 16:43:43.281 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 16:43:43.281 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 16:43:43.281 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 16:43:43.281 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 16:43:43.282 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 16:43:43.303 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 16:43:43.303 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 16:43:43.312 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 16:43:43.313 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 16:43:43.323 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 16:43:43.327 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 16:43:43.328 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 16:43:43.328 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 16:43:43.328 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 16:43:43.328 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 16:43:43.329 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 16:43:43.329 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 16:43:43.329 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 16:43:43.329 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 16:43:43.330 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 16:43:43.331 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 16:43:43.331 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 16:43:43.332 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 16:43:43.332 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 16:43:43.333 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 16:43:43.333 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 16:43:43.333 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 16:43:43.334 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 16:43:43.334 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 16:43:43.334 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 16:43:43.349 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 16:43:43.349 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 16:43:43.358 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 16:43:43.358 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 16:43:43.368 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 16:43:43.369 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 16:43:43.369 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 16:43:43.369 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 16:43:43.370 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 16:43:43.370 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 16:43:43.370 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 16:43:43.370 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 16:43:43.370 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 16:43:43.370 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 16:43:43.371 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 16:43:43.372 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 16:43:43.372 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 16:43:43.373 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 16:43:43.373 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 16:43:43.373 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 16:43:43.374 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 16:43:43.374 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 16:43:43.374 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 16:43:43.374 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 16:43:43.375 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 16:43:43.390 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 16:43:43.390 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 16:43:43.414 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 16:43:43.423 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 16:43:43.423 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 16:43:43.433 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 16:43:43.434 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 16:43:43.434 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 16:43:43.434 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 16:43:43.434 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 16:43:43.435 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 16:43:43.435 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 16:43:43.435 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 16:43:43.435 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 16:43:43.436 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 16:43:43.436 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 16:43:43.437 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 16:43:43.437 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 16:43:43.438 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 16:43:43.438 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 16:43:43.440 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 16:43:43.440 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 16:43:43.440 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 16:43:43.441 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 16:43:43.441 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 16:43:43.442 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 16:43:43.442 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 16:43:43.442 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 16:43:43.442 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 16:43:43.443 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 16:43:43.460 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 16:43:43.460 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 16:43:43.470 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 16:43:43.471 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 16:43:43.484 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 16:43:43.491 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 16:43:43.492 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 16:43:53.494 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html')

2025-06-05 16:43:53.990 | INFO     | workflow.ImgCreate:run_task:42 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html
2025-06-05 16:43:58.697 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        series_name="高校数量分布",
        data=[("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html')

2025-06-05 16:43:58.698 | ERROR    | workflow.ImgCreate:run_task:45 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：Pie.add() got an unexpected keyword argument 'data'
2025-06-05 16:44:02.510 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.html')

2025-06-05 16:44:02.513 | INFO     | workflow.ImgCreate:run_task:42 - 分析维度：高校层次与类别组合分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.html
2025-06-05 16:44:19.949 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("城市数量", [
        1, 14, 12, 1, 9, 21, 1, 4, 16, 16,
        11, 21, 14, 15, 13, 11, 11, 18, 11, 3,
        14, 14, 2, 14, 9, 2, 9, 14, 1, 10,
        3, 3, 13
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布分析"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="数量")
    )
)
chart.render('D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.html')

2025-06-05 16:44:19.954 | INFO     | workflow.ImgCreate:run_task:42 - 分析维度：省份-城市维度下的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.html
2025-06-05 17:04:08.842 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 17:04:08.866 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 17:04:08.866 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 17:04:08.867 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 17:04:08.872 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 17:04:08.872 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 17:04:08.872 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 17:04:08.872 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 17:04:08.872 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:04:08.872 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:04:08.875 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:04:08.875 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:04:08.876 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:04:08.876 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:04:08.876 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:04:08.876 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:04:08.877 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:04:08.879 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:04:08.879 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:04:08.879 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:04:08.880 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:04:08.880 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:04:08.880 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:04:08.880 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:04:08.880 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 17:04:08.882 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:04:08.882 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 17:04:08.904 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:04:08.904 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:04:08.912 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:04:08.914 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 17:04:08.924 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:04:08.927 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 17:04:08.927 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:04:08.927 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:04:08.927 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:04:08.929 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:04:08.929 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:04:08.929 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:04:08.929 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:04:08.929 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:04:08.930 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:04:08.931 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:04:08.931 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:04:08.932 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:04:08.932 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 17:04:08.932 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 17:04:08.933 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:04:08.933 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:04:08.933 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 17:04:08.933 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:04:08.934 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 17:04:08.948 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 17:04:08.948 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:04:08.957 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:04:08.957 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 17:04:08.968 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:04:08.969 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 17:04:08.969 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:04:08.969 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:04:08.969 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:04:08.970 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:04:08.970 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:04:08.970 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:04:08.970 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:04:08.970 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 17:04:08.970 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 17:04:08.972 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 17:04:08.972 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 17:04:08.973 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:04:08.973 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 17:04:08.974 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 17:04:08.974 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:04:08.974 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:04:08.974 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 17:04:08.974 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:04:08.974 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 17:04:08.988 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 17:04:08.988 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 17:04:09.008 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 17:04:09.016 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:04:09.017 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 17:04:09.026 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 17:04:09.027 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 17:04:09.027 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:04:09.027 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:04:09.027 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:04:09.027 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:04:09.028 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:04:09.028 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:04:09.028 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:04:09.028 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 17:04:09.028 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 17:04:09.030 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 17:04:09.030 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 17:04:09.031 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:04:09.031 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:04:09.033 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:04:09.033 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:04:09.033 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:04:09.034 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:04:09.034 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:04:09.034 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:04:09.035 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:04:09.035 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 17:04:09.035 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:04:09.035 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 17:04:09.053 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:04:09.054 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 17:04:09.065 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:04:09.065 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 17:04:09.077 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:04:09.081 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 17:04:09.081 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 17:04:22.814 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东", 
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南", 
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西", 
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 
        158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html')

2025-06-05 17:04:23.352 | INFO     | workflow.ImgCreate:run_task:42 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html
2025-06-05 17:04:28.129 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}"))
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html')

2025-06-05 17:04:28.138 | INFO     | workflow.ImgCreate:run_task:42 - 分析维度：按办学类型划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html
2025-06-05 17:04:31.508 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="数量"),
    )
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.html')

2025-06-05 17:04:31.511 | INFO     | workflow.ImgCreate:run_task:42 - 分析维度：高校层次与类别组合分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.html
2025-06-05 17:04:46.388 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
        "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
        "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
        "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
    ])
    .add_yaxis("城市数量", [
        1, 14, 12, 1, 9, 21, 1, 4, 16, 16, 11, 21, 14, 15, 13, 11, 11,
        18, 11, 3, 14, 14, 2, 14, 9, 2, 9, 14, 1, 10, 3, 3, 13
    ])
    .add_yaxis("高校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174,
        108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
        legend_opts=opts.LegendOpts(pos_right="10%")
    )
    .extend_axis(
        yaxis=opts.AxisOpts(
            name="城市数量",
            type_="value",
            min_=0,
            max_=25,
            position="right",
            axislabel_opts=opts.LabelOpts(formatter="{value}")
        )
    )
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.html')

2025-06-05 17:04:46.392 | INFO     | workflow.ImgCreate:run_task:42 - 分析维度：省份-城市维度下的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.html
2025-06-05 17:18:10.955 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 17:18:10.980 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 17:18:10.980 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 17:18:10.981 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 17:18:10.985 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 17:18:10.986 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 17:18:10.986 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 17:18:10.986 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 17:18:10.986 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:18:10.986 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:18:10.989 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:18:10.989 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:18:10.989 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:18:10.989 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:18:10.989 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:18:10.990 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:18:10.990 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:18:10.992 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:18:10.992 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:18:10.993 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:18:10.993 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:18:10.993 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:18:10.994 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:18:10.994 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:18:10.994 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 17:18:10.994 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:18:10.995 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 17:18:11.015 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:18:11.015 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:18:11.026 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:18:11.026 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 17:18:11.037 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:18:11.040 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 17:18:11.040 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:18:11.041 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:18:11.041 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:18:11.041 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:18:11.041 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:18:11.041 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:18:11.041 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:18:11.042 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:18:11.042 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:18:11.043 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:18:11.043 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:18:11.044 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:18:11.044 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 17:18:11.044 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 17:18:11.045 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:18:11.045 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:18:11.045 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 17:18:11.045 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:18:11.046 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 17:18:11.059 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 17:18:11.059 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:18:11.067 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:18:11.068 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 17:18:11.079 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:18:11.080 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 17:18:11.081 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:18:11.081 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:18:11.081 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:18:11.081 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:18:11.081 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:18:11.081 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:18:11.082 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:18:11.082 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 17:18:11.082 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 17:18:11.085 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 17:18:11.085 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 17:18:11.085 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:18:11.086 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 17:18:11.086 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 17:18:11.087 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:18:11.087 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:18:11.087 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 17:18:11.087 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:18:11.088 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 17:18:11.101 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 17:18:11.101 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 17:18:11.123 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 17:18:11.131 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:18:11.131 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 17:18:11.142 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 17:18:11.142 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 17:18:11.142 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:18:11.142 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:18:11.143 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:18:11.143 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:18:11.143 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:18:11.143 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:18:11.143 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:18:11.143 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 17:18:11.145 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 17:18:11.146 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 17:18:11.146 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 17:18:11.147 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:18:11.147 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:18:11.149 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:18:11.149 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:18:11.149 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:18:11.150 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:18:11.150 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:18:11.150 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:18:11.151 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:18:11.151 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 17:18:11.151 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:18:11.151 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 17:18:11.169 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:18:11.169 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 17:18:11.181 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:18:11.181 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 17:18:11.195 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:18:11.199 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 17:18:11.199 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 17:18:59.807 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 17:18:59.832 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 17:18:59.832 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 17:18:59.833 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 17:18:59.838 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 17:18:59.838 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 17:18:59.838 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 17:18:59.838 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 17:18:59.838 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:18:59.839 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:18:59.841 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:18:59.841 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:18:59.841 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:18:59.841 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:18:59.842 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:18:59.842 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:18:59.842 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:18:59.844 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:18:59.844 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:18:59.845 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:18:59.846 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:18:59.846 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:18:59.846 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:18:59.847 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:18:59.847 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 17:18:59.847 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:18:59.848 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 17:18:59.869 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:18:59.869 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:18:59.878 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:18:59.878 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 17:18:59.891 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:18:59.894 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 17:18:59.894 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:18:59.894 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:18:59.895 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:18:59.895 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:18:59.895 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:18:59.895 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:18:59.895 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:18:59.895 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:18:59.896 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:18:59.897 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:18:59.898 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:18:59.898 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:18:59.899 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 17:18:59.899 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 17:18:59.899 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:18:59.899 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:18:59.901 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 17:18:59.901 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:18:59.901 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 17:18:59.915 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 17:18:59.915 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:18:59.923 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:18:59.923 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 17:18:59.933 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:18:59.934 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 17:18:59.934 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:18:59.934 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:18:59.934 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:18:59.934 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:18:59.935 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:18:59.935 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:18:59.935 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:18:59.935 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 17:18:59.935 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 17:18:59.937 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 17:18:59.937 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 17:18:59.937 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:18:59.938 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 17:18:59.938 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 17:18:59.939 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:18:59.939 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:18:59.939 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 17:18:59.939 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:18:59.939 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 17:18:59.954 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 17:18:59.954 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 17:18:59.972 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 17:18:59.981 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:18:59.982 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 17:18:59.991 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 17:18:59.992 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 17:18:59.992 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:18:59.992 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:18:59.993 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:18:59.993 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:18:59.993 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:18:59.993 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:18:59.993 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:18:59.993 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 17:18:59.994 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 17:18:59.995 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 17:18:59.995 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 17:18:59.996 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:18:59.996 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:18:59.997 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:18:59.998 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:18:59.998 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:18:59.998 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:18:59.999 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:18:59.999 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:18:59.999 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:18:59.999 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 17:19:00.000 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:19:00.000 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 17:19:00.019 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:19:00.019 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 17:19:00.028 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:19:00.028 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 17:19:00.041 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:19:00.044 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 17:19:00.045 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 17:20:26.377 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 17:20:26.403 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 17:20:26.403 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 17:20:26.404 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 17:20:26.409 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 17:20:26.409 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 17:20:26.409 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 17:20:26.409 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 17:20:26.409 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:20:26.409 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:20:26.411 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:20:26.412 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:20:26.412 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:20:26.412 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:20:26.412 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:20:26.412 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:20:26.413 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:20:26.416 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:20:26.416 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:20:26.417 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:20:26.417 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:20:26.417 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:20:26.418 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:20:26.418 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:20:26.418 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 17:20:26.418 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:20:26.419 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 17:20:26.441 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:20:26.442 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:20:26.451 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:20:26.451 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 17:20:26.462 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:20:26.466 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 17:20:26.466 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:20:26.466 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:20:26.466 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:20:26.466 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:20:26.467 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:20:26.467 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:20:26.467 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:20:26.467 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:20:26.467 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:20:26.469 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:20:26.469 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:20:26.470 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:20:26.470 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 17:20:26.470 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 17:20:26.471 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:20:26.471 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:20:26.471 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 17:20:26.471 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:20:26.472 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 17:20:26.486 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 17:20:26.486 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:20:26.496 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:20:26.496 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 17:20:26.507 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:20:26.508 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 17:20:26.508 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:20:26.508 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:20:26.508 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:20:26.508 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:20:26.509 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:20:26.509 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:20:26.509 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:20:26.509 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 17:20:26.509 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 17:20:26.511 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 17:20:26.511 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 17:20:26.511 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:20:26.512 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 17:20:26.512 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 17:20:26.513 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:20:26.513 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:20:26.513 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 17:20:26.513 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:20:26.513 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 17:20:26.529 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 17:20:26.529 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 17:20:26.552 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 17:20:26.560 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:20:26.560 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 17:20:26.572 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 17:20:26.572 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 17:20:26.572 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:20:26.573 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:20:26.573 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:20:26.573 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:20:26.573 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:20:26.573 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:20:26.573 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:20:26.574 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 17:20:26.574 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 17:20:26.576 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 17:20:26.576 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 17:20:26.576 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:20:26.577 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:20:26.578 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:20:26.578 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:20:26.579 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:20:26.579 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:20:26.580 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:20:26.580 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:20:26.580 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:20:26.580 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 17:20:26.580 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:20:26.582 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 17:20:26.602 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:20:26.602 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 17:20:26.612 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:20:26.613 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 17:20:26.626 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:20:26.630 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 17:20:26.630 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 17:20:26.999 | ERROR    | workflow.ImgCreate:run_task:62 - 分析维度：按省份划分的高校分布分析 执行代码出错：Pie.add() got an unexpected keyword argument 'data' 自动纠正中...
2025-06-05 17:21:33.386 | INFO     | workflow.ImgCreate:run_task:65 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        series_name="高校数量分布",
        data_pair=[("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)

# 注意：路径中的反斜杠 `\` 在 Python 字符串中需要转义或使用原始字符串
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html')
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html')

2025-06-05 17:21:33.543 | INFO     | workflow.ImgCreate:run_task:59 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html
2025-06-05 17:22:21.294 | ERROR    | workflow.ImgCreate:run_task:62 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：Pie.add() got an unexpected keyword argument 'data' 自动纠正中...
2025-06-05 17:22:44.168 | INFO     | workflow.ImgCreate:run_task:65 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        series_name="高校数量分布",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],  # 数据直接作为位置参数传递
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)

chart.render('D:/project/研究/data_analysic_agent/save_chart/按办学类型划分的高校分布分析.html')
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html')

2025-06-05 17:22:44.169 | ERROR    | workflow.ImgCreate:run_task:62 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：positional argument follows keyword argument (<string>, line 11) 自动纠正中...
2025-06-05 17:23:57.000 | INFO     | workflow.ImgCreate:run_task:65 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

.add(
    series_name="高校数量分布",
    [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],  # ← 这是一个位置参数
    radius=["15%", "75%"],
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html')

2025-06-05 17:23:57.001 | ERROR    | workflow.ImgCreate:run_task:62 - 分析维度：高校层次与类别组合分析 执行代码出错：Pie.add() got an unexpected keyword argument 'data' 自动纠正中...
2025-06-05 17:24:46.917 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 17:24:46.943 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 17:24:46.943 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 17:24:46.944 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 17:24:46.949 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 17:24:46.949 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 17:24:46.949 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 17:24:46.949 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 17:24:46.949 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:24:46.949 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:24:46.952 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:24:46.952 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:24:46.952 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:24:46.953 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:24:46.953 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:24:46.953 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:24:46.953 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:24:46.955 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:24:46.956 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:24:46.956 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:24:46.957 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:24:46.957 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:24:46.958 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:24:46.958 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:24:46.958 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 17:24:46.958 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:24:46.959 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 17:24:46.982 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:24:46.982 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:24:46.993 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:24:46.993 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 17:24:47.004 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:24:47.007 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 17:24:47.007 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:24:47.008 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:24:47.008 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:24:47.008 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:24:47.008 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:24:47.008 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:24:47.008 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:24:47.009 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:24:47.009 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:24:47.010 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:24:47.010 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:24:47.011 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:24:47.011 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 17:24:47.012 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 17:24:47.013 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:24:47.013 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:24:47.013 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 17:24:47.013 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:24:47.014 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 17:24:47.030 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 17:24:47.030 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:24:47.039 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:24:47.039 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 17:24:47.050 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:24:47.050 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 17:24:47.051 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:24:47.051 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:24:47.051 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:24:47.051 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:24:47.051 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:24:47.051 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:24:47.051 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:24:47.052 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 17:24:47.052 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 17:24:47.053 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 17:24:47.053 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 17:24:47.054 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:24:47.054 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 17:24:47.055 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 17:24:47.055 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:24:47.055 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:24:47.055 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 17:24:47.056 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:24:47.056 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 17:24:47.070 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 17:24:47.070 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 17:24:47.092 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 17:24:47.101 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:24:47.101 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 17:24:47.113 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 17:24:47.113 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 17:24:47.113 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:24:47.114 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:24:47.114 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:24:47.114 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:24:47.114 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:24:47.114 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:24:47.114 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:24:47.115 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 17:24:47.115 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 17:24:47.117 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 17:24:47.117 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 17:24:47.118 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:24:47.118 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:24:47.120 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:24:47.120 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:24:47.121 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:24:47.121 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:24:47.121 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:24:47.122 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:24:47.122 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:24:47.122 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 17:24:47.122 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:24:47.123 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 17:24:47.142 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:24:47.142 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 17:24:47.152 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:24:47.154 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 17:24:47.169 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:24:47.173 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 17:24:47.173 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 17:25:41.106 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 17:25:41.130 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 17:25:41.130 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 17:25:41.131 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 17:25:41.138 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 17:25:41.138 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 17:25:41.138 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 17:25:41.138 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 17:25:41.138 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:25:41.138 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:25:41.141 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:25:41.141 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:25:41.141 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:25:41.141 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:25:41.141 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:25:41.142 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:25:41.142 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:25:41.144 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:25:41.145 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:25:41.145 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:25:41.146 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:25:41.146 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:25:41.146 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:25:41.147 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:25:41.147 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 17:25:41.147 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:25:41.148 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 17:25:41.168 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:25:41.169 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:25:41.177 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:25:41.178 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 17:25:41.191 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:25:41.194 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 17:25:41.194 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:25:41.195 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:25:41.195 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:25:41.195 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:25:41.195 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:25:41.196 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:25:41.196 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:25:41.196 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:25:41.197 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:25:41.198 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:25:41.198 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:25:41.199 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:25:41.199 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 17:25:41.200 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 17:25:41.200 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:25:41.200 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:25:41.200 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 17:25:41.201 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:25:41.201 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 17:25:41.215 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 17:25:41.216 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:25:41.224 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:25:41.224 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 17:25:41.234 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:25:41.235 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 17:25:41.235 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:25:41.235 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:25:41.235 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:25:41.235 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:25:41.235 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:25:41.236 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:25:41.236 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:25:41.236 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 17:25:41.236 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 17:25:41.237 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 17:25:41.238 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 17:25:41.238 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:25:41.239 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 17:25:41.239 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 17:25:41.240 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:25:41.240 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:25:41.240 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 17:25:41.241 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:25:41.242 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 17:25:41.257 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 17:25:41.257 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 17:25:41.277 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 17:25:41.286 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:25:41.286 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 17:25:41.296 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 17:25:41.297 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 17:25:41.297 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:25:41.297 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:25:41.298 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:25:41.298 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:25:41.298 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:25:41.298 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:25:41.298 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:25:41.298 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 17:25:41.299 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 17:25:41.300 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 17:25:41.300 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 17:25:41.302 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:25:41.302 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:25:41.303 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:25:41.304 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:25:41.304 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:25:41.304 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:25:41.305 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:25:41.305 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:25:41.305 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:25:41.305 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 17:25:41.306 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:25:41.306 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 17:25:41.323 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:25:41.323 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 17:25:41.333 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:25:41.333 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 17:25:41.346 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:25:41.350 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成，正在分析数据并书写建议.....
2025-06-05 17:25:41.351 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 17:25:41.712 | ERROR    | workflow.ImgCreate:run_task:62 - 分析维度：按省份划分的高校分布分析 执行代码出错：Pie.add() got an unexpected keyword argument 'data' 自动纠正中...
2025-06-05 17:25:55.843 | INFO     | workflow.ImgCreate:run_task:65 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        series_name="高校数量分布",
        data_pair=[("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)

chart.render('D:/project/研究/data_analysic_agent/save_chart/按办学类型划分的高校分布分析.html')
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html')

2025-06-05 17:25:55.995 | INFO     | workflow.ImgCreate:run_task:59 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html
2025-06-05 17:39:31.099 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 17:39:31.124 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 17:39:31.124 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 17:39:31.125 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 17:39:31.130 | INFO     | workflow.data_explore:run:22 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 17:39:31.130 | INFO     | workflow.data_explore:run:57 - 数据分析维度生成完成，共 4 个维度
2025-06-05 17:39:31.130 | INFO     | workflow.data_explore:run:60 - 正在分析维度.....
2025-06-05 17:39:31.130 | INFO     | workflow.data_explore:run:63 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 17:39:31.130 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:39:31.130 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:39:31.133 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:39:31.133 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:39:31.133 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:39:31.133 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:39:31.133 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:39:31.134 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:39:31.134 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:39:31.136 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:39:31.136 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:39:31.137 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:39:31.137 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:39:31.137 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:39:31.138 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:39:31.138 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:39:31.138 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 17:39:31.138 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:39:31.139 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 17:39:31.160 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:39:31.160 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:39:31.169 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:39:31.169 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 17:39:31.179 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:39:31.183 | INFO     | workflow.data_explore:run:63 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 17:39:31.183 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:39:31.183 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:39:31.183 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:39:31.183 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:39:31.184 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:39:31.184 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:39:31.184 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:39:31.184 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:39:31.184 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:39:31.186 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:39:31.186 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:39:31.186 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:39:31.187 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 17:39:31.187 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 17:39:31.187 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:39:31.188 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:39:31.188 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 17:39:31.188 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:39:31.188 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 17:39:31.203 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 17:39:31.203 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:39:31.214 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:39:31.214 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 17:39:31.224 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:39:31.225 | INFO     | workflow.data_explore:run:63 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 17:39:31.225 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:39:31.225 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:39:31.226 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:39:31.226 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:39:31.226 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:39:31.226 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:39:31.226 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:39:31.226 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 17:39:31.227 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 17:39:31.228 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 17:39:31.228 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 17:39:31.229 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:39:31.229 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 17:39:31.229 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 17:39:31.230 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:39:31.230 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:39:31.230 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 17:39:31.230 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:39:31.231 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 17:39:31.244 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 17:39:31.245 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 17:39:31.264 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 17:39:31.272 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:39:31.273 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 17:39:31.283 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 17:39:31.284 | INFO     | workflow.data_explore:run:63 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 17:39:31.284 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:39:31.284 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:39:31.285 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:39:31.285 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:39:31.285 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:39:31.285 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:39:31.285 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:39:31.286 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 17:39:31.286 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 17:39:31.287 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 17:39:31.288 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 17:39:31.288 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:39:31.289 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:39:31.290 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:39:31.290 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:39:31.290 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:39:31.291 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:39:31.291 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:39:31.291 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:39:31.292 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:39:31.292 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 17:39:31.292 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:39:31.292 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 17:39:31.309 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:39:31.309 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 17:39:31.320 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:39:31.321 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 17:39:31.333 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:39:31.337 | INFO     | workflow.data_explore:run:66 - ✅ 数据清洗完成.....
2025-06-05 17:39:31.337 | INFO     | workflow.data_explore:run:69 - 正在绘制图表....
2025-06-05 17:39:44.278 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("高校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="高校数量")
    )
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html')

2025-06-05 17:39:44.786 | INFO     | workflow.ImgCreate:run_task:43 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.html
2025-06-05 17:39:48.233 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html')

2025-06-05 17:39:48.237 | INFO     | workflow.ImgCreate:run_task:43 - 分析维度：按办学类型划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.html
2025-06-05 17:39:52.010 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
    )
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.html')

2025-06-05 17:39:52.016 | INFO     | workflow.ImgCreate:run_task:43 - 分析维度：高校层次与类别组合分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.html
2025-06-05 17:40:09.564 | INFO     | workflow.ImgCreate:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("城市数量", [
        1, 14, 12, 1, 9, 21, 1, 4, 16, 16,
        11, 21, 14, 15, 13, 11, 11, 18, 11, 3,
        14, 14, 2, 14, 9, 2, 9, 14, 1, 10,
        3, 3, 13
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="数量"),
        tooltip_opts=opts.TooltipOpts(trigger="axis")
    )
)
chart.render(r'D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.html')

2025-06-05 17:40:09.576 | INFO     | workflow.ImgCreate:run_task:43 - 分析维度：省份-城市维度下的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.html
2025-06-05 17:40:09.577 | INFO     | workflow.data_explore:run:72 - ✅ 图表绘制完成.....
2025-06-05 17:56:26.273 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-05 17:56:26.300 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-05 17:56:26.300 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-05 17:56:26.301 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-05 17:56:26.306 | INFO     | workflow.data_explore:run:23 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-05 17:56:26.307 | INFO     | workflow.data_explore:run:58 - 数据分析维度生成完成，共 4 个维度
2025-06-05 17:56:26.307 | INFO     | workflow.data_explore:run:61 - 正在分析维度.....
2025-06-05 17:56:26.307 | INFO     | workflow.data_explore:run:64 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-05 17:56:26.307 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:56:26.307 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:56:26.309 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:56:26.309 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:56:26.310 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:56:26.310 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:56:26.310 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:56:26.310 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:56:26.311 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:56:26.313 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:56:26.313 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:56:26.313 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:56:26.314 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:56:26.314 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:56:26.315 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:56:26.315 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:56:26.315 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-05 17:56:26.315 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:56:26.316 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-05 17:56:26.345 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:56:26.345 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:56:26.354 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:56:26.354 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-05 17:56:26.364 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:56:26.368 | INFO     | workflow.data_explore:run:64 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-05 17:56:26.368 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:56:26.368 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:56:26.368 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:56:26.369 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:56:26.369 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:56:26.369 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:56:26.369 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:56:26.369 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:56:26.369 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:56:26.371 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:56:26.371 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:56:26.371 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:56:26.372 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-05 17:56:26.372 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-05 17:56:26.373 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:56:26.373 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:56:26.373 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-05 17:56:26.373 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:56:26.373 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-05 17:56:26.388 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-05 17:56:26.389 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-05 17:56:26.408 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:56:26.409 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-05 17:56:26.432 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:56:26.434 | INFO     | workflow.data_explore:run:64 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-05 17:56:26.434 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:56:26.434 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:56:26.435 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:56:26.435 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:56:26.435 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:56:26.435 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:56:26.435 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:56:26.436 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-05 17:56:26.436 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-05 17:56:26.439 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-05 17:56:26.439 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-05 17:56:26.440 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:56:26.441 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-05 17:56:26.441 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-05 17:56:26.442 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:56:26.442 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:56:26.442 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-05 17:56:26.443 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:56:26.444 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-05 17:56:26.470 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-05 17:56:26.471 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-05 17:56:26.518 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-05 17:56:26.535 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:56:26.535 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-05 17:56:26.564 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-05 17:56:26.567 | INFO     | workflow.data_explore:run:64 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-05 17:56:26.568 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-05 17:56:26.568 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-05 17:56:26.569 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-05 17:56:26.570 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-05 17:56:26.570 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-05 17:56:26.571 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-05 17:56:26.571 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-05 17:56:26.572 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-05 17:56:26.573 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-05 17:56:26.578 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-05 17:56:26.579 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-05 17:56:26.581 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-05 17:56:26.583 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-05 17:56:26.587 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-05 17:56:26.588 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-05 17:56:26.589 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-05 17:56:26.590 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-05 17:56:26.591 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-05 17:56:26.592 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-05 17:56:26.593 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-05 17:56:26.593 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-05 17:56:26.593 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-05 17:56:26.594 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-05 17:56:26.640 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-05 17:56:26.640 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-05 17:56:26.671 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-05 17:56:26.671 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-05 17:56:26.697 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-05 17:56:26.705 | INFO     | workflow.data_explore:run:67 - ✅ 数据清洗完成.....
2025-06-05 17:56:26.705 | INFO     | workflow.data_explore:run:70 - 正在绘制图表....
2025-06-05 17:56:26.705 | INFO     | workflow.data_explore:run:73 - ✅ 图表绘制完成.....
2025-06-05 17:56:26.705 | INFO     | workflow.data_explore:run:79 - 正在生成每个维度分析结论.....
