2025-06-06 10:10:13.533 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 10:10:13.582 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 10:10:13.582 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 10:10:13.583 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 10:10:13.588 | INFO     | workflow.data_explore:run:23 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 10:10:13.589 | INFO     | workflow.data_explore:run:58 - 数据分析维度生成完成，共 4 个维度
2025-06-06 10:10:13.589 | INFO     | workflow.data_explore:run:61 - 正在分析维度.....
2025-06-06 10:10:13.589 | INFO     | workflow.data_explore:run:64 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 10:10:13.589 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:10:13.589 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:10:13.591 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:10:13.592 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:10:13.592 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:10:13.592 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:10:13.592 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:10:13.592 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:10:13.593 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:10:13.595 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:10:13.595 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:10:13.595 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:10:13.596 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 10:10:13.596 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 10:10:13.597 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:10:13.597 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:10:13.597 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 10:10:13.597 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:10:13.598 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 10:10:13.620 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 10:10:13.621 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 10:10:13.630 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:10:13.630 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 10:10:13.640 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:10:13.643 | INFO     | workflow.data_explore:run:64 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 10:10:13.644 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:10:13.644 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:10:13.644 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:10:13.644 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:10:13.644 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:10:13.644 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:10:13.644 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:10:13.645 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:10:13.645 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:10:13.646 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:10:13.646 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:10:13.647 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:10:13.647 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 10:10:13.648 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 10:10:13.648 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:10:13.648 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:10:13.648 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 10:10:13.649 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:10:13.649 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 10:10:13.663 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 10:10:13.663 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 10:10:13.671 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:10:13.671 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 10:10:13.681 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:10:13.681 | INFO     | workflow.data_explore:run:64 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 10:10:13.682 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:10:13.682 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:10:13.682 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:10:13.682 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:10:13.682 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:10:13.682 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:10:13.682 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:10:13.683 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 10:10:13.683 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 10:10:13.685 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 10:10:13.685 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 10:10:13.685 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:10:13.686 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 10:10:13.686 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 10:10:13.687 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:10:13.687 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:10:13.687 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 10:10:13.687 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:10:13.688 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 10:10:13.704 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 10:10:13.704 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 10:10:13.728 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 10:10:13.736 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:10:13.736 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 10:10:13.747 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 10:10:13.749 | INFO     | workflow.data_explore:run:64 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 10:10:13.749 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:10:13.749 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:10:13.749 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:10:13.749 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:10:13.750 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:10:13.750 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:10:13.750 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:10:13.750 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 10:10:13.750 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 10:10:13.752 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 10:10:13.752 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 10:10:13.753 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:10:13.753 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:10:13.754 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:10:13.754 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:10:13.755 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:10:13.755 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 10:10:13.756 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 10:10:13.756 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:10:13.756 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:10:13.757 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 10:10:13.757 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:10:13.757 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 10:10:13.776 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 10:10:13.776 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 10:10:13.785 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:10:13.785 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 10:10:13.798 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:10:13.803 | INFO     | workflow.data_explore:run:67 - ✅ 数据清洗完成.....
2025-06-06 10:10:13.803 | INFO     | workflow.data_explore:run:70 - 正在绘制图表....
2025-06-06 10:10:13.803 | INFO     | workflow.data_explore:run:73 - ✅ 图表绘制完成.....
2025-06-06 10:10:13.803 | INFO     | workflow.data_explore:run:79 - 正在生成每个维度分析结论.....
2025-06-06 10:21:59.794 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 10:21:59.820 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 10:21:59.821 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 10:21:59.821 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 10:21:59.827 | INFO     | workflow.data_explore:run:23 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 10:21:59.827 | INFO     | workflow.data_explore:run:58 - 数据分析维度生成完成，共 4 个维度
2025-06-06 10:21:59.827 | INFO     | workflow.data_explore:run:61 - 正在分析维度.....
2025-06-06 10:21:59.827 | INFO     | workflow.data_explore:run:64 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 10:21:59.827 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:21:59.827 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:21:59.830 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:21:59.830 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:21:59.830 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:21:59.830 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:21:59.830 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:21:59.831 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:21:59.831 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:21:59.833 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:21:59.834 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:21:59.835 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:21:59.835 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 10:21:59.836 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 10:21:59.837 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:21:59.837 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:21:59.837 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 10:21:59.838 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:21:59.838 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 10:21:59.860 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 10:21:59.861 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 10:21:59.871 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:21:59.871 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 10:21:59.881 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:21:59.885 | INFO     | workflow.data_explore:run:64 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 10:21:59.885 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:21:59.885 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:21:59.886 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:21:59.886 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:21:59.886 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:21:59.886 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:21:59.886 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:21:59.887 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:21:59.887 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:21:59.888 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:21:59.888 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:21:59.889 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:21:59.889 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 10:21:59.889 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 10:21:59.890 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:21:59.890 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:21:59.890 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 10:21:59.890 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:21:59.891 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 10:21:59.904 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 10:21:59.905 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 10:21:59.913 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:21:59.913 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 10:21:59.922 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:21:59.923 | INFO     | workflow.data_explore:run:64 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 10:21:59.923 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:21:59.924 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:21:59.924 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:21:59.924 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:21:59.924 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:21:59.924 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:21:59.924 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:21:59.925 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 10:21:59.925 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 10:21:59.926 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 10:21:59.926 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 10:21:59.927 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:21:59.927 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 10:21:59.927 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 10:21:59.928 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:21:59.928 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:21:59.928 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 10:21:59.928 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:21:59.929 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 10:21:59.945 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 10:21:59.945 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 10:21:59.968 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 10:21:59.976 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:21:59.977 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 10:21:59.986 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 10:21:59.987 | INFO     | workflow.data_explore:run:64 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 10:21:59.987 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:21:59.987 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:21:59.987 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:21:59.987 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:21:59.988 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:21:59.988 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:21:59.988 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:21:59.988 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 10:21:59.988 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 10:21:59.989 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 10:21:59.989 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 10:21:59.990 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:21:59.990 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:21:59.992 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:21:59.992 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:21:59.992 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:21:59.992 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 10:21:59.993 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 10:21:59.993 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:21:59.993 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:21:59.993 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 10:21:59.994 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:21:59.994 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 10:22:00.015 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 10:22:00.015 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 10:22:00.025 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:22:00.025 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 10:22:00.039 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:22:00.043 | INFO     | workflow.data_explore:run:67 - ✅ 数据清洗完成.....
2025-06-06 10:22:00.043 | INFO     | workflow.data_explore:run:70 - 正在绘制图表....
2025-06-06 10:22:00.043 | INFO     | workflow.data_explore:run:73 - ✅ 图表绘制完成.....
2025-06-06 10:22:00.043 | INFO     | workflow.data_explore:run:79 - 正在生成每个维度分析结论.....
2025-06-06 10:40:29.363 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 10:40:29.400 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 10:40:29.400 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 10:40:29.401 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 10:40:29.406 | INFO     | workflow.data_explore:run:23 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 10:40:29.406 | INFO     | workflow.data_explore:run:58 - 数据分析维度生成完成，共 4 个维度
2025-06-06 10:40:29.406 | INFO     | workflow.data_explore:run:61 - 正在分析维度.....
2025-06-06 10:40:29.406 | INFO     | workflow.data_explore:run:64 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 10:40:29.406 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:40:29.406 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:40:29.408 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:40:29.408 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:40:29.409 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:40:29.409 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:40:29.409 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:40:29.409 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:40:29.410 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:40:29.412 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:40:29.412 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:40:29.412 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:40:29.413 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 10:40:29.413 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 10:40:29.414 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:40:29.414 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:40:29.414 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 10:40:29.414 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:40:29.415 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 10:40:29.436 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 10:40:29.437 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 10:40:29.446 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:40:29.446 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 10:40:29.456 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:40:29.460 | INFO     | workflow.data_explore:run:64 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 10:40:29.460 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:40:29.460 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:40:29.461 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:40:29.461 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:40:29.461 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:40:29.461 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:40:29.461 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:40:29.462 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:40:29.462 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:40:29.463 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:40:29.463 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:40:29.464 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:40:29.464 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 10:40:29.464 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 10:40:29.465 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:40:29.465 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:40:29.465 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 10:40:29.465 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:40:29.466 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 10:40:29.479 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 10:40:29.479 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 10:40:29.488 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:40:29.489 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 10:40:29.498 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:40:29.499 | INFO     | workflow.data_explore:run:64 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 10:40:29.499 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:40:29.499 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:40:29.499 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:40:29.499 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:40:29.500 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:40:29.500 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:40:29.500 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:40:29.500 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 10:40:29.500 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 10:40:29.502 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 10:40:29.502 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 10:40:29.503 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:40:29.503 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 10:40:29.503 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 10:40:29.504 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:40:29.504 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:40:29.504 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 10:40:29.504 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:40:29.505 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 10:40:29.517 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 10:40:29.518 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 10:40:29.538 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 10:40:29.547 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:40:29.547 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 10:40:29.557 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 10:40:29.558 | INFO     | workflow.data_explore:run:64 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 10:40:29.558 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 10:40:29.558 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 10:40:29.558 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 10:40:29.558 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 10:40:29.559 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 10:40:29.559 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 10:40:29.559 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 10:40:29.559 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 10:40:29.559 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 10:40:29.561 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 10:40:29.561 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 10:40:29.561 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 10:40:29.562 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 10:40:29.563 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 10:40:29.563 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 10:40:29.563 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 10:40:29.563 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 10:40:29.565 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 10:40:29.565 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 10:40:29.566 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 10:40:29.566 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 10:40:29.566 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 10:40:29.566 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 10:40:29.586 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 10:40:29.587 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 10:40:29.597 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 10:40:29.598 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 10:40:29.612 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 10:40:29.616 | INFO     | workflow.data_explore:run:67 - ✅ 数据清洗完成.....
2025-06-06 10:40:29.616 | INFO     | workflow.data_explore:run:70 - 正在绘制图表....
2025-06-06 10:40:29.616 | INFO     | workflow.data_explore:run:73 - ✅ 图表绘制完成.....
2025-06-06 10:40:29.616 | INFO     | workflow.data_explore:run:79 - 正在生成每个维度分析结论.....
2025-06-06 10:40:46.163 | INFO     | workflow.data_explore:parse_conclusion:110 - 正在解析数据分析结论....
2025-06-06 10:40:57.690 | INFO     | workflow.data_explore:parse_conclusion:110 - 正在解析数据分析结论....
2025-06-06 10:41:16.024 | INFO     | workflow.data_explore:parse_conclusion:110 - 正在解析数据分析结论....
2025-06-06 10:41:41.560 | INFO     | workflow.data_explore:parse_conclusion:110 - 正在解析数据分析结论....
2025-06-06 11:12:52.101 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 11:12:52.148 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 11:12:52.148 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 11:12:52.149 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 11:12:52.153 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 11:12:52.153 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 11:12:52.154 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 11:12:52.154 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 11:12:52.154 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:12:52.154 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:12:52.156 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:12:52.156 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:12:52.157 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:12:52.157 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:12:52.157 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:12:52.157 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:12:52.158 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:12:52.159 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:12:52.160 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:12:52.160 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:12:52.161 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 11:12:52.161 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 11:12:52.161 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:12:52.162 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:12:52.162 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 11:12:52.162 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:12:52.163 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 11:12:52.183 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 11:12:52.183 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 11:12:52.192 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:12:52.192 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 11:12:52.201 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:12:52.205 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 11:12:52.205 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:12:52.205 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:12:52.206 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:12:52.206 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:12:52.207 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:12:52.207 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:12:52.207 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:12:52.207 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:12:52.207 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:12:52.209 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:12:52.209 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:12:52.210 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:12:52.210 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 11:12:52.210 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 11:12:52.211 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:12:52.211 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:12:52.211 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 11:12:52.211 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:12:52.212 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 11:12:52.226 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 11:12:52.226 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 11:12:52.235 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:12:52.235 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 11:12:52.244 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:12:52.245 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 11:12:52.245 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:12:52.245 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:12:52.246 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:12:52.246 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:12:52.246 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:12:52.246 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:12:52.246 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:12:52.246 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 11:12:52.246 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 11:12:52.247 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 11:12:52.248 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 11:12:52.248 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:12:52.249 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 11:12:52.249 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 11:12:52.250 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:12:52.250 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:12:52.250 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 11:12:52.250 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:12:52.251 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 11:12:52.264 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 11:12:52.265 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 11:12:52.285 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 11:12:52.293 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:12:52.293 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 11:12:52.302 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 11:12:52.303 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 11:12:52.303 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:12:52.303 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:12:52.303 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:12:52.304 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:12:52.304 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:12:52.304 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:12:52.304 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:12:52.304 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 11:12:52.305 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 11:12:52.306 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 11:12:52.306 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 11:12:52.307 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:12:52.307 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:12:52.309 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:12:52.310 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:12:52.310 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:12:52.310 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 11:12:52.311 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 11:12:52.311 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:12:52.312 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:12:52.312 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 11:12:52.312 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:12:52.312 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 11:12:52.331 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 11:12:52.331 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 11:12:52.341 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:12:52.341 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 11:12:52.354 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:12:52.358 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 11:12:52.358 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 11:12:52.358 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 11:12:52.358 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 11:12:52.358 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 11:12:52.358 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 11:18:27.842 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 11:18:27.887 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 11:18:27.887 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 11:18:27.888 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 11:18:27.888 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 11:18:27.888 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 11:18:27.888 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 11:18:27.888 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:18:27.888 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:18:27.888 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 11:18:27.923 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 11:18:27.923 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 11:18:27.925 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:18:27.925 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 11:18:27.937 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:18:27.937 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:18:27.937 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 11:18:27.937 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 11:18:27.952 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:18:27.952 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:18:27.953 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 11:18:27.953 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:18:27.953 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 11:18:27.953 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 11:18:27.953 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 11:18:27.968 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:18:27.968 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 11:18:27.984 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:18:27.987 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 11:18:27.987 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:18:27.987 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 11:18:27.999 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 11:18:27.999 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 11:18:28.015 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 11:18:28.031 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:18:28.031 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 11:18:28.046 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 11:18:28.046 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 11:18:28.046 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:18:28.046 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:18:28.046 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 11:18:28.062 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 11:18:28.062 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 11:18:28.078 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:18:28.078 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 11:18:28.095 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:18:28.095 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 11:18:28.095 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 11:18:28.095 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 11:18:28.095 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 11:18:28.095 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 11:18:28.095 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 11:31:42.986 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 11:31:43.044 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 11:31:43.044 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 11:31:43.047 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 11:31:43.057 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 11:31:43.058 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 11:31:43.058 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 11:31:43.058 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 11:31:43.059 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:31:43.059 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:31:43.064 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:31:43.064 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:31:43.065 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:31:43.065 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:31:43.065 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:31:43.066 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:31:43.067 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:31:43.072 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:31:43.073 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:31:43.074 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:31:43.076 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 11:31:43.077 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 11:31:43.078 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:31:43.079 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:31:43.079 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 11:31:43.080 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:31:43.082 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 11:31:43.125 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 11:31:43.126 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 11:31:43.141 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:31:43.141 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 11:31:43.156 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:31:43.161 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 11:31:43.162 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:31:43.162 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:31:43.162 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:31:43.163 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:31:43.163 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:31:43.163 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:31:43.163 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:31:43.163 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:31:43.164 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:31:43.166 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:31:43.166 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:31:43.167 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:31:43.168 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 11:31:43.169 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 11:31:43.169 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:31:43.170 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:31:43.170 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 11:31:43.170 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:31:43.171 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 11:31:43.200 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 11:31:43.201 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 11:31:43.213 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:31:43.213 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 11:31:43.227 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:31:43.229 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 11:31:43.229 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:31:43.229 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:31:43.230 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:31:43.230 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:31:43.230 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:31:43.230 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:31:43.230 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:31:43.231 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 11:31:43.231 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 11:31:43.232 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 11:31:43.232 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 11:31:43.233 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:31:43.233 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 11:31:43.234 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 11:31:43.234 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:31:43.234 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:31:43.235 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 11:31:43.235 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:31:43.235 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 11:31:43.259 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 11:31:43.259 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 11:31:43.296 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 11:31:43.314 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:31:43.314 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 11:31:43.334 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 11:31:43.335 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 11:31:43.335 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 11:31:43.336 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 11:31:43.336 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 11:31:43.336 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 11:31:43.338 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 11:31:43.338 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 11:31:43.338 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 11:31:43.338 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 11:31:43.339 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 11:31:43.341 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 11:31:43.341 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 11:31:43.343 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 11:31:43.343 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 11:31:43.344 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 11:31:43.344 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 11:31:43.346 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 11:31:43.346 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 11:31:43.346 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 11:31:43.347 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 11:31:43.347 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 11:31:43.347 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 11:31:43.347 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 11:31:43.348 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 11:31:43.374 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 11:31:43.374 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 11:31:43.397 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 11:31:43.397 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 11:31:43.417 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 11:31:43.426 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 11:31:43.426 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 11:31:43.426 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 11:31:43.427 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 11:31:43.427 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 11:31:43.427 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 15:02:40.615 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 15:02:40.650 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 15:02:40.650 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 15:02:40.652 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 15:02:40.658 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 15:02:40.658 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 15:02:40.659 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 15:02:40.659 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 15:02:40.659 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 15:02:40.659 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 15:02:40.663 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 15:02:40.664 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 15:02:40.664 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 15:02:40.664 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 15:02:40.664 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 15:02:40.665 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 15:02:40.666 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 15:02:40.668 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 15:02:40.668 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 15:02:40.670 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 15:02:40.670 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 15:02:40.671 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 15:02:40.671 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 15:02:40.672 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 15:02:40.672 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 15:02:40.673 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 15:02:40.674 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 15:02:40.708 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 15:02:40.708 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 15:02:40.723 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 15:02:40.723 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 15:02:40.737 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 15:02:40.742 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 15:02:40.742 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 15:02:40.743 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 15:02:40.743 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 15:02:40.743 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 15:02:40.743 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 15:02:40.744 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 15:02:40.744 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 15:02:40.744 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 15:02:40.745 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 15:02:40.746 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 15:02:40.747 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 15:02:40.747 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 15:02:40.748 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 15:02:40.748 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 15:02:40.749 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 15:02:40.749 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 15:02:40.749 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 15:02:40.750 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 15:02:40.750 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 15:02:40.770 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 15:02:40.770 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 15:02:40.782 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 15:02:40.782 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 15:02:40.797 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 15:02:40.798 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 15:02:40.798 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 15:02:40.798 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 15:02:40.799 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 15:02:40.799 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 15:02:40.800 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 15:02:40.800 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 15:02:40.800 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 15:02:40.800 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 15:02:40.801 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 15:02:40.803 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 15:02:40.803 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 15:02:40.804 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 15:02:40.805 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 15:02:40.805 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 15:02:40.806 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 15:02:40.806 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 15:02:40.806 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 15:02:40.806 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 15:02:40.807 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 15:02:40.837 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 15:02:40.837 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 15:02:40.876 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 15:02:40.889 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 15:02:40.890 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 15:02:40.905 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 15:02:40.906 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 15:02:40.906 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 15:02:40.906 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 15:02:40.907 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 15:02:40.907 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 15:02:40.908 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 15:02:40.908 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 15:02:40.908 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 15:02:40.909 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 15:02:40.910 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 15:02:40.912 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 15:02:40.912 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 15:02:40.913 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 15:02:40.913 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 15:02:40.915 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 15:02:40.915 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 15:02:40.916 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 15:02:40.917 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 15:02:40.917 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 15:02:40.917 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 15:02:40.918 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 15:02:40.918 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 15:02:40.919 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 15:02:40.920 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 15:02:40.947 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 15:02:40.948 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 15:02:40.962 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 15:02:40.962 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 15:02:40.982 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 15:02:40.986 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 15:02:40.987 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 15:02:40.987 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 15:02:40.987 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 15:02:40.987 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 15:02:40.987 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 15:02:40.987 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 15:04:38.598 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 15:04:38.695 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 15:04:38.695 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 15:04:38.697 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 15:04:38.704 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 15:04:38.704 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 15:04:38.704 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 15:04:38.704 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 15:04:38.704 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 15:04:38.705 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 15:04:38.708 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 15:04:38.708 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 15:04:38.708 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 15:04:38.708 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 15:04:38.709 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 15:04:38.709 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 15:04:38.710 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 15:04:38.713 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 15:04:38.713 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 15:04:38.715 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 15:04:38.716 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 15:04:38.716 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 15:04:38.717 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 15:04:38.717 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 15:04:38.717 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 15:04:38.718 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 15:04:38.719 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 15:04:38.746 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 15:04:38.746 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 15:04:38.759 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 15:04:38.760 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 15:04:38.773 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 15:04:38.778 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 15:04:38.778 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 15:04:38.778 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 15:04:38.778 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 15:04:38.779 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 15:04:38.779 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 15:04:38.779 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 15:04:38.779 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 15:04:38.780 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 15:04:38.780 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 15:04:38.782 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 15:04:38.782 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 15:04:38.783 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 15:04:38.783 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 15:04:38.784 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 15:04:38.785 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 15:04:38.785 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 15:04:38.785 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 15:04:38.785 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 15:04:38.786 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 15:04:38.804 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 15:04:38.804 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 15:04:38.816 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 15:04:38.816 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 15:04:38.829 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 15:04:38.830 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 15:04:38.831 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 15:04:38.831 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 15:04:38.831 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 15:04:38.831 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 15:04:38.832 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 15:04:38.832 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 15:04:38.832 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 15:04:38.832 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 15:04:38.833 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 15:04:38.835 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 15:04:38.835 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 15:04:38.836 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 15:04:38.836 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 15:04:38.837 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 15:04:38.837 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 15:04:38.837 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 15:04:38.838 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 15:04:38.838 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 15:04:38.838 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 15:04:38.860 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 15:04:38.860 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 15:04:38.888 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 15:04:38.907 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 15:04:38.908 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 15:04:38.922 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 15:04:38.923 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 15:04:38.923 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 15:04:38.923 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 15:04:38.924 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 15:04:38.924 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 15:04:38.924 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 15:04:38.925 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 15:04:38.925 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 15:04:38.925 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 15:04:38.926 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 15:04:38.930 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 15:04:38.931 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 15:04:38.933 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 15:04:38.934 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 15:04:38.937 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 15:04:38.938 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 15:04:38.940 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 15:04:38.941 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 15:04:38.941 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 15:04:38.943 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 15:04:38.943 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 15:04:38.943 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 15:04:38.943 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 15:04:38.944 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 15:04:38.974 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 15:04:38.974 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 15:04:38.988 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 15:04:38.988 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 15:04:39.014 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 15:04:39.021 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 15:04:39.022 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 15:04:39.022 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 15:04:39.022 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 15:04:39.022 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 15:04:39.022 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 15:04:39.023 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 15:04:48.144 | INFO     | workflow.generate_report:run:43 - 正在 markdown to pdf.....
2025-06-06 16:12:49.617 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 16:12:49.657 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 16:12:49.657 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 16:12:49.659 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 16:12:49.669 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 16:12:49.670 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 16:12:49.670 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 16:12:49.670 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 16:12:49.671 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:12:49.671 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:12:49.676 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:12:49.676 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:12:49.676 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:12:49.677 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:12:49.677 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:12:49.678 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:12:49.678 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:12:49.682 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:12:49.683 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:12:49.684 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:12:49.685 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 16:12:49.685 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 16:12:49.686 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:12:49.686 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:12:49.686 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 16:12:49.688 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:12:49.688 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 16:12:49.722 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 16:12:49.723 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 16:12:49.737 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:12:49.738 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 16:12:49.756 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:12:49.761 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 16:12:49.761 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:12:49.761 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:12:49.763 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:12:49.763 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:12:49.763 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:12:49.763 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:12:49.763 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:12:49.763 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:12:49.764 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:12:49.765 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:12:49.766 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:12:49.766 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:12:49.767 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 16:12:49.767 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 16:12:49.768 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:12:49.768 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:12:49.768 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 16:12:49.769 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:12:49.769 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 16:12:49.796 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 16:12:49.796 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 16:12:49.810 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:12:49.810 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 16:12:49.824 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:12:49.825 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 16:12:49.825 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:12:49.826 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:12:49.826 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:12:49.826 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:12:49.826 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:12:49.827 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:12:49.827 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:12:49.827 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 16:12:49.827 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 16:12:49.829 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 16:12:49.829 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 16:12:49.830 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:12:49.831 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 16:12:49.831 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 16:12:49.832 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:12:49.832 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:12:49.832 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 16:12:49.832 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:12:49.833 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 16:12:49.862 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 16:12:49.862 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 16:12:49.900 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 16:12:49.926 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:12:49.926 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 16:12:49.949 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 16:12:49.951 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 16:12:49.951 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:12:49.951 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:12:49.951 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:12:49.952 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:12:49.952 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:12:49.952 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:12:49.952 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:12:49.953 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 16:12:49.953 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 16:12:49.956 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 16:12:49.956 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 16:12:49.957 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:12:49.957 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:12:49.959 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:12:49.959 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:12:49.960 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:12:49.960 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 16:12:49.961 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 16:12:49.961 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:12:49.961 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:12:49.961 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 16:12:49.962 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:12:49.963 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 16:12:50.000 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 16:12:50.001 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 16:12:50.018 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:12:50.019 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 16:12:50.042 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:12:50.047 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 16:12:50.048 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 16:12:50.048 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 16:12:50.048 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 16:12:50.048 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 16:12:50.048 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 16:12:50.048 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 16:53:06.027 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 16:53:06.071 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 16:53:06.071 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 16:53:06.073 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 16:53:06.082 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 16:53:06.082 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 16:53:06.082 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 16:53:06.082 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 16:53:06.082 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:53:06.082 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:53:06.086 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:53:06.086 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:53:06.086 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:53:06.087 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:53:06.087 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:53:06.087 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:53:06.088 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:53:06.090 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:53:06.091 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:53:06.092 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:53:06.093 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 16:53:06.093 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 16:53:06.094 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:53:06.094 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:53:06.094 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 16:53:06.095 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:53:06.096 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 16:53:06.131 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 16:53:06.132 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 16:53:06.150 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:53:06.151 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 16:53:06.170 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:53:06.176 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 16:53:06.176 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:53:06.176 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:53:06.177 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:53:06.177 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:53:06.177 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:53:06.177 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:53:06.177 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:53:06.178 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:53:06.178 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:53:06.180 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:53:06.180 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:53:06.181 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:53:06.181 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 16:53:06.182 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 16:53:06.182 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:53:06.182 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:53:06.183 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 16:53:06.183 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:53:06.184 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 16:53:06.213 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 16:53:06.213 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 16:53:06.227 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:53:06.227 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 16:53:06.247 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:53:06.248 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 16:53:06.248 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:53:06.248 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:53:06.249 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:53:06.249 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:53:06.249 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:53:06.250 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:53:06.250 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:53:06.250 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 16:53:06.251 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 16:53:06.253 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 16:53:06.253 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 16:53:06.254 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:53:06.255 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 16:53:06.255 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 16:53:06.257 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:53:06.257 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:53:06.258 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 16:53:06.258 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:53:06.260 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 16:53:06.298 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 16:53:06.298 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 16:53:06.360 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 16:53:06.372 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:53:06.373 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 16:53:06.388 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 16:53:06.390 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 16:53:06.390 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:53:06.390 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:53:06.391 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:53:06.391 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:53:06.392 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:53:06.392 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:53:06.392 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:53:06.392 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 16:53:06.393 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 16:53:06.395 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 16:53:06.395 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 16:53:06.396 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:53:06.397 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:53:06.398 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:53:06.399 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:53:06.399 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:53:06.400 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 16:53:06.400 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 16:53:06.401 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:53:06.401 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:53:06.401 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 16:53:06.401 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:53:06.402 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 16:53:06.425 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 16:53:06.425 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 16:53:06.442 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:53:06.443 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 16:53:06.469 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:53:06.476 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 16:53:06.477 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 16:53:18.122 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")')

2025-06-06 16:53:18.125 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：unterminated string literal (detected at line 26) (<string>, line 26) 自动纠正中...
2025-06-06 16:53:34.369 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")')
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")')

2025-06-06 16:53:34.369 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：unterminated string literal (detected at line 2) (<string>, line 2) 自动纠正中...
2025-06-06 16:53:45.570 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")')
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")')

2025-06-06 16:54:32.529 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 16:54:32.572 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 16:54:32.572 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 16:54:32.573 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 16:54:32.581 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 16:54:32.581 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 16:54:32.581 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 16:54:32.581 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 16:54:32.582 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:54:32.582 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:54:32.585 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:54:32.586 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:54:32.586 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:54:32.586 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:54:32.586 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:54:32.587 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:54:32.587 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:54:32.591 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:54:32.591 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:54:32.592 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:54:32.592 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 16:54:32.593 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 16:54:32.594 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:54:32.594 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:54:32.594 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 16:54:32.595 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:54:32.597 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 16:54:32.633 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 16:54:32.633 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 16:54:32.652 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:54:32.653 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 16:54:32.670 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:54:32.677 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 16:54:32.677 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:54:32.677 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:54:32.678 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:54:32.678 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:54:32.678 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:54:32.678 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:54:32.679 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:54:32.679 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:54:32.679 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:54:32.681 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:54:32.681 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:54:32.682 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:54:32.683 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 16:54:32.683 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 16:54:32.684 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:54:32.684 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:54:32.684 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 16:54:32.685 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:54:32.685 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 16:54:32.709 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 16:54:32.710 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 16:54:32.725 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:54:32.725 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 16:54:32.740 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:54:32.743 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 16:54:32.744 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:54:32.744 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:54:32.745 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:54:32.745 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:54:32.746 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:54:32.746 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:54:32.746 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:54:32.747 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 16:54:32.747 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 16:54:32.749 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 16:54:32.749 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 16:54:32.750 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:54:32.751 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 16:54:32.752 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 16:54:32.752 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:54:32.752 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:54:32.753 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 16:54:32.753 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:54:32.754 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 16:54:32.780 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 16:54:32.780 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 16:54:32.818 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 16:54:32.833 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:54:32.833 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 16:54:32.851 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 16:54:32.852 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 16:54:32.852 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:54:32.853 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:54:32.854 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:54:32.854 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:54:32.854 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:54:32.855 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:54:32.855 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:54:32.855 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 16:54:32.856 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 16:54:32.858 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 16:54:32.858 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 16:54:32.859 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:54:32.859 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:54:32.861 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:54:32.861 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:54:32.862 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:54:32.862 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 16:54:32.863 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 16:54:32.864 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:54:32.865 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:54:32.865 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 16:54:32.865 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:54:32.866 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 16:54:32.895 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 16:54:32.895 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 16:54:32.908 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:54:32.908 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 16:54:32.926 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:54:32.931 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 16:54:32.932 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 16:54:44.911 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 16:54:44.914 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 26) 自动纠正中...
2025-06-06 16:55:03.776 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 16:55:03.776 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 2) 自动纠正中...
2025-06-06 16:55:15.551 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 16:55:19.893 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 16:55:19.893 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 18) 自动纠正中...
2025-06-06 16:55:42.292 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

from pyecharts.charts import Pie
from pyecharts import options as opts
from pyecharts.render import make_snapshot
from snapshot_phantomjs import snapshot  # 确保已安装 phantomjs

# 创建图表
chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)

# 渲染并保存为图片
make_snapshot(snapshot, chart.render(), "D:/project/研究/data_analysic_agent/save_chart/按办学类型划分的高校分布分析.png")
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 16:55:42.293 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 24) 自动纠正中...
2025-06-06 16:55:52.741 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

from pyecharts.charts import Pie
from pyecharts import options as opts
from pyecharts.render import make_snapshot
from snapshot_phantomjs import snapshot  # 确保已安装 phantomjs

# 创建图表
chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)

# 渲染并保存为图片
make_snapshot(snapshot, chart.render(), "D:/project/研究/data_analysic_agent/save_chart/按办学类型划分的高校分布分析.png")
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 16:55:57.283 | INFO     | workflow.img_create:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="数量")
    )
)
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png"))

2025-06-06 16:55:57.284 | ERROR    | workflow.img_create:run_task:46 - 分析维度：高校层次与类别组合分析 执行代码出错：unmatched ')' (<string>, line 16) 自动纠正中...
2025-06-06 16:56:11.063 | WARNING  | workflow.img_create:run_task:49 - 分析维度：高校层次与类别组合分析 **纠正后**代码：

make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png"))
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png"))

2025-06-06 16:56:11.064 | ERROR    | workflow.img_create:run_task:46 - 分析维度：高校层次与类别组合分析 执行代码出错：unmatched ')' (<string>, line 2) 自动纠正中...
2025-06-06 16:56:18.907 | WARNING  | workflow.img_create:run_task:49 - 分析维度：高校层次与类别组合分析 **纠正后**代码：

from pyecharts.render import make_snapshot

# 假设 gauge 是一个已经定义好的 Gauge 图表对象
make_snapshot(snapshot, gauge.render(), r"D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png")
from pyecharts.render import make_snapshot
make_snapshot(snapshot, gauge.render(), "D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png"))

2025-06-06 16:59:57.293 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 16:59:57.379 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 16:59:57.379 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 16:59:57.379 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 16:59:57.394 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 16:59:57.403 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 16:59:57.422 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 16:59:57.422 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 16:59:57.422 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:59:57.422 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:59:57.432 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:59:57.432 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:59:57.432 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:59:57.432 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:59:57.432 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:59:57.435 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:59:57.435 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:59:57.442 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:59:57.442 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:59:57.445 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:59:57.445 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 16:59:57.445 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 16:59:57.445 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:59:57.445 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:59:57.445 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 16:59:57.445 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:59:57.452 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 16:59:57.531 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 16:59:57.531 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 16:59:57.566 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:59:57.566 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 16:59:57.594 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:59:57.612 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:59:57.612 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:59:57.631 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:59:57.631 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:59:57.633 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:59:57.634 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 16:59:57.635 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 16:59:57.637 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:59:57.637 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:59:57.638 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 16:59:57.638 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:59:57.641 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 16:59:57.688 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 16:59:57.688 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 16:59:57.720 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:59:57.721 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 16:59:57.754 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:59:57.754 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 16:59:57.754 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:59:57.754 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:59:57.754 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:59:57.754 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:59:57.754 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:59:57.754 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:59:57.754 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:59:57.754 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 16:59:57.768 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:59:57.768 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 16:59:57.832 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 16:59:57.832 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 16:59:57.894 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 16:59:57.927 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:59:57.942 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 16:59:57.973 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 16:59:57.973 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 16:59:57.973 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 16:59:57.991 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 16:59:57.991 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 16:59:57.991 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 16:59:57.995 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 16:59:57.995 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 16:59:57.995 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 16:59:57.995 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 16:59:57.995 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 16:59:58.005 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 16:59:58.005 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 16:59:58.005 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 16:59:58.005 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 16:59:58.005 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 16:59:58.010 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 16:59:58.068 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 16:59:58.068 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 16:59:58.103 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 16:59:58.103 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 16:59:58.178 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 16:59:58.195 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 16:59:58.195 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 17:00:06.693 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 17:00:06.693 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 26) 自动纠正中...
2025-06-06 17:00:28.098 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))
from pyecharts.render import make_snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 17:00:28.101 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 2) 自动纠正中...
2025-06-06 17:00:32.718 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

from pyecharts.render import make_snapshot

make_snapshot(snapshot, chart.render(), "D:\\project\\研究\\data_analysic_agent\\save_chart\\按省份划分的高校分布分析.png")
from pyecharts.render import make_snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 17:00:36.207 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
from pyecharts.render import make_snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 17:00:36.208 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 18) 自动纠正中...
2025-06-06 17:00:52.977 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))
from pyecharts.render import make_snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 17:00:52.977 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 2) 自动纠正中...
2025-06-06 17:01:01.024 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

from pyecharts.render import make_snapshot

# 假设 chart 已经定义好了
make_snapshot(snapshot, chart.render(), "D:/project/研究/data_analysic_agent/save_chart/按办学类型划分的高校分布分析.png")
from pyecharts.render import make_snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 17:03:09.074 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 17:03:09.110 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 17:03:09.110 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 17:03:09.112 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 17:03:09.118 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 17:03:09.118 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 17:03:09.119 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 17:03:09.119 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 17:03:09.119 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:03:09.120 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:03:09.124 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:03:09.124 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:03:09.124 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:03:09.125 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:03:09.125 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:03:09.125 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:03:09.126 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:03:09.128 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:03:09.129 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:03:09.130 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:03:09.130 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:03:09.131 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:03:09.131 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:03:09.132 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:03:09.132 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 17:03:09.132 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:03:09.133 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 17:03:09.165 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:03:09.166 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:03:09.177 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:03:09.177 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 17:03:09.190 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:03:09.198 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 17:03:09.198 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:03:09.199 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:03:09.200 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:03:09.200 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:03:09.200 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:03:09.201 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:03:09.201 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:03:09.202 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:03:09.203 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:03:09.207 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:03:09.207 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:03:09.208 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:03:09.210 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 17:03:09.210 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 17:03:09.211 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:03:09.211 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:03:09.211 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 17:03:09.212 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:03:09.213 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 17:03:09.234 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 17:03:09.235 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:03:09.247 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:03:09.248 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 17:03:09.268 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:03:09.269 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 17:03:09.269 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:03:09.269 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:03:09.269 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:03:09.271 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:03:09.271 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:03:09.271 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:03:09.271 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:03:09.271 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 17:03:09.272 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 17:03:09.273 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 17:03:09.273 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 17:03:09.274 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:03:09.274 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 17:03:09.274 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 17:03:09.275 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:03:09.275 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:03:09.275 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 17:03:09.276 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:03:09.276 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 17:03:09.300 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 17:03:09.300 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 17:03:09.331 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 17:03:09.344 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:03:09.345 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 17:03:09.359 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 17:03:09.360 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 17:03:09.360 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:03:09.360 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:03:09.361 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:03:09.361 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:03:09.361 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:03:09.361 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:03:09.362 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:03:09.362 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 17:03:09.362 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 17:03:09.364 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 17:03:09.364 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 17:03:09.365 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:03:09.365 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:03:09.368 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:03:09.368 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:03:09.369 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:03:09.369 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:03:09.370 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:03:09.370 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:03:09.370 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:03:09.370 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 17:03:09.371 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:03:09.371 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 17:03:09.395 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:03:09.396 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 17:03:09.408 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:03:09.408 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 17:03:09.425 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:03:09.430 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 17:03:09.430 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 17:03:20.339 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 17:03:20.343 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 27) 自动纠正中...
2025-06-06 17:03:37.075 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 17:03:37.076 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 2) 自动纠正中...
2025-06-06 17:03:46.511 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot

# 假设 chart 是你已经创建好的 pyecharts 图表对象
make_snapshot(
    snapshot,
    chart.render(),
    "D:\\project\\研究\\data_analysic_agent\\save_chart\\按省份划分的高校分布分析.png"
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png"))

2025-06-06 17:03:50.383 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 17:03:50.384 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 19) 自动纠正中...
2025-06-06 17:04:05.320 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 17:04:05.321 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：unmatched ')' (<string>, line 2) 自动纠正中...
2025-06-06 17:04:12.320 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot

make_snapshot(
    snapshot,
    chart.render(),
    r"D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png"))

2025-06-06 17:06:11.211 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 17:06:11.246 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 17:06:11.247 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 17:06:11.248 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 17:06:11.254 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 17:06:11.255 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 17:06:11.255 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 17:06:11.255 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 17:06:11.255 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:06:11.255 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:06:11.259 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:06:11.259 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:06:11.259 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:06:11.260 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:06:11.260 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:06:11.261 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:06:11.262 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:06:11.266 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:06:11.266 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:06:11.267 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:06:11.267 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:06:11.268 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:06:11.268 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:06:11.269 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:06:11.269 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 17:06:11.269 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:06:11.270 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 17:06:11.306 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:06:11.307 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:06:11.321 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:06:11.322 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 17:06:11.339 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:06:11.344 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 17:06:11.346 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:06:11.347 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:06:11.347 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:06:11.348 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:06:11.348 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:06:11.348 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:06:11.348 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:06:11.349 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:06:11.349 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:06:11.352 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:06:11.352 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:06:11.353 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:06:11.353 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 17:06:11.354 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 17:06:11.355 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:06:11.355 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:06:11.355 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 17:06:11.355 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:06:11.356 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 17:06:11.379 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 17:06:11.379 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:06:11.392 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:06:11.392 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 17:06:11.408 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:06:11.409 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 17:06:11.409 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:06:11.409 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:06:11.409 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:06:11.410 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:06:11.410 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:06:11.410 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:06:11.410 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:06:11.410 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 17:06:11.411 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 17:06:11.412 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 17:06:11.413 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 17:06:11.413 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:06:11.414 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 17:06:11.415 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 17:06:11.415 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:06:11.416 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:06:11.416 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 17:06:11.417 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:06:11.419 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 17:06:11.440 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 17:06:11.440 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 17:06:11.472 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 17:06:11.486 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:06:11.486 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 17:06:11.507 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 17:06:11.508 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 17:06:11.508 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:06:11.509 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:06:11.509 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:06:11.509 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:06:11.510 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:06:11.510 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:06:11.510 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:06:11.510 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 17:06:11.511 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 17:06:11.514 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 17:06:11.514 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 17:06:11.515 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:06:11.516 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:06:11.517 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:06:11.518 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:06:11.518 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:06:11.519 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:06:11.519 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:06:11.520 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:06:11.520 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:06:11.520 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 17:06:11.520 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:06:11.521 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 17:06:11.546 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:06:11.546 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 17:06:11.558 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:06:11.559 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 17:06:11.578 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:06:11.583 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 17:06:11.583 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 17:06:20.255 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东", 
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南", 
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西", 
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 
        158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")

2025-06-06 17:06:34.941 | INFO     | workflow.img_create:run_task:43 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png
2025-06-06 17:06:40.428 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(pos_top="15%", pos_left="right"),
    )
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c} ({d}%)"))
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png")

2025-06-06 17:06:47.466 | INFO     | workflow.img_create:run_task:43 - 分析维度：按办学类型划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png
2025-06-06 17:06:51.163 | INFO     | workflow.img_create:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别数量", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png")

2025-06-06 17:07:33.206 | INFO     | workflow.img_create:run_task:43 - 分析维度：高校层次与类别组合分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png
2025-06-06 17:07:45.718 | INFO     | workflow.img_create:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽",
        "山东", "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南",
        "浙江", "海南", "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州",
        "辽宁", "重庆", "陕西", "青海", "香港", "黑龙江"
    ])
    .add_yaxis("城市数量", [
        1, 14, 12, 1, 9, 21, 1, 4, 16, 16, 11, 21, 14, 15, 13, 11, 11, 18,
        11, 3, 14, 14, 2, 14, 9, 2, 9, 14, 1, 10, 3, 3, 13
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108,
        126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布分析"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-45)),
        yaxis_opts=opts.AxisOpts(name="数量"),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.png")

2025-06-06 17:08:05.628 | INFO     | workflow.img_create:run_task:43 - 分析维度：省份-城市维度下的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.png
2025-06-06 17:08:05.630 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 17:08:05.630 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 17:08:18.801 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 17:08:27.511 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 17:08:36.958 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 17:08:57.687 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 17:08:57.689 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 17:14:59.757 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 17:14:59.792 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 17:14:59.793 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 17:14:59.794 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 17:14:59.803 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 17:14:59.803 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 17:14:59.803 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 17:14:59.804 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 17:14:59.804 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:14:59.804 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:14:59.808 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:14:59.808 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:14:59.809 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:14:59.809 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:14:59.809 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:14:59.810 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:14:59.810 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:14:59.814 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:14:59.815 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:14:59.817 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:14:59.818 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:14:59.819 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:14:59.820 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:14:59.820 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:14:59.820 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 17:14:59.820 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:14:59.821 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 17:14:59.852 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:14:59.852 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:14:59.868 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:14:59.868 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 17:14:59.882 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:14:59.887 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 17:14:59.887 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:14:59.887 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:14:59.887 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:14:59.888 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:14:59.888 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:14:59.889 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:14:59.889 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:14:59.890 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:14:59.890 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:14:59.893 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:14:59.894 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:14:59.894 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:14:59.895 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 17:14:59.895 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 17:14:59.896 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:14:59.896 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:14:59.896 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 17:14:59.896 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:14:59.897 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 17:14:59.923 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 17:14:59.923 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:14:59.934 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:14:59.934 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 17:14:59.947 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:14:59.948 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 17:14:59.948 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:14:59.949 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:14:59.949 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:14:59.949 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:14:59.949 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:14:59.950 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:14:59.950 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:14:59.950 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 17:14:59.951 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 17:14:59.953 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 17:14:59.954 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 17:14:59.955 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:14:59.956 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 17:14:59.956 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 17:14:59.957 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:14:59.957 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:14:59.957 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 17:14:59.958 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:14:59.958 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 17:14:59.979 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 17:14:59.979 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 17:15:00.015 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 17:15:00.030 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:15:00.031 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 17:15:00.046 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 17:15:00.048 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 17:15:00.048 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:15:00.048 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:15:00.050 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:15:00.050 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:15:00.050 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:15:00.050 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:15:00.051 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:15:00.051 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 17:15:00.052 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 17:15:00.054 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 17:15:00.054 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 17:15:00.055 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:15:00.055 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:15:00.057 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:15:00.057 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:15:00.058 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:15:00.058 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:15:00.059 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:15:00.060 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:15:00.060 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:15:00.060 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 17:15:00.061 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:15:00.061 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 17:15:00.083 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:15:00.083 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 17:15:00.096 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:15:00.096 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 17:15:00.113 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:15:00.117 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 17:15:00.118 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 17:15:10.519 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东", 
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南", 
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西", 
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 
        158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")

2025-06-06 17:15:30.431 | INFO     | workflow.img_create:run_task:43 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按省份划分的高校分布分析.png
2025-06-06 17:15:34.288 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png")

2025-06-06 17:15:43.850 | INFO     | workflow.img_create:run_task:43 - 分析维度：按办学类型划分的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png
2025-06-06 17:15:47.083 | INFO     | workflow.img_create:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png")

2025-06-06 17:15:57.158 | INFO     | workflow.img_create:run_task:43 - 分析维度：高校层次与类别组合分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\高校层次与类别组合分析.png
2025-06-06 17:16:07.347 | INFO     | workflow.img_create:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.png")

2025-06-06 17:16:23.322 | INFO     | workflow.img_create:run_task:43 - 分析维度：省份-城市维度下的高校分布分析 生成图表成功，图表保存路径：D:\project\研究\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.png
2025-06-06 17:16:23.324 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 17:16:23.324 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 17:16:43.959 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 17:16:53.082 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 17:17:02.860 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 17:17:26.157 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 17:17:26.159 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 17:18:08.985 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 17:18:08.987 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 17:18:17.051 | INFO     | workflow.generate_report:run:43 - 正在 markdown to pdf.....
2025-06-06 17:23:06.013 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 17:23:06.053 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 17:23:06.053 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 17:23:06.054 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 17:23:06.060 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 17:23:06.061 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 17:23:06.061 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 17:23:06.061 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 17:23:06.062 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:23:06.062 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:23:06.069 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:23:06.069 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:23:06.069 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:23:06.070 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:23:06.070 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:23:06.071 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:23:06.071 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:23:06.075 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:23:06.075 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:23:06.077 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:23:06.078 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:23:06.078 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:23:06.079 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:23:06.097 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:23:06.097 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 17:23:06.098 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:23:06.099 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 17:23:06.132 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:23:06.134 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:23:06.149 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:23:06.149 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 17:23:06.164 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:23:06.169 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 17:23:06.169 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:23:06.169 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:23:06.169 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:23:06.170 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:23:06.170 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:23:06.170 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:23:06.170 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:23:06.170 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:23:06.171 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:23:06.172 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:23:06.173 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:23:06.173 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:23:06.174 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 17:23:06.174 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 17:23:06.174 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:23:06.174 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:23:06.175 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 17:23:06.175 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:23:06.176 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 17:23:06.194 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 17:23:06.194 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:23:06.205 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:23:06.205 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 17:23:06.218 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:23:06.219 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 17:23:06.220 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:23:06.220 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:23:06.220 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:23:06.221 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:23:06.221 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:23:06.221 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:23:06.221 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:23:06.221 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 17:23:06.222 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 17:23:06.224 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 17:23:06.224 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 17:23:06.225 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:23:06.225 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 17:23:06.226 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 17:23:06.226 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:23:06.227 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:23:06.227 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 17:23:06.227 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:23:06.228 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 17:23:06.248 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 17:23:06.249 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 17:23:06.276 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 17:23:06.290 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:23:06.290 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 17:23:06.305 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 17:23:06.305 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 17:23:06.306 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:23:06.306 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:23:06.306 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:23:06.306 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:23:06.307 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:23:06.307 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:23:06.307 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:23:06.307 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 17:23:06.308 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 17:23:06.309 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 17:23:06.309 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 17:23:06.310 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:23:06.311 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:23:06.312 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:23:06.312 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:23:06.312 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:23:06.313 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:23:06.314 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:23:06.314 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:23:06.314 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:23:06.314 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 17:23:06.315 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:23:06.316 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 17:23:06.337 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:23:06.338 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 17:23:06.350 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:23:06.350 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 17:23:06.368 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:23:06.372 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 17:23:06.373 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 17:23:06.373 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 17:23:06.373 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 17:23:06.373 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 17:23:06.373 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 17:23:06.373 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 17:23:15.584 | INFO     | workflow.generate_report:run:43 - 正在 markdown to pdf.....
2025-06-06 17:25:44.407 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 17:25:44.448 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 17:25:44.448 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 17:25:44.450 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 17:25:44.456 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 17:25:44.456 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 17:25:44.456 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 17:25:44.457 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 17:25:44.457 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:25:44.457 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:25:44.461 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:25:44.461 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:25:44.461 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:25:44.461 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:25:44.461 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:25:44.462 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:25:44.463 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:25:44.465 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:25:44.466 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:25:44.466 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:25:44.467 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:25:44.467 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:25:44.469 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:25:44.469 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:25:44.469 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 17:25:44.469 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:25:44.470 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 17:25:44.500 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:25:44.502 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:25:44.513 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:25:44.513 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 17:25:44.526 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:25:44.530 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 17:25:44.530 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:25:44.530 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:25:44.531 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:25:44.531 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:25:44.531 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:25:44.531 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:25:44.532 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:25:44.532 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:25:44.533 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:25:44.534 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:25:44.535 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:25:44.535 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:25:44.535 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 17:25:44.536 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 17:25:44.537 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:25:44.537 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:25:44.537 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 17:25:44.537 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:25:44.539 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 17:25:44.556 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 17:25:44.556 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:25:44.568 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:25:44.568 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 17:25:44.579 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:25:44.580 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 17:25:44.581 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:25:44.581 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:25:44.581 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:25:44.581 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:25:44.582 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:25:44.582 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:25:44.582 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:25:44.582 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 17:25:44.583 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 17:25:44.586 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 17:25:44.586 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 17:25:44.587 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:25:44.588 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 17:25:44.588 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 17:25:44.589 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:25:44.589 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:25:44.589 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 17:25:44.590 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:25:44.590 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 17:25:44.607 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 17:25:44.607 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 17:25:44.637 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 17:25:44.649 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:25:44.649 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 17:25:44.663 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 17:25:44.664 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 17:25:44.664 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:25:44.664 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:25:44.664 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:25:44.665 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:25:44.665 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:25:44.665 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:25:44.665 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:25:44.665 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 17:25:44.666 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 17:25:44.668 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 17:25:44.668 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 17:25:44.669 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:25:44.669 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:25:44.671 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:25:44.671 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:25:44.672 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:25:44.672 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:25:44.673 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:25:44.674 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:25:44.674 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:25:44.674 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 17:25:44.674 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:25:44.675 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 17:25:44.699 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:25:44.699 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 17:25:44.711 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:25:44.711 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 17:25:44.728 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:25:44.732 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 17:25:44.732 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 17:25:44.732 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 17:25:44.732 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 17:25:44.732 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 17:25:44.732 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 17:25:44.733 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 17:26:05.614 | INFO     | workflow.generate_report:run:43 - 正在 markdown to pdf.....
2025-06-06 17:27:29.359 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 17:27:29.393 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 17:27:29.393 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 17:27:29.395 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 17:27:29.400 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 17:27:29.401 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 17:27:29.401 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 17:27:29.401 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 17:27:29.401 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:27:29.401 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:27:29.404 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:27:29.405 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:27:29.405 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:27:29.405 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:27:29.405 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:27:29.406 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:27:29.407 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:27:29.409 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:27:29.409 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:27:29.410 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:27:29.411 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:27:29.411 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:27:29.412 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:27:29.413 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:27:29.413 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 17:27:29.413 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:27:29.414 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 17:27:29.447 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:27:29.448 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:27:29.462 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:27:29.462 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 17:27:29.476 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:27:29.481 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 17:27:29.481 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:27:29.481 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:27:29.482 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:27:29.482 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:27:29.482 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:27:29.482 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:27:29.482 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:27:29.483 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:27:29.483 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:27:29.485 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:27:29.485 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:27:29.486 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:27:29.487 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 17:27:29.487 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 17:27:29.488 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:27:29.488 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:27:29.488 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 17:27:29.489 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:27:29.490 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 17:27:29.509 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 17:27:29.509 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 17:27:29.521 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:27:29.521 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 17:27:29.533 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:27:29.535 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 17:27:29.535 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:27:29.535 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:27:29.536 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:27:29.536 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:27:29.536 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:27:29.536 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:27:29.537 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:27:29.537 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 17:27:29.538 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 17:27:29.540 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 17:27:29.540 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 17:27:29.541 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:27:29.541 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 17:27:29.542 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 17:27:29.542 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:27:29.542 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:27:29.542 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 17:27:29.543 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:27:29.543 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 17:27:29.561 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 17:27:29.562 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 17:27:29.595 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 17:27:29.606 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:27:29.606 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 17:27:29.619 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 17:27:29.620 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 17:27:29.620 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 17:27:29.620 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 17:27:29.621 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 17:27:29.621 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 17:27:29.621 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 17:27:29.621 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 17:27:29.621 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 17:27:29.622 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 17:27:29.622 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 17:27:29.624 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 17:27:29.624 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 17:27:29.625 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 17:27:29.625 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 17:27:29.627 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 17:27:29.627 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 17:27:29.627 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 17:27:29.628 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 17:27:29.628 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 17:27:29.629 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 17:27:29.630 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 17:27:29.630 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 17:27:29.631 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 17:27:29.632 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 17:27:29.655 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 17:27:29.655 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 17:27:29.668 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 17:27:29.669 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 17:27:29.684 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 17:27:29.689 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 17:27:29.689 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 17:27:29.689 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 17:27:29.689 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 17:27:29.689 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 17:27:29.689 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 17:27:29.689 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 17:27:36.385 | INFO     | workflow.generate_report:run:43 - 正在 markdown to pdf.....
2025-06-06 18:04:29.841 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 18:04:29.868 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 18:04:29.869 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 18:04:29.870 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 18:04:29.874 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 18:04:29.874 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 18:04:29.874 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 18:04:29.874 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 18:04:29.875 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:04:29.875 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:04:29.877 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:04:29.878 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:04:29.878 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:04:29.878 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:04:29.878 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:04:29.879 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:04:29.879 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:04:29.881 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:04:29.882 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:04:29.882 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:04:29.883 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:04:29.883 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:04:29.884 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:04:29.884 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:04:29.884 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 18:04:29.884 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:04:29.885 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 18:04:29.906 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:04:29.906 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:04:29.916 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:04:29.916 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 18:04:29.926 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:04:29.930 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 18:04:29.930 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:04:29.930 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:04:29.930 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:04:29.931 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:04:29.931 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:04:29.931 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:04:29.931 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:04:29.931 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:04:29.932 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:04:29.933 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:04:29.933 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:04:29.933 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:04:29.934 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 18:04:29.934 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 18:04:29.935 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:04:29.935 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:04:29.935 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 18:04:29.935 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:04:29.935 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 18:04:29.948 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 18:04:29.948 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:04:29.957 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:04:29.957 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 18:04:29.967 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:04:29.968 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 18:04:29.968 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:04:29.968 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:04:29.969 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:04:29.969 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:04:29.969 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:04:29.969 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:04:29.969 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:04:29.969 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 18:04:29.970 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 18:04:29.971 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 18:04:29.971 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 18:04:29.972 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:04:29.972 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 18:04:29.972 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 18:04:29.973 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:04:29.973 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:04:29.973 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 18:04:29.973 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:04:29.974 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 18:04:29.990 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 18:04:29.990 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 18:04:30.009 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 18:04:30.018 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:04:30.018 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 18:04:30.029 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 18:04:30.030 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 18:04:30.030 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:04:30.030 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:04:30.031 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:04:30.031 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:04:30.031 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:04:30.031 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:04:30.031 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:04:30.031 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 18:04:30.032 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 18:04:30.033 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 18:04:30.033 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 18:04:30.034 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:04:30.034 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:04:30.035 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:04:30.035 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:04:30.036 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:04:30.036 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:04:30.036 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:04:30.037 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:04:30.037 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:04:30.037 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 18:04:30.037 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:04:30.038 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 18:04:30.056 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:04:30.056 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 18:04:30.066 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:04:30.066 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 18:04:30.078 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:04:30.082 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 18:04:30.082 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 18:04:40.970 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("高校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="高校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/按省份划分的高校分布分析.png")

2025-06-06 18:04:50.138 | INFO     | workflow.img_create:run_task:43 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：/按省份划分的高校分布分析.png
2025-06-06 18:04:54.154 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        series_name="高校分布",
        data=[("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
    .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}"))
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/按办学类型划分的高校分布分析.png")

2025-06-06 18:04:54.155 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：Pie.add() got an unexpected keyword argument 'data' 自动纠正中...
2025-06-06 18:05:09.719 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

.add(
    series_name="高校分布",
    data=[("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
    radius=["15%", "75%"],
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/按办学类型划分的高校分布分析.png")

2025-06-06 18:05:09.720 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按办学类型划分的高校分布分析 执行代码出错：invalid syntax (<string>, line 2) 自动纠正中...
2025-06-06 18:05:17.552 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按办学类型划分的高校分布分析 **纠正后**代码：

from pyecharts import charts
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot

# 创建饼图对象
chart = (
    charts.Pie()
    .add(
        series_name="高校分布",
        data=[("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
)

# 渲染并保存为图片
make_snapshot(snapshot, chart.render(), "/按办学类型划分的高校分布分析.png")
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/按办学类型划分的高校分布分析.png")

2025-06-06 18:05:20.399 | INFO     | workflow.img_create:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/高校层次与类别组合分析.png")

2025-06-06 18:05:23.572 | ERROR    | workflow.img_create:run_task:46 - 分析维度：高校层次与类别组合分析 执行代码出错：Message: Service C:\Users\zhoujk2\.cache\selenium\chromedriver\win64\136.0.7103.113\chromedriver.exe unexpectedly exited. Status code was: 3221225786
 自动纠正中...
2025-06-06 18:06:47.465 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 18:06:47.491 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 18:06:47.491 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 18:06:47.492 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 18:06:47.496 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 18:06:47.496 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 18:06:47.496 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 18:06:47.496 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 18:06:47.496 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:06:47.496 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:06:47.499 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:06:47.499 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:06:47.499 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:06:47.499 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:06:47.499 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:06:47.500 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:06:47.500 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:06:47.502 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:06:47.502 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:06:47.503 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:06:47.503 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:06:47.504 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:06:47.504 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:06:47.504 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:06:47.504 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 18:06:47.504 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:06:47.505 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 18:06:47.528 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:06:47.528 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:06:47.537 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:06:47.537 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 18:06:47.548 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:06:47.552 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 18:06:47.552 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:06:47.552 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:06:47.552 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:06:47.553 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:06:47.553 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:06:47.553 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:06:47.553 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:06:47.553 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:06:47.554 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:06:47.555 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:06:47.555 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:06:47.555 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:06:47.556 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 18:06:47.556 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 18:06:47.557 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:06:47.557 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:06:47.557 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 18:06:47.558 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:06:47.558 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 18:06:47.572 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 18:06:47.572 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:06:47.582 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:06:47.582 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 18:06:47.591 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:06:47.592 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 18:06:47.592 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:06:47.592 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:06:47.592 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:06:47.593 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:06:47.593 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:06:47.593 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:06:47.593 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:06:47.593 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 18:06:47.593 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 18:06:47.595 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 18:06:47.595 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 18:06:47.595 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:06:47.596 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 18:06:47.596 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 18:06:47.597 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:06:47.597 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:06:47.597 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 18:06:47.597 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:06:47.597 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 18:06:47.614 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 18:06:47.614 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 18:06:47.633 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 18:06:47.642 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:06:47.642 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 18:06:47.652 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 18:06:47.653 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 18:06:47.653 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:06:47.653 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:06:47.654 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:06:47.654 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:06:47.654 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:06:47.654 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:06:47.654 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:06:47.654 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 18:06:47.655 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 18:06:47.656 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 18:06:47.656 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 18:06:47.657 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:06:47.657 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:06:47.658 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:06:47.659 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:06:47.659 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:06:47.659 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:06:47.660 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:06:47.660 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:06:47.660 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:06:47.660 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 18:06:47.660 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:06:47.661 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 18:06:47.678 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:06:47.679 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 18:06:47.688 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:06:47.688 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 18:06:47.700 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:06:47.703 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 18:06:47.704 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 18:06:57.398 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/按省份划分的高校分布分析.png")

2025-06-06 18:07:08.021 | INFO     | workflow.img_create:run_task:43 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：/按省份划分的高校分布分析.png
2025-06-06 18:07:11.744 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/按办学类型划分的高校分布分析.png")

2025-06-06 18:07:19.390 | INFO     | workflow.img_create:run_task:43 - 分析维度：按办学类型划分的高校分布分析 生成图表成功，图表保存路径：/按办学类型划分的高校分布分析.png
2025-06-06 18:07:23.788 | INFO     | workflow.img_create:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/高校层次与类别组合分析.png")

2025-06-06 18:07:31.502 | INFO     | workflow.img_create:run_task:43 - 分析维度：高校层次与类别组合分析 生成图表成功，图表保存路径：/高校层次与类别组合分析.png
2025-06-06 18:07:45.157 | INFO     | workflow.img_create:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("城市数量", [
        1, 14, 12, 1, 9, 21, 1, 4, 16, 16,
        11, 21, 14, 15, 13, 11, 11, 18, 11, 3,
        14, 14, 2, 14, 9, 2, 9, 14, 1, 10,
        3, 3, 13
    ])
    .add_yaxis("高校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        tooltip_opts=opts.TooltipOpts(trigger="axis")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/省份-城市维度下的高校分布分析.png")

2025-06-06 18:07:54.760 | INFO     | workflow.img_create:run_task:43 - 分析维度：省份-城市维度下的高校分布分析 生成图表成功，图表保存路径：/省份-城市维度下的高校分布分析.png
2025-06-06 18:07:54.762 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 18:07:54.762 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 18:08:14.574 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 18:08:22.228 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 18:08:31.852 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 18:08:49.515 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 18:08:49.515 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 18:08:49.516 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 18:08:49.516 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 18:08:57.499 | INFO     | workflow.generate_report:run:43 - 正在 markdown to pdf.....
2025-06-06 18:14:35.456 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 18:14:35.481 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 18:14:35.481 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 18:14:35.482 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 18:14:35.487 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 18:14:35.487 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 18:14:35.487 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 18:14:35.487 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 18:14:35.487 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:14:35.487 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:14:35.489 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:14:35.490 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:14:35.490 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:14:35.490 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:14:35.490 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:14:35.490 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:14:35.491 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:14:35.493 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:14:35.493 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:14:35.494 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:14:35.495 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:14:35.495 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:14:35.495 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:14:35.496 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:14:35.496 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 18:14:35.496 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:14:35.497 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 18:14:35.518 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:14:35.518 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:14:35.527 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:14:35.527 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 18:14:35.537 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:14:35.540 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 18:14:35.540 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:14:35.540 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:14:35.541 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:14:35.541 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:14:35.541 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:14:35.541 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:14:35.541 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:14:35.541 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:14:35.542 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:14:35.543 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:14:35.543 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:14:35.543 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:14:35.544 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 18:14:35.544 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 18:14:35.545 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:14:35.545 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:14:35.545 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 18:14:35.545 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:14:35.546 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 18:14:35.559 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 18:14:35.559 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:14:35.568 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:14:35.568 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 18:14:35.579 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:14:35.579 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 18:14:35.580 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:14:35.580 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:14:35.580 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:14:35.580 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:14:35.580 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:14:35.580 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:14:35.580 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:14:35.580 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 18:14:35.581 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 18:14:35.582 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 18:14:35.582 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 18:14:35.583 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:14:35.584 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 18:14:35.584 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 18:14:35.584 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:14:35.585 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:14:35.585 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 18:14:35.585 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:14:35.585 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 18:14:35.599 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 18:14:35.599 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 18:14:35.619 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 18:14:35.627 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:14:35.628 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 18:14:35.637 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 18:14:35.637 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 18:14:35.637 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:14:35.638 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:14:35.638 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:14:35.638 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:14:35.638 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:14:35.638 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:14:35.638 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:14:35.639 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 18:14:35.639 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 18:14:35.640 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 18:14:35.640 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 18:14:35.641 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:14:35.641 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:14:35.642 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:14:35.643 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:14:35.643 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:14:35.643 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:14:35.644 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:14:35.644 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:14:35.644 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:14:35.644 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 18:14:35.644 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:14:35.645 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 18:14:35.661 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:14:35.661 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 18:14:35.670 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:14:35.670 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 18:14:35.682 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:14:35.686 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 18:14:35.686 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 18:14:35.686 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 18:14:35.686 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 18:14:35.686 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 18:14:35.686 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 18:19:24.595 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 18:19:24.620 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 18:19:24.620 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 18:19:24.621 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 18:19:24.626 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 18:19:24.626 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 18:19:24.626 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 18:19:24.626 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 18:19:24.626 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:19:24.626 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:19:24.629 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:19:24.629 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:19:24.629 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:19:24.629 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:19:24.629 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:19:24.630 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:19:24.630 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:19:24.632 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:19:24.632 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:19:24.633 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:19:24.633 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:19:24.633 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:19:24.634 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:19:24.634 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:19:24.634 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 18:19:24.634 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:19:24.635 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 18:19:24.655 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:19:24.655 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:19:24.665 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:19:24.665 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 18:19:24.675 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:19:24.680 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 18:19:24.680 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:19:24.680 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:19:24.681 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:19:24.681 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:19:24.681 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:19:24.681 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:19:24.681 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:19:24.681 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:19:24.682 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:19:24.683 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:19:24.684 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:19:24.684 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:19:24.684 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 18:19:24.685 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 18:19:24.685 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:19:24.685 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:19:24.685 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 18:19:24.686 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:19:24.686 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 18:19:24.702 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 18:19:24.702 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:19:24.710 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:19:24.710 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 18:19:24.720 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:19:24.720 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 18:19:24.721 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:19:24.721 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:19:24.721 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:19:24.721 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:19:24.721 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:19:24.721 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:19:24.722 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:19:24.722 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 18:19:24.722 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 18:19:24.723 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 18:19:24.723 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 18:19:24.725 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:19:24.725 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 18:19:24.725 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 18:19:24.725 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:19:24.726 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:19:24.726 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 18:19:24.726 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:19:24.727 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 18:19:24.741 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 18:19:24.741 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 18:19:24.760 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 18:19:24.768 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:19:24.768 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 18:19:24.778 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 18:19:24.779 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 18:19:24.779 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:19:24.779 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:19:24.779 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:19:24.779 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:19:24.780 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:19:24.780 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:19:24.780 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:19:24.780 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 18:19:24.780 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 18:19:24.782 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 18:19:24.782 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 18:19:24.782 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:19:24.783 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:19:24.784 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:19:24.784 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:19:24.785 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:19:24.785 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:19:24.785 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:19:24.786 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:19:24.786 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:19:24.786 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 18:19:24.786 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:19:24.788 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 18:19:24.804 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:19:24.804 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 18:19:24.814 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:19:24.814 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 18:19:24.827 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:19:24.832 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 18:19:24.832 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 18:19:24.832 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 18:19:24.832 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 18:19:24.832 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 18:19:24.832 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 18:19:35.796 | INFO     | workflow.generate_report:run:35 - 正在总结 markdown 数据.....
2025-06-06 18:19:41.461 | INFO     | workflow.generate_report:run:43 - 正在 markdown to pdf.....
2025-06-06 18:26:30.872 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 18:26:30.898 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 18:26:30.898 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 18:26:30.899 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 18:26:30.905 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 18:26:30.905 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 18:26:30.905 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 18:26:30.905 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 18:26:30.905 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:26:30.905 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:26:30.908 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:26:30.908 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:26:30.908 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:26:30.908 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:26:30.908 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:26:30.909 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:26:30.909 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:26:30.911 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:26:30.911 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:26:30.912 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:26:30.912 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:26:30.913 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:26:30.913 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:26:30.913 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:26:30.914 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 18:26:30.914 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:26:30.915 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 18:26:30.938 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:26:30.938 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:26:30.948 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:26:30.948 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 18:26:30.958 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:26:30.962 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 18:26:30.962 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:26:30.962 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:26:30.962 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:26:30.963 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:26:30.963 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:26:30.963 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:26:30.963 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:26:30.964 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:26:30.964 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:26:30.965 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:26:30.966 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:26:30.966 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:26:30.966 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 18:26:30.967 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 18:26:30.967 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:26:30.967 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:26:30.967 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 18:26:30.968 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:26:30.968 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 18:26:30.982 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 18:26:30.982 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:26:30.991 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:26:30.991 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 18:26:31.002 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:26:31.003 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 18:26:31.003 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:26:31.003 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:26:31.003 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:26:31.003 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:26:31.003 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:26:31.004 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:26:31.004 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:26:31.004 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 18:26:31.004 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 18:26:31.006 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 18:26:31.006 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 18:26:31.006 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:26:31.007 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 18:26:31.007 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 18:26:31.008 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:26:31.008 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:26:31.008 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 18:26:31.008 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:26:31.009 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 18:26:31.023 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 18:26:31.023 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 18:26:31.045 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 18:26:31.054 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:26:31.054 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 18:26:31.064 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 18:26:31.065 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 18:26:31.065 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:26:31.065 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:26:31.065 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:26:31.065 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:26:31.065 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:26:31.066 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:26:31.066 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:26:31.066 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 18:26:31.066 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 18:26:31.067 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 18:26:31.068 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 18:26:31.068 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:26:31.068 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:26:31.070 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:26:31.070 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:26:31.070 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:26:31.071 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:26:31.071 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:26:31.071 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:26:31.071 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:26:31.072 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 18:26:31.072 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:26:31.072 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 18:26:31.090 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:26:31.090 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 18:26:31.101 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:26:31.101 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 18:26:31.113 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:26:31.117 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 18:26:31.117 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 18:26:31.117 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 18:26:31.117 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 18:26:31.117 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 18:26:31.117 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 18:26:31.118 | INFO     | workflow.generate_report:run:36 - 正在总结 markdown 数据.....
2025-06-06 18:26:37.278 | INFO     | workflow.generate_report:run:44 - 正在保存 markdown.....
2025-06-06 18:26:37.280 | INFO     | workflow.generate_report:run:48 - 正在 markdown to pdf.....
2025-06-06 18:28:01.619 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 18:28:01.646 | INFO     | utils.utils:read_data:29 - 读取数据：D:\project\研究\data_analysic_agent\data\大学专业\school.csv
2025-06-06 18:28:01.646 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 18:28:01.647 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 18:28:01.652 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 18:28:01.652 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 18:28:01.652 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 18:28:01.652 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 18:28:01.652 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:28:01.652 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:28:01.655 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:28:01.655 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:28:01.655 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:28:01.655 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:28:01.656 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:28:01.656 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:28:01.656 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:28:01.658 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:28:01.659 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:28:01.659 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:28:01.660 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:28:01.660 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:28:01.661 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:28:01.661 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:28:01.661 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 18:28:01.661 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:28:01.662 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 18:28:01.683 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:28:01.684 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:28:01.692 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:28:01.693 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 18:28:01.702 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:28:01.706 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 18:28:01.706 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:28:01.706 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:28:01.707 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:28:01.707 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:28:01.707 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:28:01.707 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:28:01.707 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:28:01.707 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:28:01.708 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:28:01.709 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:28:01.709 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:28:01.710 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:28:01.710 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 18:28:01.710 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 18:28:01.711 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:28:01.711 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:28:01.711 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 18:28:01.711 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:28:01.712 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 18:28:01.725 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 18:28:01.725 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 18:28:01.733 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:28:01.733 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 18:28:01.743 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:28:01.743 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 18:28:01.744 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:28:01.744 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:28:01.744 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:28:01.744 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:28:01.744 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:28:01.744 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:28:01.744 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:28:01.745 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 18:28:01.745 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 18:28:01.747 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 18:28:01.747 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 18:28:01.747 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:28:01.748 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 18:28:01.748 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 18:28:01.749 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:28:01.749 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:28:01.749 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 18:28:01.749 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:28:01.750 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 18:28:01.764 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 18:28:01.765 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 18:28:01.784 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 18:28:01.793 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:28:01.793 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 18:28:01.803 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 18:28:01.804 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 18:28:01.804 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 18:28:01.804 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 18:28:01.804 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 18:28:01.804 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 18:28:01.805 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 18:28:01.805 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 18:28:01.805 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 18:28:01.805 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 18:28:01.805 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 18:28:01.807 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 18:28:01.807 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 18:28:01.807 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 18:28:01.808 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 18:28:01.809 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 18:28:01.809 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 18:28:01.810 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 18:28:01.810 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 18:28:01.811 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 18:28:01.811 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 18:28:01.811 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 18:28:01.811 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 18:28:01.811 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 18:28:01.812 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 18:28:01.830 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 18:28:01.830 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 18:28:01.839 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 18:28:01.839 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 18:28:01.853 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 18:28:01.857 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 18:28:01.857 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 18:28:01.857 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 18:28:01.857 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 18:28:01.857 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 18:28:01.857 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 18:28:01.857 | INFO     | workflow.generate_report:run:36 - 正在总结 markdown 数据.....
2025-06-06 18:28:21.835 | INFO     | workflow.generate_report:run:44 - 正在保存 markdown.....
2025-06-06 18:28:21.837 | INFO     | workflow.generate_report:run:46 - ✅ 数据分析报告 markdown 生成完成.....
2025-06-06 21:09:15.935 | INFO     | __main__:<module>:15 - 正在进行了数据探索....
2025-06-06 21:09:15.946 | ERROR    | utils.utils:read_data:35 - 加载数据失败: [Errno 2] No such file or directory: 'D:\\project\\研究\\data_analysic_agent\\data\\大学专业\\school.csv'
Traceback (most recent call last):
  File "C:\Users\admin\Desktop\data_analysic_agent\utils\utils.py", line 9, in read_data
    df = pd.read_csv(data_path, encoding='utf-8')
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'D:\\project\\研究\\data_analysic_agent\\data\\大学专业\\school.csv'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\admin\Desktop\data_analysic_agent\utils\utils.py", line 11, in read_data
    df = pd.read_csv(data_path, encoding='gbk')
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'D:\\project\\研究\\data_analysic_agent\\data\\大学专业\\school.csv'

2025-06-06 21:10:19.019 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 21:10:19.066 | INFO     | utils.utils:read_data:29 - 读取数据：C:\Users\admin\Desktop\data_analysic_agent\data\大学专业\school.csv
2025-06-06 21:10:19.067 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 21:10:19.069 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 21:10:19.087 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 21:10:19.088 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 21:10:19.088 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 21:10:19.089 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 21:10:19.089 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:10:19.089 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:10:19.091 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:10:19.092 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:10:19.093 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:10:19.094 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:10:19.094 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:10:19.096 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:10:19.096 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:10:19.102 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:10:19.102 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:10:19.104 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:10:19.106 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:10:19.107 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:10:19.107 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:10:19.108 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:10:19.108 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 21:10:19.108 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:10:19.112 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 21:10:19.157 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:10:19.157 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:10:19.186 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:10:19.186 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 21:10:19.219 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:10:19.245 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 21:10:19.246 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:10:19.246 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:10:19.248 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:10:19.249 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:10:19.250 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:10:19.251 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:10:19.251 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:10:19.252 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:10:19.254 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:10:19.262 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:10:19.263 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:10:19.265 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:10:19.267 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 21:10:19.269 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 21:10:19.271 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:10:19.272 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:10:19.273 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 21:10:19.274 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:10:19.278 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 21:10:19.343 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 21:10:19.344 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:10:19.388 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:10:19.389 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 21:10:19.424 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:10:19.426 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 21:10:19.427 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:10:19.427 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:10:19.428 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:10:19.428 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:10:19.429 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:10:19.430 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:10:19.431 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:10:19.433 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 21:10:19.434 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 21:10:19.442 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 21:10:19.443 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 21:10:19.446 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:10:19.447 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 21:10:19.449 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 21:10:19.452 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:10:19.452 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:10:19.453 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 21:10:19.453 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:10:19.455 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 21:10:19.518 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 21:10:19.519 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 21:10:19.577 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 21:10:19.606 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:10:19.606 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 21:10:19.639 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 21:10:19.641 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 21:10:19.641 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:10:19.642 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:10:19.642 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:10:19.643 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:10:19.645 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:10:19.646 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:10:19.647 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:10:19.647 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 21:10:19.648 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 21:10:19.653 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 21:10:19.654 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 21:10:19.656 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:10:19.658 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:10:19.666 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:10:19.666 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:10:19.668 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:10:19.669 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:10:19.672 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:10:19.673 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:10:19.673 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:10:19.674 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 21:10:19.675 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:10:19.677 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 21:10:19.741 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:10:19.742 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 21:10:19.784 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:10:19.785 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 21:10:19.850 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:10:19.866 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 21:10:19.866 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 21:10:39.920 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东", 
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南", 
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西", 
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 
        158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/按省份划分的高校分布分析.png")

2025-06-06 21:10:39.922 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：No module named 'pyecharts' 自动纠正中...
2025-06-06 21:11:21.880 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 21:11:21.927 | INFO     | utils.utils:read_data:29 - 读取数据：C:\Users\admin\Desktop\data_analysic_agent\data\大学专业\school.csv
2025-06-06 21:11:21.928 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 21:11:21.930 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 21:11:21.948 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 21:11:21.949 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 21:11:21.949 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 21:11:21.949 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 21:11:21.950 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:11:21.950 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:11:21.951 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:11:21.951 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:11:21.952 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:11:21.953 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:11:21.954 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:11:21.955 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:11:21.956 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:11:21.960 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:11:21.961 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:11:21.962 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:11:21.964 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:11:21.965 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:11:21.966 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:11:21.967 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:11:21.967 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 21:11:21.967 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:11:21.973 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 21:11:22.019 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:11:22.019 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:11:22.049 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:11:22.049 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 21:11:22.081 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:11:22.099 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 21:11:22.100 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:11:22.101 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:11:22.102 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:11:22.103 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:11:22.104 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:11:22.105 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:11:22.106 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:11:22.107 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:11:22.109 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:11:22.116 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:11:22.117 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:11:22.119 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:11:22.120 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 21:11:22.121 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 21:11:22.122 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:11:22.123 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:11:22.124 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 21:11:22.125 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:11:22.129 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 21:11:22.199 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 21:11:22.199 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:11:22.244 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:11:22.244 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 21:11:22.276 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:11:22.278 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 21:11:22.279 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:11:22.279 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:11:22.280 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:11:22.280 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:11:22.281 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:11:22.281 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:11:22.281 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:11:22.282 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 21:11:22.283 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 21:11:22.291 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 21:11:22.292 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 21:11:22.294 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:11:22.296 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 21:11:22.297 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 21:11:22.298 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:11:22.298 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:11:22.299 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 21:11:22.300 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:11:22.304 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 21:11:22.372 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 21:11:22.372 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 21:11:22.431 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 21:11:22.461 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:11:22.461 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 21:11:22.492 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 21:11:22.494 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 21:11:22.495 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:11:22.495 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:11:22.496 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:11:22.496 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:11:22.497 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:11:22.497 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:11:22.498 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:11:22.498 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 21:11:22.499 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 21:11:22.503 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 21:11:22.504 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 21:11:22.508 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:11:22.509 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:11:22.513 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:11:22.513 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:11:22.515 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:11:22.516 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:11:22.517 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:11:22.518 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:11:22.518 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:11:22.519 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 21:11:22.520 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:11:22.524 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 21:11:22.590 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:11:22.591 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 21:11:22.647 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:11:22.648 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 21:11:22.710 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:11:22.724 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 21:11:22.724 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 21:11:42.008 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东", 
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南", 
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西", 
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 
        158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "/按省份划分的高校分布分析.png")

2025-06-06 21:11:42.684 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：No module named 'snapshot_selenium' 自动纠正中...
2025-06-06 21:22:51.404 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 21:22:51.443 | INFO     | utils.utils:read_data:29 - 读取数据：C:\Users\admin\Desktop\data_analysic_agent\data\大学专业\school.csv
2025-06-06 21:22:51.444 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 21:22:51.447 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 21:22:51.463 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 21:22:51.463 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 21:22:51.463 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 21:22:51.464 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 21:22:51.464 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:22:51.464 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:22:51.465 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:22:51.465 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:22:51.466 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:22:51.466 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:22:51.467 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:22:51.467 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:22:51.468 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:22:51.473 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:22:51.473 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:22:51.475 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:22:51.476 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:22:51.477 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:22:51.479 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:22:51.479 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:22:51.479 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 21:22:51.480 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:22:51.482 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 21:22:51.518 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:22:51.518 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:22:51.543 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:22:51.543 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 21:22:51.568 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:22:51.578 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 21:22:51.578 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:22:51.578 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:22:51.579 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:22:51.580 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:22:51.580 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:22:51.581 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:22:51.581 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:22:51.582 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:22:51.582 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:22:51.585 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:22:51.586 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:22:51.587 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:22:51.587 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 21:22:51.588 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 21:22:51.589 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:22:51.589 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:22:51.590 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 21:22:51.590 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:22:51.592 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 21:22:51.640 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 21:22:51.641 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:22:51.667 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:22:51.667 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 21:22:51.694 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:22:51.695 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 21:22:51.696 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:22:51.696 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:22:51.697 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:22:51.697 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:22:51.697 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:22:51.698 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:22:51.698 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:22:51.698 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 21:22:51.699 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 21:22:51.703 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 21:22:51.704 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 21:22:51.706 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:22:51.706 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 21:22:51.707 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 21:22:51.709 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:22:51.709 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:22:51.709 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 21:22:51.710 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:22:51.711 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 21:22:51.746 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 21:22:51.746 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 21:22:51.780 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 21:22:51.802 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:22:51.803 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 21:22:51.826 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 21:22:51.828 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 21:22:51.828 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:22:51.828 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:22:51.829 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:22:51.829 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:22:51.830 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:22:51.831 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:22:51.832 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:22:51.833 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 21:22:51.852 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 21:22:51.856 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 21:22:51.856 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 21:22:51.858 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:22:51.859 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:22:51.864 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:22:51.867 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:22:51.869 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:22:51.871 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:22:51.873 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:22:51.875 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:22:51.875 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:22:51.875 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 21:22:51.876 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:22:51.878 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 21:22:51.925 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:22:51.925 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 21:22:51.950 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:22:51.951 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 21:22:51.990 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:22:52.002 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 21:22:52.002 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 21:23:10.163 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "C:\Users\admin\Desktop\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")

2025-06-06 21:23:10.164 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：(unicode error) 'unicodeescape' codec can't decode bytes in position 2-3: truncated \UXXXXXXXX escape (<string>, line 27) 自动纠正中...
2025-06-06 21:27:26.407 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 21:27:26.417 | ERROR    | utils.utils:read_data:35 - 加载数据失败: [Errno 2] No such file or directory: 'C:\\Users\\admin\\Desktop\\data_analysic_agent\\data\\大学专业\\school.csv'
Traceback (most recent call last):
  File "E:\data_analysic_agent\utils\utils.py", line 9, in read_data
    df = pd.read_csv(data_path, encoding='utf-8')
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Users\\admin\\Desktop\\data_analysic_agent\\data\\大学专业\\school.csv'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\data_analysic_agent\utils\utils.py", line 11, in read_data
    df = pd.read_csv(data_path, encoding='gbk')
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "D:\anaconda\anaconda3\Lib\site-packages\pandas\io\common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Users\\admin\\Desktop\\data_analysic_agent\\data\\大学专业\\school.csv'

2025-06-06 21:27:59.370 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 21:27:59.405 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 21:27:59.405 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 21:27:59.407 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 21:27:59.421 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 21:27:59.422 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 21:27:59.422 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 21:27:59.423 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 21:27:59.423 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:27:59.424 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:27:59.424 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:27:59.425 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:27:59.426 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:27:59.426 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:27:59.427 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:27:59.428 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:27:59.429 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:27:59.434 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:27:59.434 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:27:59.436 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:27:59.437 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:27:59.438 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:27:59.439 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:27:59.439 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:27:59.439 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 21:27:59.440 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:27:59.442 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 21:27:59.472 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:27:59.473 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:27:59.493 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:27:59.493 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 21:27:59.516 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:27:59.526 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 21:27:59.526 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:27:59.526 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:27:59.527 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:27:59.527 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:27:59.528 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:27:59.528 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:27:59.528 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:27:59.529 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:27:59.529 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:27:59.532 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:27:59.533 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:27:59.534 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:27:59.534 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 21:27:59.535 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 21:27:59.536 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:27:59.536 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:27:59.536 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 21:27:59.537 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:27:59.538 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 21:27:59.566 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 21:27:59.566 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:27:59.583 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:27:59.584 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 21:27:59.610 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:27:59.613 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 21:27:59.614 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:27:59.614 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:27:59.615 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:27:59.616 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:27:59.616 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:27:59.617 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:27:59.617 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:27:59.617 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 21:27:59.619 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 21:27:59.623 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 21:27:59.624 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 21:27:59.625 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:27:59.626 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 21:27:59.627 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 21:27:59.628 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:27:59.629 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:27:59.629 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 21:27:59.629 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:27:59.631 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 21:27:59.665 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 21:27:59.665 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 21:27:59.701 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 21:27:59.722 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:27:59.722 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 21:27:59.749 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 21:27:59.751 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 21:27:59.751 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:27:59.751 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:27:59.752 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:27:59.752 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:27:59.753 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:27:59.753 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:27:59.754 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:27:59.755 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 21:27:59.757 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 21:27:59.761 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 21:27:59.762 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 21:27:59.763 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:27:59.764 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:27:59.767 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:27:59.768 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:27:59.769 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:27:59.770 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:27:59.771 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:27:59.772 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:27:59.773 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:27:59.773 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 21:27:59.775 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:27:59.779 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 21:27:59.821 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:27:59.821 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 21:27:59.847 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:27:59.847 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 21:27:59.887 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:27:59.900 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 21:27:59.901 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 21:28:16.339 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")

2025-06-06 21:28:22.744 | INFO     | workflow.img_create:run_task:43 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：E:\data_analysic_agent\save_chart\按省份划分的高校分布分析.png
2025-06-06 21:28:27.571 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png")

2025-06-06 21:28:32.396 | INFO     | workflow.img_create:run_task:43 - 分析维度：按办学类型划分的高校分布分析 生成图表成功，图表保存路径：E:\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png
2025-06-06 21:28:36.624 | INFO     | workflow.img_create:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别数量", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\高校层次与类别组合分析.png")

2025-06-06 21:28:45.593 | INFO     | workflow.img_create:run_task:43 - 分析维度：高校层次与类别组合分析 生成图表成功，图表保存路径：E:\data_analysic_agent\save_chart\高校层次与类别组合分析.png
2025-06-06 21:28:58.319 | INFO     | workflow.img_create:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东", 
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南", 
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西", 
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("城市数量", [
        1, 14, 12, 1, 9, 21, 1, 4, 16, 16, 11, 21, 14, 15, 13, 11, 11, 18, 11, 3, 14, 14, 2, 14, 9, 2, 9, 14, 1, 10, 3, 3, 13
    ])
    .add_yaxis("高校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160, 85, 163, 85, 56, 174, 108, 126, 158, 111, 21, 134, 129, 5, 52, 90, 6, 77, 110, 73, 104, 12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布分析"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-45)),
        yaxis_opts=opts.AxisOpts(name="数量"),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.png")

2025-06-06 21:29:05.747 | INFO     | workflow.img_create:run_task:43 - 分析维度：省份-城市维度下的高校分布分析 生成图表成功，图表保存路径：E:\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.png
2025-06-06 21:29:05.748 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 21:29:05.748 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 21:29:29.220 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 21:29:41.412 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 21:29:44.223 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 21:30:08.278 | INFO     | workflow.data_explore:parse_conclusion:115 - 正在解析数据分析结论....
2025-06-06 21:30:08.278 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 21:30:08.279 | INFO     | workflow.data_explore:run:85 - 正在生成数据分析报告.....
2025-06-06 21:42:31.708 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 21:42:31.757 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 21:42:31.758 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 21:42:31.760 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 21:42:31.779 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 21:42:31.780 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 21:42:31.781 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 21:42:31.781 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 21:42:31.781 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:42:31.781 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:42:31.783 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:42:31.783 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:42:31.784 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:42:31.784 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:42:31.784 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:42:31.785 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:42:31.786 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:42:31.793 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:42:31.794 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:42:31.796 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:42:31.798 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:42:31.799 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:42:31.800 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:42:31.800 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:42:31.801 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 21:42:31.801 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:42:31.804 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 21:42:31.848 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:42:31.850 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:42:31.880 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:42:31.880 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 21:42:31.913 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:42:31.928 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 21:42:31.928 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:42:31.928 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:42:31.929 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:42:31.930 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:42:31.930 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:42:31.931 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:42:31.931 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:42:31.932 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:42:31.933 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:42:31.938 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:42:31.939 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:42:31.942 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:42:31.944 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 21:42:31.947 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 21:42:31.950 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:42:31.950 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:42:31.951 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 21:42:31.952 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:42:31.955 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 21:42:32.002 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 21:42:32.003 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:42:32.032 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:42:32.033 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 21:42:32.067 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:42:32.071 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 21:42:32.071 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:42:32.071 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:42:32.072 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:42:32.073 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:42:32.073 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:42:32.074 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:42:32.074 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:42:32.075 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 21:42:32.076 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 21:42:32.080 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 21:42:32.081 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 21:42:32.083 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:42:32.084 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 21:42:32.085 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 21:42:32.087 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:42:32.087 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:42:32.088 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 21:42:32.088 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:42:32.090 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 21:42:32.136 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 21:42:32.137 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 21:42:32.194 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 21:42:32.234 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:42:32.235 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 21:42:32.277 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 21:42:32.279 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 21:42:32.280 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:42:32.281 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:42:32.281 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:42:32.282 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:42:32.283 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:42:32.283 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:42:32.284 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:42:32.286 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 21:42:32.288 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 21:42:32.294 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 21:42:32.294 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 21:42:32.296 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:42:32.298 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:42:32.304 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:42:32.306 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:42:32.308 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:42:32.309 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:42:32.310 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:42:32.312 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:42:32.312 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:42:32.312 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 21:42:32.314 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:42:32.317 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 21:42:32.394 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:42:32.394 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 21:42:32.446 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:42:32.447 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 21:42:32.507 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:42:32.524 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 21:42:32.525 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 21:42:32.525 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 21:42:32.526 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 21:42:32.526 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 21:42:32.526 | INFO     | workflow.data_explore:run:86 - 正在生成数据分析报告.....
2025-06-06 21:44:50.667 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 21:44:50.737 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 21:44:50.738 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 21:44:50.744 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 21:44:50.771 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 21:44:50.772 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 21:44:50.773 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 21:44:50.774 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 21:44:50.776 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:44:50.776 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:44:50.778 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:44:50.779 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:44:50.780 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:44:50.781 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:44:50.782 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:44:50.783 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:44:50.785 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:44:50.792 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:44:50.792 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:44:50.795 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:44:50.799 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:44:50.800 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:44:50.802 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:44:50.803 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:44:50.803 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 21:44:50.804 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:44:50.808 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 21:44:50.870 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:44:50.871 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:44:50.921 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:44:50.921 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 21:44:50.972 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:44:50.996 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 21:44:50.997 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:44:50.997 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:44:50.998 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:44:50.998 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:44:51.000 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:44:51.001 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:44:51.001 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:44:51.002 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:44:51.003 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:44:51.009 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:44:51.010 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:44:51.011 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:44:51.012 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 21:44:51.013 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 21:44:51.015 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:44:51.016 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:44:51.016 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 21:44:51.017 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:44:51.020 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 21:44:51.077 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 21:44:51.078 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:44:51.116 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:44:51.118 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 21:44:51.167 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:44:51.171 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 21:44:51.172 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:44:51.172 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:44:51.173 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:44:51.174 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:44:51.174 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:44:51.175 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:44:51.175 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:44:51.176 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 21:44:51.177 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 21:44:51.183 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 21:44:51.184 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 21:44:51.187 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:44:51.188 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 21:44:51.190 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 21:44:51.191 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:44:51.192 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:44:51.192 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 21:44:51.193 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:44:51.195 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 21:44:51.252 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 21:44:51.252 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 21:44:51.318 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 21:44:51.351 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:44:51.351 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 21:44:51.393 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 21:44:51.396 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 21:44:51.397 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:44:51.397 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:44:51.398 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:44:51.399 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:44:51.401 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:44:51.402 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:44:51.402 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:44:51.403 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 21:44:51.405 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 21:44:51.410 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 21:44:51.410 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 21:44:51.412 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:44:51.414 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:44:51.421 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:44:51.422 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:44:51.424 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:44:51.425 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:44:51.427 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:44:51.428 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:44:51.428 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:44:51.429 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 21:44:51.430 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:44:51.432 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 21:44:51.517 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:44:51.518 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 21:44:51.562 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:44:51.563 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 21:44:51.634 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:44:51.654 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 21:44:51.654 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 21:44:51.655 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 21:44:51.656 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 21:44:51.657 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 21:44:51.657 | INFO     | workflow.data_explore:run:86 - 正在生成数据分析报告.....
2025-06-06 21:44:51.658 | INFO     | workflow.generate_report:run:36 - 正在总结 markdown 数据.....
2025-06-06 21:45:11.093 | INFO     | workflow.generate_report:run:47 - 正在保存 markdown.....
2025-06-06 21:45:11.094 | INFO     | workflow.generate_report:run:49 - ✅ 数据分析报告 markdown 生成完成.....
2025-06-06 21:45:11.095 | INFO     | workflow.generate_report:run:52 - 正在 markdown to pdf.....
2025-06-06 21:56:13.790 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 21:56:13.843 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 21:56:13.843 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 21:56:13.846 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 21:56:13.866 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 21:56:13.867 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 21:56:13.868 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 21:56:13.868 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 21:56:13.868 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:56:13.869 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:56:13.870 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:56:13.870 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:56:13.871 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:56:13.871 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:56:13.872 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:56:13.872 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:56:13.874 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:56:13.878 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:56:13.880 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:56:13.882 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:56:13.884 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:56:13.886 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:56:13.887 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:56:13.887 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:56:13.888 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 21:56:13.888 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:56:13.891 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 21:56:13.937 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:56:13.938 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:56:13.971 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:56:13.971 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 21:56:14.010 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:56:14.025 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 21:56:14.026 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:56:14.026 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:56:14.028 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:56:14.028 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:56:14.029 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:56:14.030 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:56:14.030 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:56:14.031 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:56:14.032 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:56:14.036 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:56:14.037 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:56:14.038 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:56:14.041 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 21:56:14.043 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 21:56:14.045 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:56:14.045 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:56:14.045 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 21:56:14.046 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:56:14.048 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 21:56:14.099 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 21:56:14.100 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 21:56:14.129 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:56:14.131 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 21:56:14.166 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:56:14.170 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 21:56:14.170 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:56:14.171 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:56:14.172 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:56:14.172 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:56:14.173 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:56:14.173 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:56:14.174 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:56:14.174 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 21:56:14.176 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 21:56:14.180 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 21:56:14.181 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 21:56:14.184 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:56:14.187 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 21:56:14.190 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 21:56:14.192 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:56:14.193 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:56:14.193 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 21:56:14.194 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:56:14.196 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 21:56:14.280 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 21:56:14.281 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 21:56:14.387 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 21:56:14.445 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:56:14.446 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 21:56:14.502 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 21:56:14.505 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 21:56:14.505 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 21:56:14.506 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 21:56:14.509 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 21:56:14.510 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 21:56:14.512 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 21:56:14.513 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 21:56:14.513 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 21:56:14.514 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 21:56:14.516 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 21:56:14.522 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 21:56:14.523 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 21:56:14.527 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 21:56:14.529 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 21:56:14.537 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 21:56:14.537 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 21:56:14.540 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 21:56:14.544 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 21:56:14.546 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 21:56:14.549 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 21:56:14.550 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 21:56:14.551 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 21:56:14.551 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 21:56:14.554 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 21:56:14.646 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 21:56:14.647 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 21:56:14.695 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 21:56:14.696 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 21:56:14.786 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 21:56:14.816 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 21:56:14.817 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 21:56:14.818 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 21:56:14.818 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 21:56:14.818 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 21:56:14.819 | INFO     | workflow.data_explore:run:86 - 正在生成数据分析报告.....
2025-06-06 21:56:14.820 | INFO     | workflow.generate_report:run:36 - 正在总结 markdown 数据.....
2025-06-06 21:56:35.486 | INFO     | workflow.generate_report:run:47 - 正在保存 markdown.....
2025-06-06 21:56:35.487 | INFO     | workflow.generate_report:run:49 - ✅ 数据分析报告 markdown 生成完成.....
2025-06-06 21:56:35.487 | INFO     | workflow.generate_report:run:52 - 正在 markdown to pdf.....
2025-06-06 22:03:20.725 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 22:03:20.774 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 22:03:20.775 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 22:03:20.778 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 22:03:20.797 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 22:03:20.798 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 22:03:20.799 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 22:03:20.799 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 22:03:20.800 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:03:20.800 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:03:20.801 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:03:20.801 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:03:20.802 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:03:20.802 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:03:20.803 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:03:20.804 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:03:20.805 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:03:20.809 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:03:20.810 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:03:20.812 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:03:20.814 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:03:20.815 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:03:20.816 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:03:20.816 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:03:20.817 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 22:03:20.817 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:03:20.820 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 22:03:20.865 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:03:20.866 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:03:20.895 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:03:20.896 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 22:03:20.928 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:03:20.946 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 22:03:20.946 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:03:20.947 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:03:20.948 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:03:20.948 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:03:20.949 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:03:20.949 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:03:20.949 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:03:20.950 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:03:20.951 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:03:20.955 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:03:20.956 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:03:20.958 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:03:20.959 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 22:03:20.960 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 22:03:20.961 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:03:20.962 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:03:20.962 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 22:03:20.963 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:03:20.964 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 22:03:21.009 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 22:03:21.010 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:03:21.039 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:03:21.040 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 22:03:21.072 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:03:21.074 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 22:03:21.075 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:03:21.075 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:03:21.076 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:03:21.076 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:03:21.077 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:03:21.077 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:03:21.078 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:03:21.078 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 22:03:21.079 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 22:03:21.083 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 22:03:21.084 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 22:03:21.087 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:03:21.088 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 22:03:21.089 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 22:03:21.090 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:03:21.091 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:03:21.091 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 22:03:21.092 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:03:21.093 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 22:03:21.136 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 22:03:21.137 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 22:03:21.183 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 22:03:21.214 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:03:21.215 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 22:03:21.251 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 22:03:21.254 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 22:03:21.254 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:03:21.255 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:03:21.256 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:03:21.256 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:03:21.257 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:03:21.258 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:03:21.258 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:03:21.259 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 22:03:21.260 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 22:03:21.266 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 22:03:21.267 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 22:03:21.269 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:03:21.270 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:03:21.276 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:03:21.276 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:03:21.279 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:03:21.281 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:03:21.282 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:03:21.284 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:03:21.284 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:03:21.285 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 22:03:21.286 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:03:21.288 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 22:03:21.354 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:03:21.355 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 22:03:21.396 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:03:21.397 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 22:03:21.450 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:03:21.469 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 22:03:21.469 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 22:03:21.470 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 22:03:21.470 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 22:03:21.471 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 22:03:21.471 | INFO     | workflow.data_explore:run:86 - 正在生成数据分析报告.....
2025-06-06 22:03:21.472 | INFO     | workflow.generate_report:run:36 - 正在总结 markdown 数据.....
2025-06-06 22:03:53.714 | INFO     | workflow.generate_report:run:47 - 正在保存 markdown.....
2025-06-06 22:03:53.715 | INFO     | workflow.generate_report:run:49 - ✅ 数据分析报告 markdown 生成完成.....
2025-06-06 22:03:53.716 | INFO     | workflow.generate_report:run:52 - 正在 markdown to pdf.....
2025-06-06 22:13:51.931 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 22:13:52.024 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 22:13:52.025 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 22:13:52.029 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 22:13:52.069 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 22:13:52.069 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 22:13:52.070 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 22:13:52.070 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 22:13:52.071 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:13:52.072 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:13:52.074 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:13:52.074 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:13:52.076 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:13:52.077 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:13:52.078 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:13:52.080 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:13:52.082 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:13:52.091 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:13:52.092 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:13:52.096 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:13:52.100 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:13:52.102 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:13:52.104 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:13:52.105 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:13:52.105 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 22:13:52.107 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:13:52.112 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 22:13:52.202 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:13:52.204 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:13:52.271 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:13:52.272 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 22:13:52.339 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:13:52.364 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 22:13:52.365 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:13:52.366 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:13:52.367 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:13:52.368 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:13:52.370 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:13:52.371 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:13:52.371 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:13:52.372 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:13:52.374 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:13:52.383 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:13:52.384 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:13:52.386 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:13:52.388 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 22:13:52.390 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 22:13:52.392 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:13:52.394 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:13:52.395 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 22:13:52.397 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:13:52.401 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 22:13:52.534 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 22:13:52.536 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:13:52.617 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:13:52.619 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 22:13:52.709 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:13:52.716 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 22:13:52.717 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:13:52.718 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:13:52.721 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:13:52.723 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:13:52.725 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:13:52.726 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:13:52.728 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:13:52.730 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 22:13:52.733 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 22:13:52.746 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 22:13:52.748 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 22:13:52.755 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:13:52.758 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 22:13:52.761 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 22:13:52.766 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:13:52.767 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:13:52.768 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 22:13:52.771 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:13:52.777 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 22:13:52.916 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 22:13:52.917 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 22:13:53.062 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 22:13:53.155 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:13:53.157 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 22:13:53.263 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 22:13:53.269 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 22:13:53.271 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:13:53.272 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:13:53.274 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:13:53.276 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:13:53.279 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:13:53.281 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:13:53.282 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:13:53.284 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 22:13:53.288 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 22:13:53.302 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 22:13:53.305 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 22:13:53.314 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:13:53.318 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:13:53.333 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:13:53.335 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:13:53.341 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:13:53.346 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:13:53.349 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:13:53.355 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:13:53.357 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:13:53.358 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 22:13:53.362 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:13:53.370 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 22:13:53.552 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:13:53.554 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 22:13:53.659 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:13:53.661 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 22:13:53.806 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:13:53.853 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 22:13:53.854 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 22:13:53.855 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 22:13:53.856 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 22:13:53.856 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 22:13:53.857 | INFO     | workflow.data_explore:run:86 - 正在生成数据分析报告.....
2025-06-06 22:13:53.859 | INFO     | workflow.generate_report:run:36 - 正在总结 markdown 数据.....
2025-06-06 22:14:17.263 | INFO     | workflow.generate_report:run:47 - 正在保存 markdown.....
2025-06-06 22:14:17.270 | INFO     | workflow.generate_report:run:49 - ✅ 数据分析报告 markdown 生成完成.....
2025-06-06 22:14:17.272 | INFO     | workflow.generate_report:run:52 - 正在 markdown to pdf.....
2025-06-06 22:15:28.832 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 22:15:28.939 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 22:15:28.940 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 22:15:28.946 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 22:15:28.985 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 22:15:28.986 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 22:15:28.986 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 22:15:28.987 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 22:15:28.988 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:15:28.989 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:15:28.991 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:15:28.993 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:15:28.995 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:15:28.996 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:15:28.997 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:15:28.998 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:15:29.000 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:15:29.011 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:15:29.012 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:15:29.016 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:15:29.020 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:15:29.022 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:15:29.026 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:15:29.027 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:15:29.028 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 22:15:29.029 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:15:29.034 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 22:15:29.151 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:15:29.152 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:15:29.256 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:15:29.257 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 22:15:29.324 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:15:29.353 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 22:15:29.354 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:15:29.355 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:15:29.357 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:15:29.359 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:15:29.360 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:15:29.361 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:15:29.361 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:15:29.362 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:15:29.365 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:15:29.377 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:15:29.380 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:15:29.384 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:15:29.388 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 22:15:29.391 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 22:15:29.396 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:15:29.397 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:15:29.398 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 22:15:29.402 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:15:29.410 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 22:15:29.547 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 22:15:29.548 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:15:29.640 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:15:29.642 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 22:15:29.736 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:15:29.744 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 22:15:29.746 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:15:29.747 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:15:29.749 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:15:29.750 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:15:29.752 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:15:29.753 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:15:29.754 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:15:29.756 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 22:15:29.760 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 22:15:29.775 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 22:15:29.783 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 22:15:29.792 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:15:29.794 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 22:15:29.796 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 22:15:29.800 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:15:29.801 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:15:29.801 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 22:15:29.803 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:15:29.813 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 22:15:29.982 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 22:15:29.983 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 22:15:30.144 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 22:15:30.250 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:15:30.253 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 22:15:30.364 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 22:15:30.370 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 22:15:30.372 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:15:30.373 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:15:30.376 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:15:30.378 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:15:30.380 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:15:30.381 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:15:30.383 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:15:30.385 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 22:15:30.388 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 22:15:30.401 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 22:15:30.405 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 22:15:30.412 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:15:30.417 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:15:30.432 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:15:30.435 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:15:30.440 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:15:30.445 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:15:30.450 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:15:30.455 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:15:30.457 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:15:30.458 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 22:15:30.462 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:15:30.470 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 22:15:30.656 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:15:30.657 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 22:15:30.764 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:15:30.765 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 22:15:30.913 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:15:30.965 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 22:15:30.967 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 22:15:30.968 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 22:15:30.970 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 22:15:30.972 | INFO     | workflow.data_explore:run:79 - ✅ 每个维度分析结论生成完成.....
2025-06-06 22:15:30.973 | INFO     | workflow.data_explore:run:86 - 正在生成数据分析报告.....
2025-06-06 22:15:30.976 | INFO     | workflow.generate_report:run:36 - 正在总结 markdown 数据.....
2025-06-06 22:16:08.584 | INFO     | workflow.generate_report:run:47 - 正在保存 markdown.....
2025-06-06 22:16:08.587 | INFO     | workflow.generate_report:run:49 - ✅ 数据分析报告 markdown 生成完成.....
2025-06-06 22:16:08.587 | INFO     | workflow.generate_report:run:52 - 正在 markdown to pdf.....
2025-06-06 22:38:29.268 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 22:38:29.369 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 22:38:29.370 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 22:38:29.375 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 22:38:29.414 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 22:38:29.415 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 22:38:29.416 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 22:38:29.417 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 22:38:29.418 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:38:29.418 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:38:29.420 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:38:29.421 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:38:29.422 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:38:29.424 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:38:29.425 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:38:29.426 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:38:29.428 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:38:29.437 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:38:29.438 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:38:29.442 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:38:29.446 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:38:29.448 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:38:29.451 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:38:29.452 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:38:29.452 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 22:38:29.453 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:38:29.460 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 22:38:29.595 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:38:29.596 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:38:29.695 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:38:29.696 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 22:38:29.778 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:38:29.806 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 22:38:29.808 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:38:29.810 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:38:29.812 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:38:29.813 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:38:29.814 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:38:29.815 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:38:29.815 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:38:29.818 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:38:29.821 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:38:29.829 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:38:29.830 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:38:29.832 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:38:29.836 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 22:38:29.839 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 22:38:29.844 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:38:29.845 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:38:29.846 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 22:38:29.848 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:38:29.855 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 22:38:29.989 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 22:38:29.990 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:38:30.074 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:38:30.076 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 22:38:30.180 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:38:30.188 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 22:38:30.189 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:38:30.190 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:38:30.193 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:38:30.194 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:38:30.197 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:38:30.199 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:38:30.200 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:38:30.202 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 22:38:30.207 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 22:38:30.222 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 22:38:30.224 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 22:38:30.231 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:38:30.235 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 22:38:30.239 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 22:38:30.244 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:38:30.245 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:38:30.246 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 22:38:30.248 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:38:30.254 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 22:38:30.409 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 22:38:30.410 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 22:38:30.562 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 22:38:30.659 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:38:30.660 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 22:38:30.764 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 22:38:30.769 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 22:38:30.771 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:38:30.772 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:38:30.774 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:38:30.777 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:38:30.780 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:38:30.781 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:38:30.782 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:38:30.784 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 22:38:30.788 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 22:38:30.802 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 22:38:30.803 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 22:38:30.810 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:38:30.814 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:38:30.828 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:38:30.830 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:38:30.836 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:38:30.841 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:38:30.845 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:38:30.850 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:38:30.851 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:38:30.852 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 22:38:30.856 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:38:30.863 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 22:38:31.067 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:38:31.070 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 22:38:31.184 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:38:31.185 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 22:38:31.352 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:38:31.409 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 22:38:31.412 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 22:38:57.170 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")

2025-06-06 22:39:17.024 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：Message: javascript error: echarts is not defined
  (Session info: chrome=137.0.7151.57)
Stacktrace:
	GetHandleVerifier [0x0x7ff663b4fea5+79173]
	GetHandleVerifier [0x0x7ff663b4ff00+79264]
	(No symbol) [0x0x7ff663909e5a]
	(No symbol) [0x0x7ff66391184d]
	(No symbol) [0x0x7ff663914be1]
	(No symbol) [0x0x7ff6639b22b4]
	(No symbol) [0x0x7ff66398896a]
	(No symbol) [0x0x7ff6639b100d]
	(No symbol) [0x0x7ff663988743]
	(No symbol) [0x0x7ff6639514c1]
	(No symbol) [0x0x7ff663952253]
	GetHandleVerifier [0x0x7ff663e1a2dd+3004797]
	GetHandleVerifier [0x0x7ff663e1472d+2981325]
	GetHandleVerifier [0x0x7ff663e33380+3107360]
	GetHandleVerifier [0x0x7ff663b6aa2e+188622]
	GetHandleVerifier [0x0x7ff663b722bf+219487]
	GetHandleVerifier [0x0x7ff663b58df4+115860]
	GetHandleVerifier [0x0x7ff663b58fa9+116297]
	GetHandleVerifier [0x0x7ff663b3f558+11256]
	BaseThreadInitThunk [0x0x7ffffc29e8d7+23]
	RtlUserThreadStart [0x0x7ffffd09bf2c+44]
 自动纠正中...
2025-06-06 22:39:41.330 | WARNING  | workflow.img_create:run_task:49 - 分析维度：按省份划分的高校分布分析 **纠正后**代码：

from pyecharts.charts import Bar
from pyecharts import options as opts
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot

# 创建柱状图
chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)

# 渲染图表为 HTML 并指定本地 ECharts JS 文件
html_file = "E:/data_analysic_agent/save_chart/高校分布.html"
output_image = "E:/data_analysic_agent/save_chart/按省份划分的高校分布分析.png"

# 确保目录存在
import os
os.makedirs(os.path.dirname(output_image), exist_ok=True)

# 渲染 HTML 文件，并指定本地 echarts.js
chart.render(html_file, config={'theme': 'white', 'jshost': ''})

# 截图保存为图片
make_snapshot(snapshot, html_file, output_image)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")

2025-06-06 22:40:01.795 | ERROR    | workflow.img_create:run_task:46 - 分析维度：按省份划分的高校分布分析 执行代码出错：Message: javascript error: echarts is not defined
  (Session info: chrome=137.0.7151.57)
Stacktrace:
	GetHandleVerifier [0x0x7ff663b4fea5+79173]
	GetHandleVerifier [0x0x7ff663b4ff00+79264]
	(No symbol) [0x0x7ff663909e5a]
	(No symbol) [0x0x7ff66391184d]
	(No symbol) [0x0x7ff663914be1]
	(No symbol) [0x0x7ff6639b22b4]
	(No symbol) [0x0x7ff66398896a]
	(No symbol) [0x0x7ff6639b100d]
	(No symbol) [0x0x7ff663988743]
	(No symbol) [0x0x7ff6639514c1]
	(No symbol) [0x0x7ff663952253]
	GetHandleVerifier [0x0x7ff663e1a2dd+3004797]
	GetHandleVerifier [0x0x7ff663e1472d+2981325]
	GetHandleVerifier [0x0x7ff663e33380+3107360]
	GetHandleVerifier [0x0x7ff663b6aa2e+188622]
	GetHandleVerifier [0x0x7ff663b722bf+219487]
	GetHandleVerifier [0x0x7ff663b58df4+115860]
	GetHandleVerifier [0x0x7ff663b58fa9+116297]
	GetHandleVerifier [0x0x7ff663b3f558+11256]
	BaseThreadInitThunk [0x0x7ffffc29e8d7+23]
	RtlUserThreadStart [0x0x7ffffd09bf2c+44]
 自动纠正中...
2025-06-06 22:40:55.182 | INFO     | __main__:<module>:16 - 正在进行了数据探索....
2025-06-06 22:40:55.268 | INFO     | utils.utils:read_data:29 - 读取数据：E:\data_analysic_agent\data\大学专业\school.csv
2025-06-06 22:40:55.269 | INFO     | utils.utils:read_data:30 - 列名: ['学校', '省份', '城市', '地址', '水平层次', '办学类别', '办学类型', '985', '211', '双一流', '归属', '开设专业链接']
2025-06-06 22:40:55.274 | INFO     | utils.utils:data_random_sample:46 - 成功读取随机抽样数据，显示前50行
2025-06-06 22:40:55.310 | INFO     | workflow.data_explore:run:24 - 【开始运行】✅ 数据读取完成；读取到2856条有效数据
2025-06-06 22:40:55.311 | INFO     | workflow.data_explore:run:59 - 数据分析维度生成完成，共 4 个维度
2025-06-06 22:40:55.311 | INFO     | workflow.data_explore:run:62 - 正在分析维度.....
2025-06-06 22:40:55.312 | INFO     | workflow.data_explore:run:65 - 正在分析维度 1/4: 按省份划分的高校分布分析
2025-06-06 22:40:55.312 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:40:55.313 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:40:55.315 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_distribution_by_province', 'analysis_name': '按省份划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['学校'], 'name': '省份分布统计', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:40:55.315 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:40:55.316 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:40:55.317 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:40:55.317 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:40:55.319 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:40:55.322 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:40:55.331 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:40:55.332 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:40:55.336 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:40:55.341 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:40:55.343 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:40:55.346 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:40:55.346 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:40:55.347 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份分布统计
2025-06-06 22:40:55.348 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:40:55.354 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份            学校
0  河北  河北轨道运输职业技术学院
1  福建          厦门大学
2  四川          四川大学
3  湖北          武汉大学
4  北京          北京大学
2025-06-06 22:40:55.439 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:40:55.440 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:40:55.509 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:40:55.510 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份   学校
0    上海   65
1    云南   82
2   内蒙古   56
3    北京  102
4    吉林   70
5    四川  137
6    天津   62
7    宁夏   20
8    安徽  128
9    山东  160
10   山西   85
11   广东  163
12   广西   85
13   新疆   56
14   江苏  174
15   江西  108
16   河北  126
17   河南  158
18   浙江  111
19   海南   21
20   湖北  134
21   湖南  129
22   澳门    5
23   甘肃   52
24   福建   90
25   西藏    6
26   贵州   77
27   辽宁  110
28   重庆   73
29   陕西  104
30   青海   12
31   香港   14
32  黑龙江   81
2025-06-06 22:40:55.576 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:40:55.604 | INFO     | workflow.data_explore:run:65 - 正在分析维度 2/4: 按办学类型划分的高校分布分析
2025-06-06 22:40:55.605 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:40:55.605 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:40:55.607 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_type_distribution', 'analysis_name': '按办学类型划分的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'学校': 'count'}, 'dimension_column': '办学类型', 'metrics_columns': ['学校'], 'name': '办学类型分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:40:55.607 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:40:55.608 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:40:55.609 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:40:55.610 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:40:55.611 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:40:55.613 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:40:55.621 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:40:55.622 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:40:55.624 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:40:55.626 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 办学类型列的唯一值: ['公办' '民办' '中外合作办学']
2025-06-06 22:40:55.628 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 办学类型列的缺失值数量: 0
2025-06-06 22:40:55.632 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:40:55.632 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:40:55.633 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 办学类型分布
2025-06-06 22:40:55.634 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:40:55.637 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -   办学类型            学校
0   公办  河北轨道运输职业技术学院
1   公办          厦门大学
2   公办          四川大学
3   公办          武汉大学
4   公办          北京大学
2025-06-06 22:40:55.736 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['办学类型']
2025-06-06 22:40:55.738 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'学校': 'count'}
2025-06-06 22:40:55.826 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:40:55.828 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      办学类型    学校
0  中外合作办学    20
1      公办  2072
2      民办   764
2025-06-06 22:40:55.925 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:40:55.934 | INFO     | workflow.data_explore:run:65 - 正在分析维度 3/4: 高校层次与类别组合分析
2025-06-06 22:40:55.935 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:40:55.936 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:40:55.939 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'school_level_and_category', 'analysis_name': '高校层次与类别组合分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'办学类别': 'value_counts'}, 'dimension_column': '水平层次', 'metrics_columns': ['办学类别'], 'name': '水平层次与办学类别组合', 'sort_by': {'ascending': False, 'column': '办学类别_value_counts'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:40:55.941 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:40:55.944 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:40:55.945 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:40:55.946 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:40:55.949 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 办学类别列的数据类型: object
2025-06-06 22:40:55.952 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 办学类别列的缺失值数量: 30
2025-06-06 22:40:55.967 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 办学类别列的前5个值:
 0    理工类
1    综合类
2    综合类
3    综合类
4    综合类
Name: 办学类别, dtype: object
2025-06-06 22:40:55.969 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换办学类别列为数值类型时出错: could not convert string to float: '理工类'
2025-06-06 22:40:55.977 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:40:55.981 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 水平层次列的唯一值: ['专科（高职）' '普通本科']
2025-06-06 22:40:55.985 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 水平层次列的缺失值数量: 0
2025-06-06 22:40:55.991 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:40:55.992 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:40:55.993 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 水平层次与办学类别组合
2025-06-06 22:40:55.995 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:40:56.001 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -      水平层次 办学类别
0  专科（高职）  理工类
1    普通本科  综合类
2    普通本科  综合类
3    普通本科  综合类
4    普通本科  综合类
2025-06-06 22:40:56.146 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['水平层次']
2025-06-06 22:40:56.147 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'办学类别': 'value_counts'}
2025-06-06 22:40:56.291 | WARNING  | workflow.analysis_dimension:analyze_dimension:495 - pivot_table 聚合函数失败，尝试 value_counts 替换为 counts 聚合函数
2025-06-06 22:40:56.385 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:40:56.386 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      水平层次  办学类别
0  专科（高职）  1499
1    普通本科  1357
2025-06-06 22:40:56.495 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '办学类别_value_counts' 不存在，跳过排序
2025-06-06 22:40:56.501 | INFO     | workflow.data_explore:run:65 - 正在分析维度 4/4: 省份-城市维度下的高校分布分析
2025-06-06 22:40:56.502 | INFO     | workflow.analysis_dimension:run_analysis:704 - 开始数据预处理......
2025-06-06 22:40:56.504 | INFO     | workflow.analysis_dimension:preprocess_data:308 - 解析分析维度 json......
2025-06-06 22:40:56.507 | INFO     | workflow.analysis_dimension:_parse_config:157 - 解析维度配置：
{'analysis_id': 'province_city_school_distribution', 'analysis_name': '省份-城市维度下的高校分布分析', 'correlation_analysis': {'columns': [], 'enabled': False}, 'dimensions': [{'aggregation_methods': {'城市': 'nunique', '学校': 'count'}, 'dimension_column': '省份', 'metrics_columns': ['城市', '学校'], 'name': '省份与城市组合分布', 'sort_by': {'ascending': False, 'column': '学校_count'}}], 'preprocessing': {'date_columns': [], 'date_format': '', 'drop_na': False}, 'time_series_analysis': {'aggregation': '', 'enabled': False, 'frequency': '', 'metrics': [], 'time_column': ''}}
2025-06-06 22:40:56.509 | INFO     | workflow.analysis_dimension:_auto_match_columns:196 - 开始智能匹配列名，更新配置 json...
2025-06-06 22:40:56.511 | INFO     | workflow.analysis_dimension:_parse_config:163 - 开始转换预处理，维度，时间序列，相关性分析配置
2025-06-06 22:40:56.512 | INFO     | workflow.analysis_dimension:preprocess_data:318 - 处理日期列，转换为 pandas datetime格式......
2025-06-06 22:40:56.514 | INFO     | workflow.analysis_dimension:preprocess_data:342 - 检查并转换数值列，把是数值的指标列转换为数值类型......
2025-06-06 22:40:56.516 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 城市列的数据类型: object
2025-06-06 22:40:56.520 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 城市列的缺失值数量: 0
2025-06-06 22:40:56.535 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 城市列的前5个值:
 0    石家庄市
1     厦门市
2     成都市
3     武汉市
4     北京市
Name: 城市, dtype: object
2025-06-06 22:40:56.538 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换城市列为数值类型时出错: could not convert string to float: '石家庄市'
2025-06-06 22:40:56.545 | INFO     | workflow.analysis_dimension:preprocess_data:347 - 学校列的数据类型: object
2025-06-06 22:40:56.549 | INFO     | workflow.analysis_dimension:preprocess_data:348 - 学校列的缺失值数量: 0
2025-06-06 22:40:56.564 | INFO     | workflow.analysis_dimension:preprocess_data:349 - 学校列的前5个值:
 0    河北轨道运输职业技术学院
1            厦门大学
2            四川大学
3            武汉大学
4            北京大学
Name: 学校, dtype: object
2025-06-06 22:40:56.568 | WARNING  | workflow.analysis_dimension:preprocess_data:359 - 警告: 转换学校列为数值类型时出错: could not convert string to float: '河北轨道运输职业技术学院'
2025-06-06 22:40:56.572 | INFO     | workflow.analysis_dimension:preprocess_data:365 - 检查维度列的唯一值......
2025-06-06 22:40:56.577 | INFO     | workflow.analysis_dimension:preprocess_data:370 - 省份列的唯一值: ['河北' '福建' '四川' '湖北' '北京' '广东' '湖南' '江苏' '重庆' '浙江' '山东' '天津' '上海' '河南'
 '吉林' '陕西' '辽宁' '海南' '江西' '黑龙江' '甘肃' '云南' '安徽' '山西' '广西' '贵州' '新疆' '内蒙古'
 '宁夏' '青海' '西藏' '香港' '澳门']
2025-06-06 22:40:56.581 | INFO     | workflow.analysis_dimension:preprocess_data:371 - 省份列的缺失值数量: 0
2025-06-06 22:40:56.586 | INFO     | workflow.analysis_dimension:preprocess_data:376 - 数据预处理完成
2025-06-06 22:40:56.588 | INFO     | workflow.analysis_dimension:run_analysis:708 - ✅ 数据预处理完成，开始数据维度分析......
2025-06-06 22:40:56.589 | INFO     | workflow.analysis_dimension:analyze_dimension:421 - 开始分析维度: 省份与城市组合分布
2025-06-06 22:40:56.592 | INFO     | workflow.analysis_dimension:analyze_dimension:453 - 分组前数据样例:
2025-06-06 22:40:56.599 | INFO     | workflow.analysis_dimension:analyze_dimension:454 -    省份    城市            学校
0  河北  石家庄市  河北轨道运输职业技术学院
1  福建   厦门市          厦门大学
2  四川   成都市          四川大学
3  湖北   武汉市          武汉大学
4  北京   北京市          北京大学
2025-06-06 22:40:56.802 | INFO     | workflow.analysis_dimension:analyze_dimension:482 - 分组列: ['省份']
2025-06-06 22:40:56.804 | INFO     | workflow.analysis_dimension:analyze_dimension:483 - 聚合方法: {'城市': 'nunique', '学校': 'count'}
2025-06-06 22:40:56.917 | INFO     | workflow.analysis_dimension:analyze_dimension:511 - 分组聚合结果:
2025-06-06 22:40:56.918 | INFO     | workflow.analysis_dimension:analyze_dimension:512 -      省份  城市   学校
0    上海   1   65
1    云南  14   82
2   内蒙古  12   56
3    北京   1  102
4    吉林   9   70
5    四川  21  137
6    天津   1   62
7    宁夏   4   20
8    安徽  16  128
9    山东  16  160
10   山西  11   85
11   广东  21  163
12   广西  14   85
13   新疆  15   56
14   江苏  13  174
15   江西  11  108
16   河北  11  126
17   河南  18  158
18   浙江  11  111
19   海南   3   21
20   湖北  14  134
21   湖南  14  129
22   澳门   2    5
23   甘肃  14   52
24   福建   9   90
25   西藏   2    6
26   贵州   9   77
27   辽宁  14  110
28   重庆   1   73
29   陕西  10  104
30   青海   3   12
31   香港   3   14
32  黑龙江  13   81
2025-06-06 22:40:57.087 | WARNING  | workflow.analysis_dimension:analyze_dimension:566 - 警告: 排序列 '学校_count' 不存在，跳过排序
2025-06-06 22:40:57.144 | INFO     | workflow.data_explore:run:68 - ✅ 数据清洗完成.....
2025-06-06 22:40:57.145 | INFO     | workflow.data_explore:run:71 - 正在绘制图表....
2025-06-06 22:41:22.696 | INFO     | workflow.img_create:run_task:37 - 分析维度：按省份划分的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按省份划分的高校分布分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        yaxis_opts=opts.AxisOpts(name="学校数量")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\按省份划分的高校分布分析.png")

2025-06-06 22:41:30.745 | INFO     | workflow.img_create:run_task:43 - 分析维度：按省份划分的高校分布分析 生成图表成功，图表保存路径：E:\data_analysic_agent\save_chart\按省份划分的高校分布分析.png
2025-06-06 22:41:34.611 | INFO     | workflow.img_create:run_task:37 - 分析维度：按办学类型划分的高校分布分析 代码：

from pyecharts.charts import Pie
from pyecharts import options as opts

chart = (
    Pie()
    .add(
        "",
        [("中外合作办学", 20), ("公办", 2072), ("民办", 764)],
        radius=["15%", "75%"],
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="按办学类型划分的高校分布分析"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_top="15%", pos_left="2%"),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png")

2025-06-06 22:41:42.998 | INFO     | workflow.img_create:run_task:43 - 分析维度：按办学类型划分的高校分布分析 生成图表成功，图表保存路径：E:\data_analysic_agent\save_chart\按办学类型划分的高校分布分析.png
2025-06-06 22:41:47.219 | INFO     | workflow.img_create:run_task:37 - 分析维度：高校层次与类别组合分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis(["专科（高职）", "普通本科"])
    .add_yaxis("办学类别", [1499, 1357])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="高校层次与类别组合分析"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\高校层次与类别组合分析.png")

2025-06-06 22:41:55.736 | INFO     | workflow.img_create:run_task:43 - 分析维度：高校层次与类别组合分析 生成图表成功，图表保存路径：E:\data_analysic_agent\save_chart\高校层次与类别组合分析.png
2025-06-06 22:42:10.166 | INFO     | workflow.img_create:run_task:37 - 分析维度：省份-城市维度下的高校分布分析 代码：

from pyecharts.charts import Bar
from pyecharts import options as opts

chart = (
    Bar()
    .add_xaxis([
        "上海", "云南", "内蒙古", "北京", "吉林", "四川", "天津", "宁夏", "安徽", "山东",
        "山西", "广东", "广西", "新疆", "江苏", "江西", "河北", "河南", "浙江", "海南",
        "湖北", "湖南", "澳门", "甘肃", "福建", "西藏", "贵州", "辽宁", "重庆", "陕西",
        "青海", "香港", "黑龙江"
    ])
    .add_yaxis("城市数量", [
        1, 14, 12, 1, 9, 21, 1, 4, 16, 16,
        11, 21, 14, 15, 13, 11, 11, 18, 11, 3,
        14, 14, 2, 14, 9, 2, 9, 14, 1, 10,
        3, 3, 13
    ])
    .add_yaxis("学校数量", [
        65, 82, 56, 102, 70, 137, 62, 20, 128, 160,
        85, 163, 85, 56, 174, 108, 126, 158, 111, 21,
        134, 129, 5, 52, 90, 6, 77, 110, 73, 104,
        12, 14, 81
    ])
    .set_global_opts(
        title_opts=opts.TitleOpts(title="省份-城市维度下的高校分布"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=45)),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
        legend_opts=opts.LegendOpts(pos_top="10%")
    )
)
from pyecharts.render import make_snapshot
from snapshot_selenium import snapshot
make_snapshot(snapshot, chart.render(), "E:\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.png")

2025-06-06 22:42:18.342 | INFO     | workflow.img_create:run_task:43 - 分析维度：省份-城市维度下的高校分布分析 生成图表成功，图表保存路径：E:\data_analysic_agent\save_chart\省份-城市维度下的高校分布分析.png
2025-06-06 22:42:18.343 | INFO     | workflow.data_explore:run:74 - ✅ 图表绘制完成.....
2025-06-06 22:42:18.344 | INFO     | workflow.data_explore:run:77 - 正在生成每个维度分析结论.....
2025-06-06 22:42:35.844 | INFO     | workflow.data_explore:parse_conclusion:116 - 正在解析数据分析结论....
