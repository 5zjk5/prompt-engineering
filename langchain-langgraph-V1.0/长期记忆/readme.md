# LangGraph 长期记忆实现示例

本目录包含了两个关于LangGraph长期记忆实现的示例文件，展示了如何在LangChain LangGraph中实现短期会话记忆和长期用户记忆。

## 文件概述

### 1. `long_term_memory.py` - 基础长期记忆示例

这是一个简单的LangGraph长期记忆基础示例，展示了如何使用InMemoryStore来存储和检索记忆数据。

#### 主要功能：
- 使用`InMemoryStore`创建内存存储
- 通过命名空间(namespace)组织记忆数据
- 演示了基本的记忆存储、获取和搜索功能

#### 核心概念：
- **命名空间(namespace)**: 类似于文件夹的组织结构，通常包含用户ID或组织ID
- **键(key)**: 命名空间内的唯一标识符
- **值(value)**: 包含记忆数据的字典，必须是JSON可序列化的
- **嵌入(embed)**: 用于计算相似度的嵌入函数

#### 使用场景：
适用于需要快速原型开发或测试长期记忆功能的场景，但不适用于生产环境，因为数据只存储在内存中，重启后数据会丢失。

### 2. `sqlite_memery.py` - SQLite长期记忆完整实现

这是一个完整的SQLite长期记忆实现示例，展示了如何构建一个具有短期会话记忆和长期用户记忆的聊天机器人。

#### 主要功能：
- 使用SQLite数据库存储短期会话记忆和长期用户记忆
- 实现了一个简单的聊天机器人，能够记住用户的历史对话和偏好
- 支持多用户、多会话管理
- 集成了向量搜索功能，能够根据当前查询检索相关的历史记忆

#### 核心组件：

1. **短期记忆存储**:
   - 使用`SqliteSaver`存储会话级别的对话历史
   - 通过`thread_id`区分不同的对话会话
   - 保存完整的消息历史，支持上下文连贯的对话

2. **长期记忆存储**:
   - 使用`SqliteStore`存储跨会话的用户记忆
   - 通过`user_id`区分不同用户
   - 支持向量搜索，能够根据语义相似度检索相关记忆
   - 每条记忆都有时间戳作为唯一标识

3. **聊天机器人实现**:
   - 基于StateGraph构建的简单聊天流程
   - 包含两个主要节点：`chat`节点处理对话，`update_memery`节点更新记忆
   - 在每次对话中检索相关记忆并作为上下文提供给模型

#### 数据库结构：

1. **chat_history.db** (短期记忆):
   - checkpoints表：存储LangGraph的检查点数据
   - writes表：存储写入操作的数据

2. **chat_memory.db** (长期记忆):
   - store表：存储记忆数据和向量嵌入
   - store_migrations表：存储数据库迁移信息

3. **history_multi_turn表** (用于查看历史消息):
   - 存储用户查询和AI回复的对应关系
   - 包含时间戳、用户ID、会话ID等信息
